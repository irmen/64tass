<!DOCTYPE HTML>
<html lang="en">
<head>
<title>64tass v1.51 r883 manual</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="Description" content="64tass, an advanced multi pass macro assembler for the 65xx family of microprocessors">
<meta name="Keywords" content="6502 assembler, 65816, 6510, 65C02, dtv, c64 cross assembler">
<meta name="Author" content="Kajtar Zsolt">
<meta name="viewport" content="width=device-width, initial-scale=1">
<style type="text/css">
dt {margin-top:0.5em}
dt + dt {margin-top:0em}
body {font-family:serif;}
p, dd, h1, h2, h3, h4, li, caption {hyphens:auto;-moz-hyphens:auto;-webkit-hyphens:auto;-ms-hyphens:auto;}
code {hyphens:manual;-moz-hyphens:manual;-webkit-hyphens:manual;-ms-hyphens:manual;}
h1, h2, h3, h4 {text-align:left;font-family:sans-serif}
hr {display:none}
pre {border:1px dotted #eee;background-color:#ffe;padding:2px; border-radius: 4px;}
pre.make b {color:inherit;}
pre.make span {color:navy;}
pre.make span.cmd {color:green;}
pre b, code b {color:navy;}
pre b.d, code b.d {color:#f80;}
pre b.k, pre span.k, code b.k, code span.k {color:blue;}
pre span, code span {color:#d00;}
pre span.s, code span.s {color:#f80;}
pre i {color:brown;}
pre u, code u {text-decoration:none;color:green;}
p, dd {text-align:justify;word-break:hypenate;}
p + p {text-indent:3ex;margin-top:-0.5em}
table {border-bottom:2px solid black;border-top:2px solid black;border-collapse:collapse;width:100%;margin-top:0.5em;margin-bottom:0.5em; border-spacing: 0px;}
td, th {padding: 0px 1ex 0px 1ex;border-left:1px solid silver;border-top:1px solid silver}
tr:nth-child(odd) {background: #fafaff;}
td:first-child, th:first-child {border-left: 0px;}
caption {caption-side:bottom;}
table.opcodes th, table.opcodes td {text-align:left;table-layout:fixed;}
table.trans td:nth-child(1), table.trans td:nth-child(4) {text-align:center;}
dl.errorlist dt, dl.dir dt, table.trans td, table.esc td, table.opcodes th, table.opcodes td, code, pre {font-family:monospace,monospace;}
dl.dir code b { color: inherit; }

thead th {background-color:#eee;border-bottom:1px solid black;}

@media screen {
   html {background-color: gray;}
   body > div {max-width:50em;margin-left:auto; margin-right:auto; overflow: hidden;}
   body {font-size:12pt;max-width:60em; background-color:white; margin-left:auto; margin-right:auto; border:1px solid black; box-shadow: black 2px 2px; padding: 5em 0.5em;}
   pre, div {overflow:auto;}
}
.links {line-height: 2em; word-spacing: 1ex; text-align: justify;}

@media print {
   h1, h2, h3, h4 {page-break-after:avoid;}
   a {text-decoration:none;color:inherit;}
   body {font-size:10pt;}
   pre {overflow:hidden;}
}

a[href], a:visited { text-decoration: none; color: blue; }
a[href]:hover { text-decoration: underline; }

#toc ul { margin: 0px; font-weight: normal;}
#toc > ul > li { margin-top: 0.5em; font-weight: bold; }
#toc { counter-reset: count1 }
#toc > ul > li > a:before { content: counter(count1) " "; counter-increment: count1; }
#toc > ul > li > a { counter-reset: count2;}
#toc > ul ul > li > a:before { content: counter(count1) "." counter(count2) " "; counter-increment: count2; }
#toc > ul ul > li > a { counter-reset: count3;}
#toc > ul ul ul > li > a:before { content: counter(count1) "." counter(count2) "." counter(count3) " "; counter-increment: count3; }

body { counter-reset: countcaption;}
h1 { counter-reset: counth2; font-size: 2em; margin: 0 0 0.67em 0; }

h2:before { content: counter(counth2) " "; counter-increment: counth2; min-width: 45pt;display:inline-block;}
h2 { counter-reset: counth3; }
h3:before { content: counter(counth2) "." counter(counth3) " "; counter-increment: counth3; min-width: 45pt;display:inline-block;}
h3 { counter-reset: counth4; }
h4:before { content: counter(counth2) "." counter(counth3) "." counter(counth4) " "; counter-increment: counth4; min-width: 45pt;display:inline-block;}
caption:before { content: "Table " counter(countcaption) ": "; counter-increment: countcaption; font-weight:bold;}
h2 a:after, h3 a:after, h4 a:after {content: "Â¶"}
h2 a, h3 a, h4 a {color:blue;visibility:hidden;text-decoration:none;}
h2:hover a, h3:hover a, h4:hover a {visibility:visible;}

q { quotes: "\201C" "\201D" "\2018" "\2019"; }
</style>
</head>
<body>
<div>
<h1>64tass v1.51 r883 manual</h1>

<p>This is the manual for 64tass, the multi pass optimizing macro assembler for
the 65xx series of processors. Key features:</p>

<ul>
<li>Open source, mostly portable C with minimal dependencies
<li>Familiar syntax to Omicron TASS and TASM.
<li>Supports 6502, 65C02, R65C02, W65C02, 65CE02, 65816, DTV, 65EL02
<li>Arbitrary-precision integers and bitstrings, double precision floating point numbers
<li>Character and byte strings, array arithmetic
<li>Handles UTF-8, UTF-16 and 8&nbsp;bit RAW encoded source files, unicode strings
<li>Supports Unicode identifiers with case folding and compatibility normalization
<li>Built-in <q>linker</q> with section support
<li>CPU or flat address space for creating huge binaries (e.g. cartridges)
<li>Conditional compilation, macros, struct/union structures, scopes.
</ul>

<p><b>This is a development version, features or syntax may change over time.
Not everything is backwards compatible.</b></p>

<p>Project page: <a href="http://sourceforge.net/projects/tass64/">http://sourceforge.net/projects/tass64/</a></p>

<hr>
<h2>Table of Contents<a name="contents" href="#contents"></a></h2>

<div id="toc">
<ul>
 <li><a href="#contents">Table of Contents</a>
 <li><a href="#usage-tips">Usage tips</a>
 <li><a href="#expressions-datatypes">Expressions and data types</a>
 <ul>
  <li><a href="#integers">Integer constants</a>
  <li><a href="#bit-string">Bit string constants</a>
  <li><a href="#floating-point">Floating point constants</a>
  <li><a href="#character-string">Character string constants</a>
  <li><a href="#byte-string">Byte string constants</a>
  <li><a href="#list-tuples">List and tuples</a>
  <li><a href="#dictionaries">Dictionaries</a>
  <li><a href="#code">Code</a>
  <li><a href="#addressing">Addressing modes</a>
  <li><a href="#uninitialized">Uninitialized memory</a>
  <li><a href="#type">Types</a>
  <li><a href="#symbols">Symbols</a>
  <ul>
   <li><a href="#symbols-regular">Regular symbols</a>
   <li><a href="#symbols-local">Local symbols</a>
   <li><a href="#symbols-anonymous">Anonymous symbols</a>
   <li><a href="#symbols-constant">Constant and re-definable symbols</a>
  </ul>
  <li><a href="#conditionals">Conditional expressions</a>
  <li><a href="#expressions">Expressions</a>
 </ul>
 <li><a href="#compiler-directives">Compiler directives</a>
 <ul>
  <li><a href="#program-counter">Controlling the compile offset and program counter</a>
  <li><a href="#data-dumping">Dumping data</a>
  <ul>
   <li><a href="#data-numeric">Storing numeric data</a>
   <li><a href="#data-text">Storing text data</a>
  </ul>
  <li><a href="#text-encoding">Text encoding</a>
  <li><a href="#structures">Structured data</a>
  <ul>
   <li><a href="#structure">Structure</a>
   <li><a href="#union">Union</a>
   <li><a href="#struct-and-union">Combined use of structures and unions</a>
  </ul>
  <li><a href="#macros">Macros</a>
  <ul>
   <li><a href="#macro-parameters">Parameter references</a>
   <li><a href="#macro-textreference">Text references</a>
  </ul>
  <li><a href="#user-functions">Custom functions</a>
  <li><a href="#conditional-assembly">Conditional assembly</a>
  <ul>
   <li><a href="#conditional-if">If, else if, else</a>
   <li><a href="#conditional-switch">Switch, case, default</a>
  </ul>
  <li><a href="#repetitions">Repetitions</a>
  <li><a href="#including">Including files</a>
  <li><a href="#scopes">Scopes</a>
  <li><a href="#sections">Sections</a>
  <li><a href="#w65816">65816 related</a>
  <li><a href="#compiletime-checks">Controlling errors</a>
  <li><a href="#target-cpu">Target</a>
  <li><a href="#misc">Misc</a>
  <li><a href="#listing-control">Printer control</a>
 </ul>
 <li><a href="#pseudo-instructions">Pseudo instructions</a>
 <li><a href="#tasm-compatibility">Original turbo assembler compatibility</a>
 <ul>
  <li><a href="#tasm-convert">How to convert source code for use with 64tass</a>
  <li><a href="#tasm-diff">Differences to the original turbo ass macro on the C64</a>
  <li><a href="#tasm-labels">Labels</a>
  <li><a href="#tasm-expression">Expression evaluation</a>
  <li><a href="#tasm-macros">Macros</a>
  <li><a href="#tasm-bugs">Bugs</a>
 </ul>
 <li><a href="#commandline-options">Command line options</a>
 <ul>
  <li><a href="#commandline-output">Output options</a>
  <li><a href="#commandline-operation">Operation options</a>
  <li><a href="#commandline-target">Target selection on command line</a>
  <li><a href="#commandline-listing">Source listing options</a>
  <li><a href="#commandline-other">Other options</a>
 </ul>
 <li><a href="#messages">Messages</a>
 <ul>
  <li><a href="#messages-warnings">Warnings</a>
  <li><a href="#messages-errors">Errors</a>
  <li><a href="#messages-fatal">Fatal errors</a>
 </ul>
 <li><a href="#credits">Credits</a>
 <li><a href="#builtin-translations-escapes">Default translation and escape sequences</a>
 <ul>
  <li><a href="#translate-raw8">Raw 8-bit source</a>
  <ul>
   <li><a href="#translate-raw8-none">The none encoding for raw 8-bit</a>
   <li><a href="#translate-raw8-screen">The screen encoding for raw 8-bit</a>
  </ul>
  <li><a href="#translate-unicode">Unicode and ASCII source</a>
  <ul>
   <li><a href="#translate-unicode-none">The none encoding for Unicode</a>
   <li><a href="#translate-unicode-screen">The screen encoding for Unicode</a>
  </ul>
 </ul>
 <li><a href="#opcodes">Opcodes</a>
 <ul>
  <li><a href="#opcodes-6502">Standard 6502 opcodes</a>
  <li><a href="#opcodes-6502i">6502 illegal opcodes</a>
  <li><a href="#opcodes-65dtv02">65DTV02 opcodes</a>
  <li><a href="#opcodes-65c02">Standard 65C02 opcodes</a>
  <li><a href="#opcodes-r65c02">R65C02 opcodes</a>
  <li><a href="#opcodes-w65c02">W65C02 opcodes</a>
  <li><a href="#opcodes-w65816">W65816 opcodes</a>
  <li><a href="#opcodes-65el02">65EL02 opcodes</a>
  <li><a href="#opcodes-65ce02">65CE02 opcodes</a>
 </ul>
 <li><a href="#appendix">Appendix</a>
 <ul>
  <li><a href="#directives">Assembler directives</a>
  <li><a href="#functions">Built-in functions</a>
  <li><a href="#types">Built-in types</a>
 </ul>
</ul>
</div>

<hr>
<h2>Usage tips<a name="usage-tips" href="#usage-tips"></a></h2>
<p>64tass is a command line assembler, the source can be written in any text
editor. As a minimum the source filename must be given on the command line. The
<q><tt>-a</tt></q> parameter is highly recommended if the source is Unicode or
ASCII.</p>

<pre width=80>
64tass -a src.asm
</pre>

<p>There are also some useful parameters which are described later.</p>

<p>For comfortable compiling I use such <q>Makefile</q>s (for <a href="http://en.wikipedia.org/wiki/Make_%28software%29">make</a>):</p>

<pre width=80 class="make">
<span>demo.prg:</span> source.asm macros.asm pic.drp music.bin
        <span class="cmd">64tass -C -a -B -i source.asm -o demo.tmp</span>
        <span class="cmd">pucrunch -ffast -x 2048 demo.tmp &gt;demo.prg</span>
</pre>

<p>This way <q>demo.prg</q> is recreated by compiling <q>source.asm</q>
whenever <q>source.asm</q>, <q>macros.asm</q>, <q>pic.drp</q> or <q>music.bin</q> had changed.</p>

<p>Of course it's not much harder to create something similar for win32 (make.bat),
however this will always compile and compress:</p>

<pre width=80>
64tass.exe -C -a -B -i source.asm -o demo.tmp
pucrunch.exe -ffast -x 2048 demo.tmp &gt;demo.prg
</pre>

<p>Here's a slightly more advanced Makefile example with default action as
testing in VICE, clean target for removal of temporary files and compressing
using an intermediate temporary file:</p>

<pre width=80 class="make">
<span>all:</span> demo.prg
        <span class="cmd">x64 -autostartprgmode 1 -autostart-warp +truedrive +cart</span> $&lt;

<span>demo.prg:</span> demo.tmp
	<span class="cmd">pucrunch -ffast -x 2048</span> $&lt; &gt;$@

<span>demo.tmp:</span> source.asm macros.asm pic.drp music.bin
        <span class="cmd">64tass -C -a -B -i</span> $&lt; <span class="cmd">-o</span> $@

<b>.INTERMEDIATE:</b> demo.tmp
<b>.PHONY:</b> all clean
<span>clean:</span>
        $(RM) <span class="cmd">demo.prg demo.tmp</span>
</pre>

<p>It's useful to add a basic header to your source files like the one below,
so that the resulting file is directly runnable without additional
compression:</p>

<pre width=80>
        <b>*=</b> <span>$0801</span>
        <b class="d">.word</b> (<u>+</u>), <span>2005</span>  <i>;pointer, line number</i>
        <b class="d">.null</b> <span>$9e</span>, ^<u>start</u><i>;will be sys 4096</i>
+	<b class="d">.word</b> <span>0</span>          <i>;basic line end</i>

        <b>*=</b> <span>$1000</span>

start	<b>rts</b>
</pre>

<p>A frequently coming up question is, how to automatically allocate
memory, without hacks like <code>&lowast;=&lowast;+1</code>? Sure
there's <code>.byte</code> and friends for variables with initial values
but what about zero page, or RAM outside of program area? The solution
is to not use an initial value by using <q><code>?</code></q> or not
giving a fill byte value to <code>.fill</code>.</p>

<pre width=80>
        <b>*=</b> <span>$02</span>
p1	<b class="d">.word</b> <span>?</span>         <i>;a zero page pointer</i>
temp	<b class="d">.fill</b> <span>10</span>        <i>;a 10 byte temporary area</i>
</pre>

<p>Space allocated this way
is not saved in the output as there's no data to save at those
addresses.</p>

<p>What about some code running on zero page for speed? It needs to be
relocated, and the length must be known to copy it there. Here's
an example:</p>

<pre width=80>
        <b>ldx</b> #<span class="k">size</span>(<u>zpcode</u>)-<span>1</span><i>;calculate length</i>
-       <b>lda</b> <u>zpcode</u>,x
        <b>sta</b> <u>wrbyte</u>,x
        <b>dex</b>             <i>;install to zeropage</i>
        <b>bpl</b> <u>-</u>
        <b>jsr</b> <u>wrbyte</u>
        <b>rts</b>
<i>;code continues here but is compiled to run from $02</i>
zpcode  <b class="k">.logical</b> <span>$02</span>
wrbyte  <b>sta</b> <span>$ffff</span>       <i>;quick byte writer at $02</i>
        <b>inc</b> <u>wrbyte</u>+<span>1</span>
        <b>bne</b> <u>+</u>
        <b>inc</b> <u>wrbyte</u>+<span>2</span>
+	<b>rts</b>
	<b class="k">.here</b>
</pre>
<p>The assembler supports lists and tuples, which does not seems interesting at
first as it sound like something which is only useful when heavy scripting is
involved. But as normal arithmetic operations also apply on all their elements at
once, this could spare quite some typing and repetition.</p>
<p>Let's take a simple example of a low/high byte jump table of return
addresses, this usually involves some unnecessary copy/pasting to create a pair
of tables with constructs like <code>&gt;(label&minus;1)</code>.</p>
<pre width=80>
jumpcmd <b>lda</b> <u>hibytes</u>,x   <i>; selected routine in X register</i>
        <b>pha</b>
        <b>lda</b> <u>lobytes</u>,x   <i>; push address to stack</i>
        <b>pha</b>
        <b>rts</b>             <i>; jump, rts will increase pc by one!</i>
<i>; Build an anonymous list of jump addresses minus 1</i>
-	<b>=</b> (<u>cmd_p</u>, <u>cmd_c</u>, <u>cmd_m</u>, <u>cmd_s</u>, <u>cmd_r</u>, <u>cmd_l</u>, <u>cmd_e</u>)-<span>1</span>
lobytes <b class="d">.byte</b> &lt;(<u>-</u>)      <i>; low bytes of jump addresses</i>
hibytes <b class="d">.byte</b> &gt;(<u>-</u>)      <i>; high bytes</i>
</pre>

<p>There are some other tips below in the descriptions.</p>

<hr>
<h2>Expressions and data types<a name="expressions-datatypes" href="#expressions-datatypes"></a></h2>

<h3>Integer constants<a name="integers" href="#integers"></a></h3>

<p>Integer constants can be entered as a string of decimal numbers of arbitary length. The
following operations are accepted:</p>

<div><table border="0">
<caption>Integer operators and functions</caption>
<tbody>
<tr><td width="60"><code><u>x</u> + <u>y</u></code><td>add x to y<td><code><span>2</span> + <span>2</span></code> is <code><span>4</span></code>
<tr><td><code><u>x</u> &minus; <u>y</u></code><td>subtract y from x<td><code><span>4</span> &minus; <span>1</span></code> is <code><span>3</span></code>
<tr><td><code><u>x</u> &lowast; <u>y</u></code><td>multiply x with y<td><code><span>2</span> &lowast; <span>3</span></code> is <code><span>6</span></code>
<tr><td><code><u>x</u> / <u>y</u></code><td>integer divide x by y<td><code><span>7</span> / <span>2</span></code> is <code><span>3</span></code>
<tr><td><code><u>x</u> % <u>y</u></code><td>integer modulo of x divided by y<td><code><span>5</span> % <span>2</span></code> is <code><span>1</span></code>
<tr><td><code><u>x</u> &lowast;&lowast; <u>y</u></code><td>x raised to power of y<td><code><span>2</span> &lowast;&lowast; <span>4</span></code> is <code><span>16</span></code>
<tr><td><code>&minus;<u>x</u></code><td>negated value<td><code>&minus;<span>2</span></code> is <code><span>&minus;2</span></code>
<tr><td><code>+<u>x</u></code><td>unchanged<td><code>+<span>2</span></code> is <code><span>2</span></code>
<tr><td><code>~<u>x</u></code><td>&minus;x &minus; 1<td><code>~<span>3</span></code> is <code><span>&minus;4</span></code>
<tr><td><code>&lt;<u>x</u></code><td>lower byte<td><code>&lt;<span>2049</span></code> is <code><span>$01</span></code>
<tr><td><code>&gt;<u>x</u></code><td>higher byte<td><code>&gt;<span>2049</span></code> is <code><span>$08</span></code>
<tr><td><code>`<u>x</u></code><td>bank byte<td><code>`<span>65536</span></code> is <code><span>$01</span></code>
<tr><td><code>&lt;&gt;<u>x</u></code><td>lower word<td><code>&lt;&gt;<span>65537</span></code> is <code><span>$0001</span></code>
<tr><td><code>&gt;`<u>x</u></code><td>higher word<td><code>&gt;`<span>65537</span></code> is <code><span>$0100</span></code>
<tr><td><code>&gt;&lt;<u>x</u></code><td>lower byte swapped word<td><code>&gt;&lt;<span>2049</span></code> is <code><span>$0108</span></code>
<tr><td><code><u>x</u> &lt;=&gt; <u>y</u></code><td>x compares to y<td><code><span>2</span> &lt;=&gt; <span>5</span></code> is <code><span>&minus;1</span></code>
<tr><td><code><u>x</u> == <u>y</u></code><td>x equals to y<td><code><span>2</span> == <span>3</span></code> is <code><span>false</span></code>
<tr><td><code><u>x</u> != <u>y</u></code><td>x does not equal to y<td><code><span>2</span> != <span>3</span></code> is <code><span>true</span></code>
<tr><td><code><u>x</u> &lt; <u>y</u></code><td>x is less than y<td><code><span>2</span> &lt; <span>3</span></code> is <code><span>true</span></code>
<tr><td><code><u>x</u> &gt; <u>y</u></code><td>x is more than y<td><code><span>2</span> &gt; <span>3</span></code> is <code><span>false</span></code>
<tr><td><code><u>x</u> &gt;= <u>y</u></code><td>x is more than y or equals<td><code><span>2</span> &gt;= <span>3</span></code> is <code><span>false</span></code>
<tr><td><code><u>x</u> &lt;= <u>y</u></code><td>x is less than y or equals<td><code><span>2</span> &lt;= <span>3</span></code> is <code><span>true</span></code>
<tr><td><code><u>x</u> | <u>y</u></code><td>bitwise or<td><code><span>2</span> | <span>6</span></code> is <code><span>6</span></code>
<tr><td><code><u>x</u> ^ <u>y</u></code><td>bitwise xor<td><code><span>2</span> ^ <span>6</span></code> is <code><span>4</span></code>
<tr><td><code><u>x</u> &amp; <u>y</u></code><td>bitwise and<td><code><span>2</span> &amp; <span>6</span></code> is <code><span>2</span></code>
<tr><td><code><u>x</u> &lt;&lt; <u>y</u></code><td>logical shift left<td><code><span>1</span> &lt;&lt; <span>3</span></code> is <code><span>8</span></code>
<tr><td><code><u>x</u> &gt;&gt; <u>y</u></code><td>arithmetic shift right<td><code><span>&minus;8</span> &gt;&gt; <span>3</span></code> is <code><span>&minus;1</span></code>
<tr><td><code><span class="k">abs</span>(<u>a</u>)</code><td>absolute value<td><code><span class="k">abs</span>(<span>&minus;1</span>)</code> is <code><span>1</span></code>
<tr><td><code><span class="k">sign</span>(<u>a</u>)</code><td>sign value (&minus;1, 0, 1)<td><code><span class="k">sign</span>(<span>&minus;4</span>)</code> is <code><span>&minus;1</span></code>
</tbody>
</table></div>

<p>An integer has a truth value of true if it's non-zero. The
true value is the same as 1.</p>

<p>Integers are automatically promoted to float as necessary in expressions.</p>

<pre width=80>
        <b class="d">.byte</b> <span>23</span>        <i>; decimal</i>

        <b>lda</b> #&lt;<u>label</u>
        <b>ldy</b> #&gt;<u>label</u>
        <b>jsr</b> <span>$ab1e</span>

        <b>ldx</b> #&lt;&gt;<u>source</u>   <i>; word extraction</i>
        <b>ldy</b> #&lt;&gt;<u>dest</u>
        <b>lda</b> #<span class="k">size</span>(<u>source</u>)-<span>1</span>
        <b>mvn</b> #`<u>source</u>, #`<u>dest</u><i>; bank extraction</i>

        <b>lda</b> #((<u>bitmap</u> &gt;&gt; <span>10</span>) &amp; <span>$0f</span>) | ((<u>screen</u> &gt;&gt; <span>6</span>) &amp; <span>$f0</span>)
        <b>sta</b> <span>$d018</span>
</pre>

<h3>Bit string constants<a name="bit-string" href="#bit-string"></a></h3>

<p>Bit string constants can be entered as hexadecimal by a leading dollar sign or binary with a leading percent sign.
The following operations are accepted:</p>

<div><table border="0">
<caption>Bit string operators and functions</caption>
<tbody>
<tr><td><code>~<u>x</u></code><td>invert bits<td><code>~<span>%101</span></code> is <code><span>~%101</span></code>
<tr><td><code><u>y</u> .. <u>x</u></code><td>concatenate bits<td><code><span>$a</span> .. <span>$b</span></code> is <code><span>$ab</span></code>
<tr><td><code><u>y</u> <span class="k">x</span> <u>n</u></code><td>repeat<td><code><span>%101</span> <span class="k">x</span> <span>3</span></code> is <code><span>%101101101</span></code>
<tr><td><code><u>x</u>[<u>n</u>]</code><td>extract bit(s)<td><code><span>$a</span>[<span>1</span>]</code> is <code><span>%1</span></code>
<tr><td><code><u>x</u>[<u>s</u>]</code><td>slice bits<td><code><span>$1234</span>[<span>4</span>:<span>8</span>]</code> is <code><span>$3</span></code>
<tr><td><code><u>x</u> | <u>y</u></code><td>bitwise or<td><code><span>~$2</span> | <span>$6</span></code> is <code><span>~$0</span></code>
<tr><td><code><u>x</u> ^ <u>y</u></code><td>bitwise xor<td><code><span>~$2</span> ^ <span>$6</span></code> is <code><span>~$4</span></code>
<tr><td><code><u>x</u> &amp; <u>y</u></code><td>bitwise and<td><code><span>~$2</span> &amp; <span>$6</span></code> is <code><span>$4</span></code>
<tr><td><code><u>x</u> &lt;&lt; <u>y</u></code><td>bitwise shift left<td><code><span>$0f</span> &lt;&lt; <span>4</span></code> is <code><span>$0f0</span></code>
<tr><td><code><u>x</u> &gt;&gt; <u>y</u></code><td>bitwise shift right<td><code><span>~$f4</span> &gt;&gt; <span>4</span></code> is <code><span>~$f</span></code>
<tr><td><code><span class="k">abs</span>(<u>a</u>)</code><td>absolute value<td><code><span class="k">abs</span>(<span>%11</span>)</code> is <code><span>3</span></code>
<tr><td><code><span class="k">sign</span>(<u>a</u>)</code><td>sign value (&minus;1, 0, 1)<td><code><span class="k">sign</span>(<span>~%11</span>)</code> is <code><span>&minus;1</span></code>
<tr><td><code><span class="k">len</span>(<u>a</u>)</code><td>length in bits<td><code><span class="k">len</span>(<span>$034</span>)</code> is <code><span>12</span></code>
<tr><td><code><span class="k">all</span>(<u>a</u>)</code><td>all bits set or no bits at all<td><code><span class="k">all</span>(<span>$f</span>)</code> is <code><span>true</span></code>
<tr><td><code><span class="k">any</span>(<u>a</u>)</code><td>at least one bit set<td><code><span class="k">any</span>(~<span>$f</span>)</code> is <code><span>false</span></code>
</tbody>
</table></div>

<p>A bit string has a truth value of true if it's integer value is non-zero.</p>

<p>Length of bit string constants are defined in bits and is calculated from
the number of digits used including leading zeros.</p>

<p>Bit strings are automatically promoted to integer or floating point as necessary in
expressions. The higher bits are extended with zeros or ones as needed.</p>

<pre width=80>
        <b class="d">.byte</b> <span>$33</span>       <i>; hex</i>
        <b class="d">.byte</b> <span>%00011111</span> <i>; binary</i>
        <b class="d">.text</b> <span>$1234</span>     <i>; $34, $12</i>

        <b>lda</b> <span>$01</span>
        <b>and</b> #~<span>$07</span>
        <b>ora</b> #<span>$05</span>
        <b>sta</b> <span>$01</span>

        <b>lda</b> <span>$d015</span>
        <b>and</b> #~<span>%00100000</span> <i>;clear a bit</i>
        <b>sta</b> <span>$d015</span>
</pre>

<h3>Floating point constants<a name="floating-point" href="#floating-point"></a></h3>

<p>Floating point constants have a radix point in them and optionally
an exponent. A decimal exponent is <q>e</q> while a binary one is <q>p</q>. The
following operations can be used:</p>

<div><table border="0">
<caption>Floating point operators and functions</caption>
<tbody>
<tr><td width="80"><code><u>x</u> + <u>y</u></code><td>add x to y<td><code><span>2.2</span> + <span>2.2</span></code> is <code><span>4.4</span></code>
<tr><td><code><u>x</u> &minus; <u>y</u></code><td>subtract y from x<td><code><span>4.1</span> &minus; <span>1.1</span></code> is <code><span>3.0</span></code>
<tr><td><code><u>x</u> &lowast; <u>y</u></code><td>multiply x with y<td><code><span>1.5</span> &lowast; <span>3</span></code> is <code><span>4.5</span></code>
<tr><td><code><u>x</u> / <u>y</u></code><td>integer divide x by y<td><code><span>7.0</span> / <span>2.0</span></code> is <code><span>3.5</span></code>
<tr><td><code><u>x</u> % <u>y</u></code><td>integer modulo of x divided by y<td><code><span>5.0</span> % <span>2.0</span></code> is <code><span>1.0</span></code>
<tr><td><code><u>x</u> &lowast;&lowast; <u>y</u></code><td>x raised t power of y<td><code><span>2.0</span> &lowast;&lowast; <span>&minus;1</span></code> is <code><span>0.5</span></code>
<tr><td><code>&minus;<u>x</u></code><td>negated value<td><code>&minus;<span>2.0</span></code> is <code><span>&minus;2.0</span></code>
<tr><td><code>+<u>x</u></code><td>unchanged<td><code>+<span>2.0</span></code> is <code><span>2.0</span></code>
<tr><td><code><u>x</u> &lt;=&gt; <u>y</u></code><td>x compares to y<td><code><span>5.0</span> &lt;=&gt; <span>3.0</span></code> is 1
<tr><td><code><u>x</u> == <u>y</u></code><td>x equals to y<td><code><span>2.0</span> == <span>3.0</span></code> is <code><span>false</span></code>
<tr><td><code><u>x</u> != <u>y</u></code><td>x does not equal to y<td><code><span>2.0</span> != <span>3.0</span></code> is <code><span>true</span></code>
<tr><td><code><u>x</u> &lt; <u>y</u></code><td>x is less than y<td><code><span>2.0</span> &lt; <span>3.0</span></code> is <code><span>true</span></code>
<tr><td><code><u>x</u> &gt; <u>y</u></code><td>x is more than y<td><code><span>2.0</span> &gt; <span>3.0</span></code> is <code><span>false</span></code>
<tr><td><code><u>x</u> &gt;= <u>y</u></code><td>x is more than y or equals<td><code><span>2.0</span> &gt;= <span>3.0</span></code> is <code><span>false</span></code>
<tr><td><code><u>x</u> &lt;= <u>y</u></code><td>x is less than y or equals<td><code><span>2.0</span> &lt;= <span>3.0</span></code> is <code><span>true</span></code>
<tr><td><code><u>x</u> | <u>y</u></code><td>bitwise or<td><code><span>2.5</span> | <span>6.5</span></code> is <code><span>6.5</span></code>
<tr><td><code><u>x</u> ^ <u>y</u></code><td>bitwise xor<td><code><span>2.5</span> ^ <span>6.5</span></code> is <code><span>4.0</span></code>
<tr><td><code><u>x</u> &amp; <u>y</u></code><td>bitwise and<td><code><span>2.5</span> &amp; <span>6.5</span></code> is <code><span>2.5</span></code>
<tr><td><code><u>x</u> &lt;&lt; <u>y</u></code><td>logical shift left<td><code><span>1.0</span> &lt;&lt; <span>3.0</span></code> is <code><span>8.0</span></code>
<tr><td><code><u>x</u> &gt;&gt; <u>y</u></code><td>arithmetic shift right<td><code><span>&minus;8.0</span> &gt;&gt; <span>4</span></code> is <code><span>&minus;0.5</span></code>
<tr><td><code>~<u>x</u></code><td>almost &minus;x<td><code>~<span>2.1</span></code> is almost <code><span>&minus;2.1</span></code>
<tr><td><code><span class="k">abs</span>(<u>a</u>)</code><td>absolute value<td><code><span class="k">abs</span>(<span>&minus;1.0</span>)</code> is <code><span>1.0</span></code>
<tr><td><code><span class="k">sign</span>(<u>a</u>)</code><td>sign value (&minus;1, 0, 1)<td><code><span class="k">sign</span>(<span>&minus;4.0</span>)</code> is <code><span>&minus;1</span></code>
<tr><td><code><span class="k"><a name="f_floor">floor</a></span>(<u>a</u>)</code><td>round down<td><code><span class="k">floor</span>(<span>&minus;4.8</span>)</code> is <code><span>&minus;5.0</span></code>
<tr><td><code><span class="k"><a name="f_round">round</a></span>(<u>a</u>)</code><td>round to nearest away from zero<td><code><span class="k">round</span>(<span>4.8</span>)</code> is <code><span>5.0</span></code>
<tr><td><code><span class="k"><a name="f_ceil">ceil</a></span>(<u>a</u>)</code><td>round up<td><code><span class="k">ceil</span>(<span>1.1</span>)</code> is <code><span>2.0</span></code>
<tr><td><code><span class="k"><a name="f_trunc">trunc</a></span>(<u>a</u>)</code><td>round down towards zero<td><code><span class="k">trunc</span>(<span>&minus;1.9</span>)</code> is <code><span>&minus;1</span></code>
<tr><td><code><span class="k"><a name="f_frac">frac</a></span>(<u>a</u>)</code><td>fractional part<td><code><span class="k">frac</span>(<span>1.1</span>)</code> is <code><span>0.1</span></code>
<tr><td><code><span class="k"><a name="f_sqrt">sqrt</a></span>(<u>a</u>)</code><td>square root<td><code><span class="k">sqrt</span>(<span>16.0</span>)</code> is <code><span>4.0</span></code>
<tr><td><code><span class="k"><a name="f_cbrt">cbrt</a></span>(<u>a</u>)</code><td>cube root<td><code><span class="k">cbrt</span>(<span>27.0</span>)</code> is <code><span>3.0</span></code>
<tr><td><code><span class="k"><a name="f_log10">log10</a></span>(<u>a</u>)</code><td>common logarithm<td><code><span class="k">log10</span>(<span>100.0</span>)</code> is <code><span>2.0</span></code>
<tr><td><code><span class="k"><a name="f_log">log</a></span>(<u>a</u>)</code><td>natural logarithm<td><code><span class="k">log</span>(<span>1</span>)</code> is <code><span>0.0</span></code>
<tr><td><code><span class="k"><a name="f_exp">exp</a></span>(<u>a</u>)</code><td>exponential<td><code><span class="k">exp</span>(<span>0</span>)</code> is <code><span>1.0</span></code>
<tr><td><code><span class="k"><a name="f_pow">pow</a></span>(<u>a</u>,&nbsp;<u>b</u>)</code><td>a raised to power of b<td><code><span class="k">pow</span>(<span>2.0, 3.0</span>)</code> is <code><span>8.0</span></code>
<tr><td><code><span class="k"><a name="f_sin">sin</a></span>(<u>a</u>)</code><td>sine<td><code><span class="k">sin</span>(<span>0.0</span>)</code> is <code><span>0.0</span></code>
<tr><td><code><span class="k"><a name="f_asin">asin</a></span>(<u>a</u>)</code><td>arc sine<td><code><span class="k">asin</span>(<span>0.0</span>)</code> is <code><span>0.0</span></code>
<tr><td><code><span class="k"><a name="f_sinh">sinh</a></span>(<u>a</u>)</code><td>hyperbolic sine<td><code><span class="k">sinh</span>(<span>0.0</span>)</code> is <code><span>0.0</span></code>
<tr><td><code><span class="k"><a name="f_cos">cos</a></span>(<u>a</u>)</code><td>cosine<td><code><span class="k">cos</span>(<span>0.0</span>)</code> is <code><span>1.0</span></code>
<tr><td><code><span class="k"><a name="f_acos">acos</a></span>(<u>a</u>)</code><td>arc cosine<td><code><span class="k">acos</span>(<span>1.0</span>)</code> is <code><span>0.0</span></code>
<tr><td><code><span class="k"><a name="f_cosh">cosh</a></span>(<u>a</u>)</code><td>hyperbolic cosine<td><code><span class="k">cosh</span>(<span>0.0</span>)</code> is <code><span>1.0</span></code>
<tr><td><code><span class="k"><a name="f_tan">tan</a></span>(<u>a</u>)</code><td>tangent<td><code><span class="k">tan</span>(<span>0.0</span>)</code> is <code><span>0.0</span></code>
<tr><td><code><span class="k"><a name="f_atan">atan</a></span>(<u>a</u>)</code><td>arc tangent<td><code><span class="k">atan</span>(<span>0.0</span>)</code> is <code><span>0.0</span></code>
<tr><td><code><span class="k"><a name="f_tanh">tanh</a></span>(<u>a</u>)</code><td>hyperbolic tangent<td><code><span class="k">tanh</span>(<span>0.0</span>)</code> is <code><span>0.0</span></code>
<tr><td><code><span class="k"><a name="f_rad">rad</a></span>(<u>a</u>)</code><td>degrees to radian<td><code><span class="k">rad</span>(<span>0.0</span>)</code> is <code><span>0.0</span></code>
<tr><td><code><span class="k"><a name="f_deg">deg</a></span>(<u>a</u>)</code><td>radian to degrees<td><code><span class="k">deg</span>(<span>0.0</span>)</code> is <code><span>0.0</span></code>
<tr><td><code><span class="k"><a name="f_hypot">hypot</a></span>(<u>y</u>,&nbsp;<u>x</u>)</code><td>polar distance<td><code><span class="k">hypot</span>(<span>4.0</span>, <span>3.0</span>)</code> is <code><span>5.0</span></code>
<tr><td><code><span class="k"><a name="f_atan2">atan2</a></span>(<u>y</u>,&nbsp;<u>x</u>)</code><td>polar angle<td><code><span class="k">atan2</span>(<span>0.0</span>, <span>3.0</span>)</code> is <code><span>0.0</span></code>
</tbody>
</table></div>

<p>A floating point number has a truth value of true if it's non-zero.</p>

<p>As usual comparing floating point numbers for (non) equality is a bad idea due to rounding errors.</p>

<p>There are no predefined floating point constants, define them as necessary. Hint: pi is <code>rad(180)</code>
and e is <code>exp(1)</code>.</p>

<p>Floating point numbers are automatically truncated to integer as necessary.</p>

<p>Fixed point conversion can be done by using the shift operators for example
a 8.16 fixed point number can be calculated as <code>(3.14 &lt;&lt; 16) &amp; $ffffff</code>.
The binary operators operate like if the floating point number would be a fixed
point one. This is the reason for the strange definition of inversion.</p>

<pre width=80>
        <b class="d">.byte</b> <span>3.66e1</span>       <i>; 36.6, truncated to 36</i>
        <b class="d">.byte</b> <span>$1.8p4</span>       <i>; 4:4 fixed point number (1.5)</i>
        <b class="d">.int</b> <span>12.2p8</span>        <i>; 8:8 fixed point number (12.2)</i>
</pre>

<h3>Character string constants<a name="character-string" href="#character-string"></a></h3>

<p>Strings are enclosed in single or double quotes and can hold any Unicode
character. Operations like indexing or slicing are always done on the original
representation. The current encoding is only applied when it's used in
expressions as numeric constants or in context of text data directives.
Doubling the quotes inside the strings escapes them.</p>

<div><table border="0">
<caption>String operators and functions</caption>
<tbody>
<tr><td><code><u>y</u> .. <u>x</u></code><td>concatenate strings<td><code><span class="s">"a"</span> .. <span class="s">"b"</span></code> is <code><span class="s">"ab"</span></code>
<tr><td><code><u>y</u> <span class="k">in</span> <u>x</u></code><td>is substring of<td><code><span class="s">"b"</span> <span class="k">in</span> <span class="s">"abc"</span></code> is <code><span>true</span></code>
<tr><td><code><u>a</u> <span class="k">x</span> <u>n</u></code><td>repeat<td><code><span class="s">"ab"</span> <span class="k">x</span> <span>3</span></code> is <code><span class="s">"ababab"</span></code>
<tr><td><code><u>a</u>[<u>i</u>]</code><td>character from start<td><code><span class="s">"abc"</span>[<span>1</span>]</code> is <code><span class="s">"b"</span></code>
<tr><td><code><u>a</u>[<u>i</u>]</code><td>character from end<td><code><span class="s">"abc"</span>[<span>&minus;1</span>]</code> is <code><span class="s">"c"</span></code>
<tr><td><code><u>a</u>[<u>s</u>]</code><td>no change<td><code><span class="s">"abc"</span>[:]</code> is <code><span class="s">"abc"</span></code>
<tr><td><code><u>a</u>[<u>s</u>]</code><td>cut off start<td><code><span class="s">"abc"</span>[<span>1</span>:]</code> is <code><span class="s">"bc"</span></code>
<tr><td><code><u>a</u>[<u>s</u>]</code><td>cut off end<td><code><span class="s">"abc"</span>[:<span>&minus;1</span>]</code> is <code><span class="s">"ab"</span></code>
<tr><td><code><u>a</u>[<u>s</u>]</code><td>reverse<td><code><span class="s">"abc"</span>[::<span>&minus;1</span>]</code> is <code><span class="s">"cba"</span></code>
<tr><td><code><span class="k">len</span>(<u>a</u>)</code><td>number of characters<td><code><span class="k">len</span>(<span class="s">"abc"</span>)</code> is <code><span>3</span></code>
<tr><td><code><span class="k">all</span>(<u>a</u>)</code><td>all characters non-zero or empty string<td><code><span class="k">all</span>(<span class="s">"c"</span>)</code> is <code><span>true</span></code>
<tr><td><code><span class="k">any</span>(<u>a</u>)</code><td>at least one non-zero character<td><code><span class="k">any</span>(<span class="s">"c"</span>)</code> is <code><span>true</span></code>
<tr><td><code><span class="k">repr</span>(<u>a</u>)</code><td>representation to string<td><code><span class="k">str</span>(<span class="s">"a"</span>)</code> is <code><span class="s">'"a"'</span></code>
<tr><td><code><span class="k">format</span>(<u>s</u>, &lowast;)</code><td>string formatting<td><code><span class="k">format</span>(<span class="s">"<span>%02x</span>"</span>, <span>12</span>)</code> is <code><span class="s">"0c"</span></code>
</tbody>
</table></div>

<p>A string has a truth value of true if it contains at least one character which is not translated to zero.</p>

<p>Strings are converted to integers, byte and bit strings as necessary using the current
encoding and escape rules. For example when using a sane encoding <code>"z"&minus;"a"</code> is
<code>25</code>.</p>

<p>Indexing characters with positive integers start with zero. Negative indexes
are translated internally by adding the number of characters to them, therefore
&minus;1 can be used to access the last character. Indexing with list of integers is
possible as well so <code>"abc"[(&minus;1, 0, 1)]</code> is <code>"cab"</code>.</p>

<p>Slicing is an operation when parts of string are extracted from a start
position to an end position with a step value. These parameters are separated
with colons enclosed in square brackets and are all optional. Their default
values are [start:maximum:step=1]. Negative start and end characters are
converted to positive internally by adding the length of string to them.
Negative step operates in reverse direction, non single steps will jump over
characters.</p>

<pre width=80>
mystr   <b>=</b> <span class="s">"oeU"</span>         <i>; text</i>
        <b class="d">.text</b> <span class="s">'it''s'</span>   <i>; text: it's</i>
        <b class="d">.word</b> <span class="s">"ab"</span>+<span>1</span>    <i>; character, results in "bb" usually</i>

        <b class="d">.text</b> <span class="s">"text"</span>[:<span>2</span>]     <i>; "te"</i>
        <b class="d">.text</b> <span class="s">"text"</span>[<span>2</span>:]     <i>; "xt"</i>
        <b class="d">.text</b> <span class="s">"text"</span>[:<span>-1</span>]    <i>; "tex"</i>
        <b class="d">.text</b> <span class="s">"reverse"</span>[::<span>-1</span>]<i>; "esrever"</i>
</pre>

<p>String formatting can interpret a list of values and convert them to a string.
The converted values are inserted at the <code>%</code> sign which is followed by
conversion flags, minimum field length, and conversion type. The these flags
can be used:</p>

<div><table border="0">
<caption>Formatting flags</caption>
<tbody>
<tr><td width="40"><code>#</code><td>alternate form ($a, %10, 10.)
<tr><td><code>&lowast;</code><td>width/precision from list
<tr><td><code>.</code><td>precision
<tr><td><code>0</code><td>pad with zeros
<tr><td><code>&minus;</code><td>left adjusted (default right)
<tr><td><code>&nbsp;</code><td>blank when positive or minus sign
<tr><td><code>+</code><td>sign even if positive
</tbody>
</table></div>

<p>The following conversions are implemented:</p>

<div><table border="0">
<caption>Formatting conversions</caption>
<tbody>
<tr><td width="40"><code>a&nbsp;A</code><td>hexadecimal floating point (uppercase)
<tr><td><code>b</code><td>binary
<tr><td><code>c</code><td>unicode character
<tr><td><code>d</code><td>decimal
<tr><td><code>e&nbsp;E</code><td>exponential float (uppercase)
<tr><td><code>f&nbsp;F</code><td>floating point (uppercase)
<tr><td><code>g&nbsp;G</code><td>exponential/floating point
<tr><td><code>s</code><td>string
<tr><td><code>r</code><td>representation
<tr><td><code>x&nbsp;X</code><td>hexadecimal (uppercase)
<tr><td><code>%</code><td>percent sign
</tbody>
</table></div>

<pre width=80>
        <b class="d">.text</b> <span class="k">format</span>(<span class="s">"<span>%#04x</span> bytes left"</span>, <span>1000</span>)<i>; $03e8 bytes left</i>
</pre>

<h3>Byte string constants<a name="byte-string" href="#byte-string"></a></h3>

<p>Byte strings are like strings, but hold bytes instead of characters. They
can be created by prefixing quoted strings with a <q>b</q>, this converts the
string using the current encoding to bytes.</p>

<div><table border="0">
<caption>Byte string operators and functions</caption>
<tbody>
<tr><td><code><u>y</u> .. <u>x</u></code><td>concatenate strings<td><code><span class="s">b"a"</span> .. <span class="s">b"b"</span></code> is <code><span class="s">b"ab"</span></code>
<tr><td><code><u>y</u> <span class="k">in</span> <u>x</u></code><td>is substring of<td><code><span class="s">b"b"</span> <span class="k">in</span> <span class="s">b"abc"</span></code> is <code><span>true</span></code>
<tr><td><code><u>a</u> <span class="k">x</span> <u>n</u></code><td>repeat<td><code><span class="s">b"ab"</span> <span class="k">x</span> <span>3</span></code> is <code><span class="s">b"ababab"</span></code>
<tr><td><code><u>a</u>[<u>i</u>]</code><td>byte from start<td><code><span class="s">b"abc"</span>[<span>1</span>]</code> is <code><span class="s">b"b"</span></code>
<tr><td><code><u>a</u>[<u>i</u>]</code><td>byte from end<td><code><span class="s">b"abc"</span>[<span>&minus;1</span>]</code> is <code><span class="s">b"c"</span></code>
<tr><td><code><u>a</u>[<u>s</u>]</code><td>no change<td><code><span class="s">b"abc"</span>[:]</code> is <code><span class="s">b"abc"</span></code>
<tr><td><code><u>a</u>[<u>s</u>]</code><td>cut off start<td><code><span class="s">b"abc"</span>[<span>1</span>:]</code> is <code><span class="s">b"bc"</span></code>
<tr><td><code><u>a</u>[<u>s</u>]</code><td>cut off end<td><code><span class="s">b"abc"</span>[:<span>&minus;1</span>]</code> is <code><span class="s">b"ab"</span></code>
<tr><td><code><u>a</u>[<u>s</u>]</code><td>reverse<td><code><span class="s">b"abc"</span>[::<span>&minus;1</span>]</code> is <code><span class="s">b"cba"</span></code>
<tr><td><code><span class="k">len</span>(<u>a</u>)</code><td>number of bytes<td><code><span class="k">len</span>(<span class="s">b"abc"</span>)</code> is <code><span>3</span></code>
<tr><td><code><span class="k">all</span>(<u>a</u>)</code><td>all bytes non-zero or no bytes<td><code><span class="k">all</span>(<span class="s">b"c"</span>)</code> is <code><span>true</span></code>
<tr><td><code><span class="k">any</span>(<u>a</u>)</code><td>at least one non-zero byte<td><code><span class="k">any</span>(<span class="s">b"c"</span>)</code> is <code><span>true</span></code>
</tbody>
</table></div>

<p>A byte string has a truth value of true if it contains at least one non-zero byte.</p>

<p>Indexing and slicing works as with character strings.</p>

<pre width=80>
        <b class="k">.enc</b> screen	<i>;use screen encoding</i>
mystr   <b>=</b> <span class="s">b"oeU"</span>        <i>;convert text to bytes</i>
        <b class="k">.enc</b> none	<i>;normal encoding</i>

        <b class="d">.text</b> <u>mystr</u>     <i>;text as originally encoded</i>
</pre>

<h3>List and tuples<a name="list-tuples" href="#list-tuples"></a></h3>

<p>Lists and tuples can hold a collection of values. Lists are defined from
values separated by comma between square brackets <code>[1, 2, 3]</code>, an
empty list is <code>[]</code>. Tuples are similar but are enclosed in
parentheses instead. An empty tuple is <code>()</code>, a single element tuple
is <code>(4,)</code> to differentiate from normal numeric expression
parentheses. When nested they function similar to an array. Currently both
types are immutable.</p>

<div><table border="0">
<caption>List and tuple operators and functions</caption>
<tbody>
<tr><td><code><u>y</u> .. <u>x</u></code><td>concatenate lists<td><code>[<span>1</span>] .. [<span>2</span>]</code> is <code>[<span>1</span>, <span>2</span>]</code>
<tr><td><code><u>y</u> <span class="k">in</span> <u>x</u></code><td>is member of list<td><code><span>2</span> <span class="k">in</span> [<span>1</span>, <span>2</span>, <span>3</span>]</code> is <code><span>true</span></code>
<tr><td><code><u>a</u> <span class="k">x</span> <u>n</u></code><td>repeat<td><code>[<span>1</span>, <span>2</span>] <span class="k">x</span> <span>2</span></code> is <code>[<span>1</span>, <span>2</span>, <span>1</span>, <span>2</span>]</code>
<tr><td><code><u>a</u>[<u>i</u>]</code><td>element from start<td><code>(<span class="s">"1"</span>, <span>2</span>)[<span>1</span>]</code> is <code><span>2</span></code>
<tr><td><code><u>a</u>[<u>i</u>]</code><td>element from end<td><code>(<span class="s">"1"</span>, <span>2</span>, <span>3</span>)[<span>&minus;1</span>]</code> is <code><span>3</span></code>
<tr><td><code><u>a</u>[<u>s</u>]</code><td>no change<td><code>(<span>1</span>, <span>2</span>, <span>3</span>)[:]</code> is <code>(<span>1</span>, <span>2</span>, <span>3</span>)</code>
<tr><td><code><u>a</u>[<u>s</u>]</code><td>cut off start<td><code>(<span>1</span>, <span>2</span>, <span>3</span>)[<span>1</span>:]</code> is <code>(<span>2</span>, <span>3</span>)</code>
<tr><td><code><u>a</u>[<u>s</u>]</code><td>cut off end<td><code>(<span>1</span>, <span>2.0</span>, <span>3</span>)[:<span>&minus;1</span>]</code> is <code>(<span>1</span>, <span>2.0</span>)</code>
<tr><td><code><u>a</u>[<u>s</u>]</code><td>reverse<td><code>(<span>1</span>, <span>2</span>, <span>3</span>)[::<span>&minus;1</span>]</code> is <code>(<span>3</span>, <span>2</span>, <span>1</span>)</code>
<tr><td><code>&lowast;<u>a</u></code><td>convert to arguments<td><code><span class="k">format</span>(<span class="s">"%d: %s"</span>, &lowast;<u>mylist</u>)</code>
<tr><td><code><span class="k">len</span>(<u>a</u>)</code><td>number of elements<td><code><span class="k">len</span>([<span>1</span>, <span>2</span>, <span>3</span>])</code> is <code><span>3</span></code>
<tr><td><code><span class="k">all</span>(<u>a</u>)</code><td>all elements true or empty list<td><code><span class="k">all</span>([<span>1</span>, <span>1</span>, <span>0</span>])</code> is <code><span>false</span></code>
<tr><td><code><span class="k">any</span>(<u>a</u>)</code><td>at least one true element<td><code><span class="k">any</span>([<span>1</span>, <span>1</span>, <span>0</span>])</code> is <code><span>true</span></code>
<tr><td><code><span class="k">range</span>(<u>s</u>,<u>e</u>,<u>t</u>)</code><td>create a list with values from a range<td><code><span class="k">range</span>(<span>3</span>)</code> is <code>[<span>0</span>,<span>1</span>,<span>2</span>]</code>
</tbody>
</table></div>

<p>Arithmetic operations are applied on the all elements recursively,
therefore <code>[1, 2] + 1</code> is <code>[2, 3]</code>, and <code>abs([1,
&minus;1])</code> is <code>[1, 1]</code>.</p>

<p>Arithmetic operations between lists are applied one by one on their
elements, so <code>[1, 2] + [3, 4]</code> is <code>[4, 6]</code>.</p>

<p>When lists form an array and columns/rows are missing the smaller array is
stretched to fill in the gaps if possible, so <code>[[1], [2]] &lowast; [3, 4]</code>
is <code>[[3, 4], [6, 8]]</code>.</p>

<p>Indexing elements with positive integers start with zero. Negative indexes
are transformed to positive by adding the number of elements to them, therefor
&minus;1 is the last element. Indexing with list of integers is possible as well so
<code>[1, 2, 3][(&minus;1, 0, 1)]</code> is <code>[3, 1, 2]</code>.</p>

<p>Slicing is an operation when parts of list or tuple are extracted from a
start position to an end position with a step value. These parameters are
separated with colons enclosed in square brackets and are all optional. Their
default values are [start:maximum:step=1]. Negative start and end elements are
converted to positive internally by adding the number of elements to them.
Negative step operates in reverse direction, non single steps will jump over
elements.</p>

<pre width=80>
mylist  <b>=</b> [<span>1</span>, <span>2</span>, <span class="s">"whatever"</span>]
mytuple <b>=</b> (<u>cmd_e</u>, <u>cmd_g</u>)

mylist  <b>=</b> (<span class="s">"e"</span>, <u>cmd_e</u>, <span class="s">"g"</span>, <u>cmd_g</u>, <span class="s">"i"</span>, <u>cmd_i</u>)
keys    <b class="d">.text</b> <u>mylist</u>[::<span>2</span>]    <i>; keys ("e", "g", "i")</i>
call_l  <b class="d">.byte</b> &lt;<u>mylist</u>[<span>1</span>::<span>2</span>]-<span>1</span><i>; routines (&lt;cmd_e&minus;1, &lt;cmd_g&minus;1, &lt;cmd_i&minus;1)</i>
call_h  <b class="d">.byte</b> &gt;<u>mylist</u>[<span>1</span>::<span>2</span>]-<span>1</span><i>; routines (&gt;cmd_e&minus;1, &gt;cmd_g&minus;1, &gt;cmd_i&minus;1)</i>
</pre>

<p>The <code>range(start, end, step)</code> built-in function can be used to
create lists of integers in a range with a given step value. At least the end
must be given, the start defaults to 0 and the step to 1. Sounds not very
useful, so here are a few examples:</p>

<pre width=80>
<i>;Bitmask table, 8 bits from left to right</i>
        <b class="d">.byte</b> <span>%10000000</span> &gt;&gt; <span class="k">range</span>(<span>8</span>)
<i>;Classic 256 byte single period sinus table with values of 0&minus;255.</i>
        <b class="d">.byte</b> <span>128.5</span> + <span>127</span> * <span class="k">sin</span>(<span class="k">range</span>(<span>256</span>) * <span class="k">rad</span>(<span>360.0</span>/<span>256</span>))
<i>;Screen row address tables</i>
-       <b>=</b> <span>$400</span> + <span class="k">range</span>(<span>0</span>, <span>1000</span>, <span>40</span>)
scrlo   <b class="d">.byte</b> &lt;(<u>-</u>)
scrhi   <b class="d">.byte</b> &gt;(<u>-</u>)
</pre>

<h3>Dictionaries<a name="dictionaries" href="#dictionaries"></a></h3>

<p>Dictionaries are unsorted lists holding key and value pairs. Definition is
done by collecting key:value pairs separated by comma between braces
<code>{1:"value", "key":1, :"optional default value"}</code>.</p>

<p>Looking up a non existing key is normally an error
unless a default value is given. An
empty dictionary is <code>{}</code>. Currently this type is immutable. Numeric
and string keys are accepted, the value can be anything.</p>

<div><table border="0">
<caption>Dictionary operators and functions</caption>
<tbody>
<tr><td><code><u>x</u>[<u>i</u>]</code><td>value lookup<td><code>{<span class="s">"1"</span>:<span>2</span>}[<span class="s">"1"</span>]</code> is <code><span>2</span></code>
<tr><td><code><u>y</u> <span class="k">in</span> <u>x</u></code><td>is a key<td><code><span>1</span> <span class="k">in</span> {<span>1</span>:<span>2</span>}</code> is <code><span>true</span></code>
<tr><td><code><span class="k">len</span>(<u>x</u>)</code><td>number of elements<td><code><span class="k">len</span>({<span>1</span>:<span>2</span>, <span>3</span>:<span>4</span>])</code> is <code><span>2</span></code>
</tbody>
</table></div>

<p>A dictionary has a truth value of true if it contains at least one key value pair.</p>

<pre width=80>
        <b class="d">.text</b> {<span>1</span>:<span class="s">"one"</span>, <span>2</span>:<span class="s">"two"</span>}[<span>2</span>]<i>; "two"</i>
</pre>

<h3>Code<a name="code" href="#code"></a></h3>
<p>Code holds the result of compilation in binary and other enclosed objects.
In an arithmetic operation it's used as the numeric address of the memory where
it starts. The compiled content remains static even if later parts of the
source overwrite the same memory area.</p>

<p><b>Indexing and slicing of code to access the compiled content might be
implemented differently in future releases. Use this feature at your own
risk for now, you might need to update your code later.</b></p>

<div><table border="0">
<caption>Label operators and functions</caption>
<tbody>
<tr><td><code><u>a</u>.<u>b</u></code><td>member<td><code><u>label</u>.<u>locallabel</u></code>
<tr><td><code><u>a</u>[<u>i</u>]</code><td>element from start<td><code><u>label</u>[<span>1</span>]</code>
<tr><td><code><u>a</u>[<u>i</u>]</code><td>element from end<td><code><u>label</u>[<span>&minus;1</span>]</code>
<tr><td><code><u>a</u>[<u>s</u>]</code><td>copy as tuple<td><code><u>label</u>[:]</code>
<tr><td><code><u>a</u>[<u>s</u>]</code><td>cut off start, as tuple<td><code><u>label</u>[<span>1</span>:]</code>
<tr><td><code><u>a</u>[<u>s</u>]</code><td>cut off end, as tuple<td><code><u>label</u>[:<span>&minus;1</span>]</code>
<tr><td><code><u>a</u>[<u>s</u>]</code><td>reverse, as tuple<td><code><u>label</u>[::<span>&minus;1</span>]</code>
<tr><td><code><span class="k">len</span>(<u>a</u>)</code><td>number of elements<td><code><span class="k">len</span>(<u>label</u>)</code>
<tr><td><code><span class="k">size</span>(<u>a</u>)</code><td>size in bytes<td><code><span class="k">size</span>(<u>label</u>)</code>
</tbody>
</table></div>

<p>A code object has a truth value of true when it's address is non-zero.</p>

<pre width=80>
mydata  <b class="d">.word</b> <span>1</span>, <span>4</span>, <span>3</span>
mycode  <b class="k">.block</b>
local   <b>lda</b> #<span>0</span>
        <b class="k">.bend</b>

        <b>ldx</b> #<span class="k">size</span>(<u>mydata</u>) <i>;6 bytes (3&lowast;2)</i>
        <b>ldx</b> #<span class="k">len</span>(<u>mydata</u>)  <i>;3 elements</i>
        <b>ldx</b> #<u>mycode</u>[<span>0</span>]    <i>;lda instruction, $a9</i>
        <b>ldx</b> #<u>mydata</u>[<span>1</span>]    <i>;2nd element, 4</i>
        <b>jmp</b> <u>mycode</u>.<u>local</u>  <i>;address of local label</i>
</pre>

<h3>Addressing modes<a name="addressing" href="#addressing"></a></h3>

<p>Addressing modes are used for determining addressing modes of
instructions.</p>

<p>There must be no white space between the comma and the register letter,
otherwise the operator is not recognized. On the other hand put a space between
the comma and a single letter symbol in a list to avoid it being recognized
as an operator.</p>

<div><table border="0">
<caption>Addressing mode operators</caption>
<tbody>
<tr><td><code>#</code><td>immediate
<tr><td><code>(</code><td>indirect
<tr><td><code>[</code><td>long indirect
<tr><td><code>,b</code><td>data bank indexed
<tr><td><code>,d</code><td>direct page indexed
<tr><td><code>,k</code><td>program bank indexed
<tr><td><code>,r</code><td>data stack pointer indexed
<tr><td><code>,s</code><td>stack pointer indexed
<tr><td><code>,x</code><td>x register indexed
<tr><td><code>,y</code><td>y register indexed
<tr><td><code>,z</code><td>z register indexed
</tbody>
</table></div>

<p>Parentheses are used for indirection and square brackets for long
indirection. These operations are only available after instructions and
functions to not interfere with their normal use in expressions.</p>

<p>Several addressing mode operators can be combined together. <b>Currently the
complexity is limited to 3 operators. This is enough to describe all addressing
modes of the supported CPUs.</b></p>

<div><table border="0">
<caption>Valid addressing mode operator combinations</caption>
<tbody>
<tr><td><code>#</code><td>immediate<td><code><b>lda</b>&nbsp;#<span>$12</span></code>
<tr><td><code>#<u>addr</u>,#<u>addr</u></code><td>move<td><code><b>mvp</b>&nbsp;#<span>5</span>,#<span>6</span></code>
<tr><td><code><u>addr</u></code><td>direct or relative<td><code><b>lda</b>&nbsp;<span>$12</span> <b>lda</b>&nbsp;<span>$1234</span> <b>bne</b>&nbsp;<span>$1234</span></code>
<tr><td><code><u>addr</u>,<u>addr</u></code><td>direct page bit<td><code><b>rmb</b>&nbsp;<span>5</span>,<span>$12</span></code>
<tr><td><code><u>addr</u>,<u>addr</u>,<u>addr</u></code><td>direct page bit relative jump<td><code><b>bbs</b>&nbsp;<span>5</span>,<span>$12</span>,<span>$1234</span></code>
<tr><td><code>(<u>addr</u>)</code><td>indirect<td><code><b>lda</b>&nbsp;(<span>$12</span>) <b>jmp</b>&nbsp;(<span>$1234</span></code>)
<tr><td><code>(<u>addr</u>),y</code><td>indirect y indexed<td><code><b>lda</b>&nbsp;(<span>$12</span>),y</code>
<tr><td><code>(<u>addr</u>),z</code><td>indirect z indexed<td><code><b>lda</b>&nbsp;(<span>$12</span>),z</code>
<tr><td><code>(<u>addr</u>,x)</code><td>x indexed indirect<td><code><b>lda</b>&nbsp;(<span>$12</span>,x) <b>jmp</b>&nbsp;(<span>$1234</span>,x)</code>
<tr><td><code>[<u>addr</u>]</code><td>long indirect<td><code><b>lda</b>&nbsp;[<span>$12</span>] <b>jmp</b>&nbsp;[<span>$1234</span>]</code>
<tr><td><code>[<u>addr</u>],y</code><td>long indirect y indexed<td><code><b>lda</b>&nbsp;[<span>$12</span>],y</code>
<tr><td><code><u>addr</u>,b</code><td>data bank indexed<td><code><b>lda</b>&nbsp;<span>0</span>,b</code>
<tr><td><code><u>addr</u>,b,x</code><td>data bank x indexed<td><code><b>lda</b>&nbsp;<span>0</span>,b,x</code>
<tr><td><code><u>addr</u>,b,y</code><td>data bank y indexed<td><code><b>lda</b>&nbsp;<span>0</span>,b,y</code>
<tr><td><code><u>addr</u>,d</code><td>direct page indexed<td><code><b>lda</b>&nbsp;<span>0</span>,d</code>
<tr><td><code><u>addr</u>,d,x</code><td>direct page x indexed<td><code><b>lda</b>&nbsp;<span>0</span>,d,x</code>
<tr><td><code><u>addr</u>,d,y</code><td>direct page y indexed<td><code><b>ldx</b>&nbsp;<span>0</span>,d,y</code>
<tr><td><code>(<u>addr</u>,d)</code><td>direct page indirect<td><code><b>lda</b>&nbsp;(<span>$12</span>,d)</code>
<tr><td><code>(<u>addr</u>,d,x)</code><td>direct page x indexed indirect<td><code><b>lda</b>&nbsp;(<span>$12</span>,d,x)</code>
<tr><td><code>(<u>addr</u>,d),y</code><td>direct page indirect y indexed<td><code><b>lda</b>&nbsp;(<span>$12</span>,d),y</code>
<tr><td><code>(<u>addr</u>,d),z</code><td>direct page indirect z indexed<td><code><b>lda</b>&nbsp;(<span>$12</span>,d),z</code>
<tr><td><code>[<u>addr</u>,d]</code><td>direct page long indirect<td><code><b>lda</b>&nbsp;[<span>$12</span>,d]</code>
<tr><td><code>[<u>addr</u>,d],y</code><td>direct page long indirect y indexed<td><code><b>lda</b>&nbsp;[<span>$12</span>,d],y</code>
<tr><td><code><u>addr</u>,k</code><td>program bank indexed<td><code><b>jsr</b>&nbsp;<span>0</span>,k</code>
<tr><td><code>(<u>addr</u>,k,x)</code><td>program bank x indexed indirect<td><code><b>jmp</b>&nbsp;(<span>$1234</span>,k,x)</code>
<tr><td><code><u>addr</u>,r</code><td>data stack indexed<td><code><b>lda</b>&nbsp;<span>1</span>,r</code>
<tr><td><code>(<u>addr</u>,r),y</code><td>data stack indexed indirect y indexed<td><code><b>lda</b>&nbsp;(<span>$12</span>,r),y</code>
<tr><td><code><u>addr</u>,s</code><td>stack indexed<td><code><b>lda</b>&nbsp;<span>1</span>,s</code>
<tr><td><code>(<u>addr</u>,s),y</code><td>stack indexed indirect y indexed<td><code><b>lda</b>&nbsp;(<span>$12</span>,s),y</code>
<tr><td><code><u>addr</u>,x</code><td>x indexed<td><code><b>lda</b>&nbsp;<span>$12</span>,x</code>
<tr><td><code><u>addr</u>,y</code><td>y indexed<td><code><b>lda</b>&nbsp;<span>$12</span>,y</code>
</tbody>
</table></div>

<p>The direct page indexed addressing mode is not affected by the
<code>.dpage</code> directive and always forces the 8&nbsp;bit address as
is. It's only usable for direct/zero page instructions.</p>

<p>The data bank indexed addressing mode is not affected by the
<code>.databank</code> directive and always forces the 16&nbsp;bit address
as is. It's only usable with data bank accessing instructions.</p>

<p>The program bank indexed addressing mode is not affected by the
current program bank and always generates the 16&nbsp;bit constant value as
is. It's only usable with jump instructions.</p>

<p>Normally addressing mode operators are used right after instructions. They
can also be used for defining stack variable symbols when using a 65816, or to
force a specific addressing modes.</p>

<pre width=80>
param   <b>=</b> <span>1</span>,s             <i>;define a stack variable</i>
const   <b>=</b> #<span>1</span>              <i>;immediate constant</i>
        <b>lda</b> <span>0</span>,b           <i>;always "absolute" lda $0000</i>
        <b>lda</b> <u>param</u>         <i>;results in lda $01,s</i>
        <b>lda</b> <u>param</u>+<span>1</span>       <i>;results in lda $02,s</i>
        <b>lda</b> (<u>param</u>),y     <i>;results in lda ($01,s),y</i>
        <b>ldx</b> <u>const</u>         <i>;results in ldx #$01</i>
</pre>

<h3>Uninitialized memory<a name="uninitialized" href="#uninitialized"></a></h3>

<p>There's a special value for uninitialized memory, it's represented by a
question mark. Whenever it's used to generate data it creates a <q>hole</q>
where the previous content of memory is visible.</p>

<p>Uninitialized memory holes without previous content are not saved unless
it's really necessary for the output format, in that case it's replaced with
zeros.</p>

<p>It's not just data generation statements (e.g. <code>.byte</code>) that can
create uninitialized memory, but filling, alignment or address manipulation as
well.</p>

<pre width=80>
        <b>*=</b> <span>$200</span>         <i>;bytes as necessary</i>
	<b class="d">.word</b> <span>?</span>         <i>;2 bytes</i>
	<b class="d">.fill</b> <span>10</span>        <i>;10 bytes</i>
	<b class="k">.align</b> <span>64</span>       <i>;bytes as necessary</i>
	<b class="k">.offs</b> <span>16</span>        <i>;16 bytes</i>
</pre>

<h3>Types<a name="type" href="#type"></a></h3>

<p>The various types mentioned earlier have predefined names. These can
used for conversions or type checks.</p>

<div><table border="0">
<caption>Built-in type names</caption>
<tbody>
<tr><td><code><a name="t_address"><u>address</u></a></code><td>Address type
<tr><td><code><a name="t_bits"><u>bits</u></a></code><td>Bit string type
<tr><td><code><a name="t_bool"><u>bool</u></a></code><td>Boolean type
<tr><td><code><a name="t_bytes"><u>bytes</u></a></code><td>Byte string type
<tr><td><code><a name="t_code"><u>code</u></a></code><td>Code type
<tr><td><code><a name="t_dict"><u>dict</u></a></code><td>Dictionary type
<tr><td><code><a name="t_float"><u>float</u></a></code><td>Floating point type
<tr><td><code><a name="t_gap"><u>gap</u></a></code><td>Uninitialized memory type
<tr><td><code><a name="t_int"><u>int</u></a></code><td>Integer type
<tr><td><code><a name="t_list"><u>list</u></a></code><td>List type
<tr><td><code><a name="t_str"><u>str</u></a></code><td>String type
<tr><td><code><a name="t_tuple"><u>tuple</u></a></code><td>Tuple type
<tr><td><code><a name="t_type"><u>type</u></a></code><td>Type type
</tbody>
</table></div>

<pre width=80>
        <b class="k">.cerror</b> <span class="k">type</span>(<u>var</u>) != <u>str</u>, <span class="s">"Not a string!"</span>
        <b class="d">.text</b> <span class="k">str</span>(<u>year</u>)   <i>; convert to string</i>
</pre>

<h3>Symbols<a name="symbols" href="#symbols"></a></h3>

<p>Symbols are used to reference objects. Regularly named, anonymous and local
symbols are supported. These can be constant or re-definable.</p>

<p>Scopes are where symbols are stored and looked up. The global scope is
always defined and it can contain any number of nested scopes.</p>

<p>Symbols must be uniquely named in a scope, therefore in big programs it's
hard to come up with useful and easy to type names. That's why local and anonymous symbols
exists. And grouping certain related symbols into a scope makes sense sometimes
too.</p>

<p>Scopes are usually created by <code>.proc</code> and <code>.block</code>
directives, but there are a few other ways. Symbols in a scope can be accessed
by using the dot operator, which is applied between the name of the scope and the symbol (e.g. <code>myconsts.math.pi</code>).</p>

<h4>Regular symbols<a name="symbols-regular" href="#symbols-regular"></a></h4>

<p>Regular symbol names are starting with a letters and containing letters,
numbers and underscores. There's no restriction on the length of symbol names.</p>

<p>Care must be taken to not use the duplicate names in the same scope when the
symbol is used as a constant.</p>

<p>Duplicate names in parent scopes are never a problem, they'll just be
<q>shadowed</q>. This could be either good by reducing collisions and gives the
ability to override <q>defaults</q> defined in lower scopes. On the other hand
it's possible to mix-up the new symbol with a old one by mistake, which is hard
to notice.</p>

<p>A regular symbol is looked up first in the current scope, then in lower scopes
until the global scope is reached.</p>

<pre width=80>
f       <b class="k">.block</b>
g        <b class="k">.block</b>
n        <b>nop</b>            <i>;jump here</i>
	 <b class="k">.bend</b>
	<b class="k">.bend</b>

        <b>jsr</b> <u>f</u>.<u>g</u>.<u>n</u>       <i>;reference from a scope</i>
f.x     <b>=</b> <span>3</span>             <i>;create x in scope f with value 3</i>
</pre>

<h4>Local symbols<a name="symbols-local" href="#symbols-local"></a></h4>

<p>Local symbols have their own scope between two regularly named code symbols
and are assigned to the code symbol above them.</p>

<p>Therefore they're easy to reuse without explicit scope declaration directives.</p>

<p>Not all regularly named symbols can be scope boundaries just plain code symbol ones
without anything or an opcode after them (no macros!). Symbols defined as procedures, blocks,
macros, functions, structs and unions are ignored. Also symbols defined by
<code>.var</code> or <code>=</code> don't apply, and there are a few more
exceptions, so stick to using plain code labels.</p>

<p>The name must start with an underscore (<tt>_</tt>), otherwise the same character
restrictions apply as for regular symbols. There's no restriction on the length of the name.</p>

<p>Care must be taken to not use the duplicate names in the same scope when the
symbol is used as a constant.</p>

<p>A local symbol is only looked up in it's own scope and nowhere else.</p>

<pre width=80>
incr	<b>inc</b> <u>ac</u>
        <b>bne</b> <u>_skip</u>
        <b>inc</b> <u>ac</u>+<span>1</span>
_skip	<b>rts</b>

decr	<b>lda</b> <u>ac</u>
        <b>bne</b> <u>_skip</u>
        <b>dec</b> <u>ac</u>+<span>1</span>
_skip	<b>dec</b> <u>ac</u>          <i>;symbol reused here</i>
        <b>jmp</b> <u>incr</u>.<u>_skip</u>  <i>;this works too, but is not advised</i>
</pre>

<h4>Anonymous symbols<a name="symbols-anonymous" href="#symbols-anonymous"></a></h4>

<p>Anonymous symbols don't have a unique name and are always called as a single plus or minus sign. They are also called as forward (<code>+</code>)
and backward (<code>&minus;</code>) references.</p>
<p>When referencing them <q><code>&minus;</code></q> means the first backward,
<q><code>&minus;&minus;</code></q> means the second backwards and so on. It's the same for forward, but with
<q><code>+</code></q>. In expressions it may be necessary to put them into brackets.</p>

<pre width=80>
        <b>ldy</b> #<span>4</span>
-       <b>ldx</b> #<span>0</span>
-       <b>txa</b>
        <b>cmp</b> #<span>3</span>
	<b>bcc</b> +
        <b>adc</b> #<span>44</span>
+       <b>sta</b> <span>$400</span>,x
	<b>inx</b>
	<b>bne</b> -
	<b>dey</b>
	<b>bne</b> --
</pre>

<p>Excessive nesting or long distance references create poorly readable code.
It's also very easy to copy-paste a few lines of code with these references into
a code fragment already containing similar references. The result is usually a
long debugging session to find out what went wrong.</p>

<p>These references are also useful in segments, but this can create a nice
trap when segments are copied into the code with their internal references.</p>

<pre width=80>
	<b>bne</b> +
        <b class="k">#somemakro</b>      <i>;let's hope that this segment does</i>
+	<b>nop</b>             <i>;not contain forward references...</i>
</pre>

<p>A anonymous symbols are looked up first in the current scope, then in lower scopes
until the global scope is reached.</p>

<h4>Constant and re-definable symbols<a name="symbols-constant" href="#symbols-constant"></a></h4>

<p>Constant symbols can be created with the equal sign. These are not
re-definable. Forward referencing to them is allowed as they retain the
objects over compilation passes.</p>

<p>Symbols in front of code or certain assembler directives are created as
constant symbols too. They are binded to the object following them.</p>

<p>Re-definable symbols can be created by the <code>.var</code> directive.
These are also called as variables as they don't carry their content over from
the previous pass it's not possible to use them before definition.</p>

<pre width=80>
border  <b>=</b> <span>$d020</span>         <i>;a constant</i>
        <b>inc</b> <u>border</u>      <i>;inc $d020</i>
variabl	<b class="k">.var</b> <span>1</span>          <i>;a variable</i>
        <b class="k">.rept</b> <span>10</span>
        <b class="d">.byte</b> <u>variabl</u>
variabl	<b class="k">.var</b> <u>variabl</u>+<span>1</span>  <i>;increment it</i>
	<b class="k">.next</b>
</pre>

<h3>Conditional expressions<a name="conditionals" href="#conditionals"></a></h3>
<p>Boolean conditional operators give false (0) or true (1) or one of the
operands as the result. True is defined as a non-zero number, anything else is false.</p>

<p>The ternary operator (<code>?:</code>) gives the first (x) result if c is
true or the second (y) if c is false.</p>

<div><table border="0">
<caption>Logical and conditional operators</caption>
<tbody>
<tr><td width="80"><code><u>x</u> || <u>y</u></code><td>if x is true then x otherwise y
<tr><td><code><u>x</u> ^^ <u>y</u></code><td>if both false or true then false otherwise x || y
<tr><td><code><u>x</u> &amp;&amp; <u>y</u></code><td>if x is true then y otherwise x
<tr><td><code>!<u>x</u></code><td>if x is true then false otherwise true
<tr><td><code>!!<u>x</u></code><td>if x is true then true otherwise false
<tr><td><code><u>c</u>&nbsp;?&nbsp;<u>x</u>&nbsp;:&nbsp;<u>y</u></code><td>if c is true then x otherwise y
</tbody>
</table></div>

<pre width=80>
<i>;Silly example for 1=>"simple", 2=>"advanced", else "normal"</i>
        <b class="d">.text</b> <u>MODE</u> == <span>1</span> &amp;&amp; <span class="s">"simple"</span> || <u>MODE</u> == <span>2</span> &amp;&amp; <span class="s">"advanced"</span> || <span class="s">"normal"</span>
        <b class="d">.text</b> <u>MODE</u> == <span>1</span> ? <span class="s">"simple"</span> : <u>MODE</u> == <span>2</span> ? <span class="s">"advanced"</span> : <span class="s">"normal"</span>
</pre>

<p>Please note that these are not short circuiting operations and both sides are
calculated even if thrown away later.</p>

<h3>Expressions<a name="expressions" href="#expressions"></a></h3>

<p>Parenthesis (<code>( )</code>) can be used to override operator precedence.
Don't forget that they also denote indirect addressing mode for certain
opcodes.</p>

<pre width=80>
        <b>lda</b> #(<span>4</span>+<span>2</span>)*<span>3</span>
</pre>

<p>Built-in functions are identifiers followed by parentheses. They accept
variable number of parameters separated by comma. For math functions see the
floating point constants section.</p>

<div><table border="0">
<caption>General built-in functions</caption>
<tbody>
<tr><td width="150"><code><span class="k"><a name="f_abs">abs</a></span>(<u>a</u>)</code><td>absolute value
<tr><td><code><span class="k"><a name="f_all">all</a></span>(<u>a</u>)</code><td>all elements true or no elements
<tr><td><code><span class="k"><a name="f_any">any</a></span>(<u>a</u>)</code><td>any elements true
<tr><td><code><span class="k"><a name="f_format">format</a></span>(<u>s</u>, &lowast;)</code><td>convert to string with formatting
<tr><td><code><span class="k"><a name="f_len">len</a></span>(<u>a</u>)</code><td>number of elements
<tr><td><code><span class="k"><a name="f_range">range</a></span>(<u>s</u>, <u>e</u>, <u>t</u>)</code><td>create a list with values from a range
<tr><td><code><span class="k"><a name="f_repr">repr</a></span>(<u>a</u>)</code><td>representation to string
<tr><td><code><span class="k"><a name="f_sign">sign</a></span>(<u>a</u>)</code><td>sign value (&minus;1, 0, 1)
<tr><td><code><span class="k"><a name="f_size">size</a></span>(<u>a</u>)</code><td>size in bytes
</tbody>
</table></div>

<p>Special addressing mode forcing operators in front of an expression can be
used to make sure the expected addressing mode is used.</p>

<div><table border="0">
<caption>Address size forcing</caption>
<tbody>
<tr><td width="80"><code>@b</code><td>to force 8 bit address
<tr><td><code>@w</code><td>to force 16 bit address
<tr><td><code>@l</code><td>to force 24 bit address (65816)
</tbody>
</table></div>

<pre width=80>
        <b>lda</b> @w<span>$0000</span>
</pre>

<hr>
<h2>Compiler directives<a name="compiler-directives" href="#compiler-directives"></a></h2>

<h3>Controlling the compile offset and program counter<a name="program-counter" href="#program-counter"></a></h3>

<p>Two counters are used while assembling. The compile offset is where the data
and code ends up in memory, while the program counter is what labels will be
set or what the special star label gets when referenced.</p>

<dl class="dir">
<dt><code><b>&lowast;=</b></code> &lt;expression&gt;
<dd>The compile offset is moved so that the program counter will match the one
in the expression.
<dt><code><b class="k"><a name="d_offs">.offs</a></b></code> &lt;expression&gt;
<dd>Add an offset to the compile offset (create a gap). The program counter
stays the same as before.
<dt><code><b class="k"><a name="d_logical">.logical</a></b></code> &lt;expression&gt;
<dt><code><b class="k"><a name="d_here">.here</a></b></code>
<dd>Changes the program counter, the compile offset is not changed. Can be nested of course.
<dt><code><b class="k"><a name="d_align">.align</a></b></code> &lt;modulo&gt;[, &lt;fill&gt;]
<dd>Align code to a dividable program counter address by inserting uninitialized memory or repeated bytes.
</dl>
<pre width=80>
        <b>*=</b> <span>$1000</span>        <i>;set program counter (and offset)</i>

        <b class="k">.offs</b> <span>100</span>       <i>;gap of 100, PC still the same</i>

        <b class="k">.logical</b> <span>$300</span>   <i>;set PC to $300</i>
drive   <b>lda</b> #<span>$80</span>
        <b>sta</b> <span>$00</span>
        <b>jmp</b> <u>drive</u>       <i>;it's jmp $300</i>
	<b>rts</b>
	<b class="k">.here</b>

        <b class="k">.align</b> <span>$100</span>
irq     <b>inc</b> <span>$d019</span>       <i>;this will be on a page boundary, after skipping bytes</i>
        <b class="k">.align</b> <span>4</span>, <span>$ea</span>
loop    <b>adc</b> #<span>1</span>          <i>;padding with "nop" for DTV burst mode</i>
</pre>
<p>Here's an example how <code>.logical</code> and <code>&lowast;=</code> works together:</p>
<pre width=80>
        <b>*=</b> <span>$0800</span>       <i>;Compile: $0800, PC: $0800</i>
        <b class="k">.logical</b> <span>$1000</span> <i>;Compile: $0800, PC: $1000</i>
        <b>*=</b> <span>$1200</span>       <i>;Compile: $0a00, PC: $1200</i>
	<b class="k">.here</b>          <i>;Compile: $0a00, PC: $0a00</i>
</pre>

<h3>Dumping data<a name="data-dumping" href="#data-dumping"></a></h3>
<h4>Storing numeric data<a name="data-numeric" href="#data-numeric"></a></h4>
<p>Multi byte numeric data is stored in the little-endian order, which is the
natural byte order for 65xx processors. Numeric ranges are enforced depending
on the directives used.</p>
<p>When using lists or tuples their values will be used one by one.
Uninitialized data creates holes of different sizes. Small string constants are
converted using the current encoding.</p>
<p>Please note that multi character strings usually don't fit into 8&nbsp;bits
and therefore the <code>.byte</code> directive is not appropriate for them.
Better use <code>.text</code> for this sort of usage.</p>
<dl class="dir">
<dt><code><b class="d"><a name="d_byte">.byte</a></b></code> &lt;expression&gt;[, &lt;expression&gt;, &hellip;]
<dd>Create bytes from 8&nbsp;bit unsigned constants (0&ndash;255)
<dt><code><b class="d"><a name="d_char">.char</a></b></code> &lt;expression&gt;[, &lt;expression&gt;, &hellip;]
<dd>Create bytes from 8&nbsp;bit signed constants (&minus;128&ndash;127)
<pre width=80>
        <b class="d">.byte</b> <span>255</span>	<i>; $ff</i>
        <b class="d">.byte</b> <span class="s">"a"</span>	<i>; single character</i>
        <b class="d">.byte</b> <span>?</span>	        <i>; reserve 1 byte of space</i>
        <b class="d">.char</b> <span>-3</span>	<i>; $fd</i>
<i>;Store 4.4 signed fixed point constants</i>
        <b class="d">.byte</b> (<span>-3.5</span>, <span>3.25</span>, <span>3.125</span>) * <span>1p4</span>

<i>;Compact computed jumps using self modifying code</i>
        <b>lda</b> <u>jumps</u>,x
        <b>sta</b> <u>smod</u>+<span>1</span>
smod    <b>bne</b> <u>*</u>
jumps   <b class="d">.char</b> (<u>routine1</u>, <u>routine2</u>)-<u>smod</u>-<span>2</span> <i>;Routines nearby (&minus;128&ndash;127 bytes)</i>
</pre>

<dt><code><b class="d"><a name="d_word">.word</a></b></code> &lt;expression&gt;[, &lt;expression&gt;, &hellip;]
<dd>Create bytes from 16&nbsp;bit unsigned constants (0&ndash;65535)
<dt><code><b class="d"><a name="d_int">.int</a></b></code> &lt;expression&gt;[, &lt;expression&gt;, &hellip;]
<dd>Create bytes from 16&nbsp;bit signed constants (&minus;32768&ndash;32767)
<pre width=80>
        <b class="d">.word</b> <span>$2342</span>, <span>$4555</span><i>; $42 $23 $55 $45</i>
        <b class="d">.word</b> <span>?</span>	        <i>; reserve 2 bytes of space</i>
        <b class="d">.int</b> <span>-533</span>, <span>4433</span> <i>; $eb $fd $51 $11</i>
<i>;Store 8.8 signed fixed point constants</i>
        <b class="d">.int</b> (<span>-3.5</span>, <span>3.25</span>, <span>3.125</span>) * <span>1p8</span>

<i>;Computed jumps with jump table (bank zero or non-65816)</i>
        <b>lda</b> <u>jumps</u>,x
        <b>sta</b> <u>ind</u>
        <b>lda</b> <u>jumps</u>+<span>1</span>,x
        <b>sta</b> <u>ind</u>+<span>1</span>
        <b>jmp</b> (<u>ind</u>)
jumps   <b class="d">.word</b> <u>routine1</u>, <u>routine2</u><i>; but better use .addr instead</i>
</pre>

<dt><code><b class="d"><a name="d_addr">.addr</a></b></code> &lt;expression&gt;[, &lt;expression&gt;, &hellip;]
<dd>Create 16&nbsp;bit address constants for addresses (in current program bank)
<dt><code><b class="d"><a name="d_rta">.rta</a></b></code> &lt;expression&gt;[, &lt;expression&gt;, &hellip;]
<dd>Create 16&nbsp;bit return address constants for addresses (in current program bank)
<pre width=80>
<i>;Computed jumps with jump table (65816, current bank)</i>
        <b>*=</b> <span>$12000</span>
        <b>jmp</b> (<u>jumps</u>,x)
jumps   <b class="d">.addr</b> <span>$12050</span>, <u>routine1</u>, <u>routine2</u>

<i>;Computed jumps by using stack (current bank)</i>
        <b>*=</b> <span>$103000</span>
        <b>lda</b> <u>rets</u>+<span>1</span>,x
	<b>pha</b>
        <b>lda</b> <u>rets</u>,x
	<b>pha</b>
	<b>rts</b>
rets	<b class="d">.rta</b> <span>$10f000</span>, <u>routine1</u>, <u>routine2</u>
</pre>

<dt><code><b class="d"><a name="d_long">.long</a></b></code> &lt;expression&gt;[, &lt;expression&gt;, &hellip;]
<dd>Create bytes from 24&nbsp;bit unsigned constants (0&ndash;16777215)
<dt><code><b class="d"><a name="d_lint">.lint</a></b></code> &lt;expression&gt;[, &lt;expression&gt;, &hellip;]
<dd>Create bytes from 24&nbsp;bit signed constants (&minus;8388608&ndash;8388607)
<pre width=80>
        <b class="d">.long</b> <span>$123456</span>   <i>; $56 $34 $12</i>
        <b class="d">.long</b> <span>?</span>	        <i>; reserve 3 bytes of space</i>
        <b class="d">.lint</b> <span>-533</span>, <span>4433</span><i>; $eb $fd $ff $51 $11 $00</i>
<i>;Store 8.16 signed fixed point constants</i>
        <b class="d">.lint</b> (<span>-3.44</span>, <span>3.4</span>, <span>3.52</span>) * <span>1p16</span>

<i>;Computed long jumps with jump table (65816)</i>
        <b>lda</b> <u>jumps</u>,x
        <b>sta</b> <u>ind</u>
        <b>lda</b> <u>jumps</u>+<span>1</span>,x
        <b>sta</b> <u>ind</u>+<span>1</span>
        <b>lda</b> <u>jumps</u>+<span>2</span>,x
        <b>sta</b> <u>ind</u>+<span>2</span>
        <b>jmp</b> [<u>ind</u>]
jumps   <b class="d">.long</b> <u>routine1</u>, <u>routine2</u>
</pre>

<dt><code><b class="d"><a name="d_dword">.dword</a></b></code> &lt;expression&gt;[, &lt;expression&gt;, &hellip;]
<dd>Create bytes from 32&nbsp;bit constants (0&ndash;4294967295)
<dt><code><b class="d"><a name="d_dint">.dint</a></b></code> &lt;expression&gt;[, &lt;expression&gt;, &hellip;]
<dd>Create bytes from 32&nbsp;bit signed constants (&minus;2147483648&ndash;2147483647)
<pre width=80>
        <b class="d">.dword</b> <span>$12345678</span><i>; $78 $56 $34 $12</i>
        <b class="d">.dword</b> <span>?</span>        <i>; reserve 4 bytes of space</i>
        <b class="d">.dint</b> <span>-411469219</span><i>; $5d $7a $79 $e7</i>
<i>;Store 16.16 signed fixed point constants</i>
        <b class="d">.dint</b> (<span>-3.44</span>, <span>3.4</span>, <span>3.52</span>) * <span>1p16</span>
</pre>
</dl>

<h4>Storing text data<a name="data-text" href="#data-text"></a></h4>
<p>Texts are stored as a string of bytes. Small numeric constants can be mixed
in to represent control characters.</p>
<dl class="dir">
<dt><code><b class="d"><a name="d_text">.text</a></b></code> &lt;expression&gt;[, &lt;expression&gt;, &hellip;]
<dd>Assemble strings and 8&nbsp;bit constants into bytes.
<pre width=80>
        <b class="d">.text</b> <span class="s">"oeU"</span>	<i>; text, "" means $22</i>
        <b class="d">.text</b> <span class="s">'oeU'</span>	<i>; text, '' means $27</i>
        <b class="d">.text</b> <span>23</span>, <span>$33</span>	<i>; bytes</i>
        <b class="d">.text</b> <span>%00011111</span>	<i>; more bytes</i>
        <b class="d">.text</b> ^<u>OEU</u>	<i>; the decimal value as string (^23 is $32,$33)</i>
</pre>

<dt><code><b class="d"><a name="d_fill">.fill</a></b></code> &lt;length&gt;[, &lt;fill&gt;]
<dd>Skip bytes (using uninitialized data), or fill with repeated bytes. For complex multi byte patterns use <code>.rept</code>!
<pre width=80>
        <b class="d">.fill</b> <span>$100</span>      <i>;no fill, just reserve $100 bytes</i>
        <b class="d">.fill</b> <span>$4000</span>, <span>0</span>  <i>;16384 bytes of 0</i>
        <b class="d">.fill</b> <span>8000</span>, [<span>$55</span>, <span>$aa</span>]<i>;8000 bytes of alternating $55, $aa</i>
</pre>

<dt><code><b class="d"><a name="d_shift">.shift</a></b></code> &lt;expression&gt;[, &lt;expression&gt;, &hellip;]
<dd>Same as <code>.text</code>, but the last byte will have the highest bit set.
Any character which already has the most significant bit set will cause an error.
<pre width=80>
        <b>ldx</b> #<span>0</span>
loop	<b>lda</b> <u>txt</u>,x
	<b>php</b>
        <b>and</b> #<span>$7f</span>
        <b>jsr</b> <span>$ffd2</span>
	<b>inx</b>
	<b>plp</b>
        <b>bpl</b> <u>loop</u>
	<b>rts</b>
txt	<b class="d">.shift</b> <span class="s">"some text"</span>
</pre>

<dt><code><b class="d"><a name="d_shiftl">.shiftl</a></b></code> &lt;expression&gt;[, &lt;expression&gt;, &hellip;]
<dd>Same as <code>.text</code>, but all bytes are shifted to left, and the last
character gets the lowest bit set. Any character which already has the most significant
bit set will cause an error as this would be cut off.
<pre width=80>
        <b>ldx</b> #<span>0</span>
loop	<b>lda</b> <u>txt</u>,x
	<b>lsr</b>
        <b>sta</b> <span>$400</span>,x      <i>;screen memory</i>
	<b>inx</b>
        <b>bcc</b> <u>loop</u>
	<b>rts</b>
	<b class="k">.enc</b> screen
txt	<b class="d">.shiftl</b> <span class="s">"some text"</span>
	<b class="k">.enc</b> none
</pre>

<dt><code><b class="d"><a name="d_null">.null</a></b></code> &lt;expression&gt;[, &lt;expression&gt;, &hellip;]
<dd>Same as <code>.text</code>, but adds a null at the end, null in string is an error.
<pre width=80>
        <b>lda</b> #&lt;<u>txt</u>
        <b>ldy</b> #&gt;<u>txt</u>
        <b>jsr</b> <span>$ab1e</span>
txt	<b class="d">.null</b> <span class="s">"some text"</span>
</pre>

<dt><code><b class="d"><a name="d_ptext">.ptext</a></b></code> &lt;expression&gt;[, &lt;expression&gt;, &hellip;]
<dd>Same as <code>.text</code>, but prepend the number of bytes in front of the
string (pascal style string). Therefore it can't do more than 255 bytes.
<pre width=80>
        <b>lda</b> #&lt;<u>txt</u>
        <b>ldx</b> #&gt;<u>txt</u>
        <b>jsr</b> <u>print</u>
	<b>rts</b>

print	<b>sta</b> <span>$fb</span>
        <b>stx</b> <span>$fc</span>
        <b>ldy</b> #<span>0</span>
        <b>lda</b> (<span>$fb</span>),y
        <b>beq</b> <u>null</u>
	<b>tax</b>
-	<b>iny</b>
        <b>lda</b> (<span>$fb</span>),y
        <b>jsr</b> <span>$ffd2</span>
	<b>dex</b>
	<b>bne</b> <u>-</u>
null	<b>rts</b>
txt	<b class="d">.ptext</b> <span class="s">"note"</span>
</pre>
</dl>

<h3>Text encoding<a name="text-encoding" href="#text-encoding"></a></h3>
<p>64tass supports sources written in UTF-8, UTF-16 (be/le) and RAW 8&nbsp;bit encoding. To take
advantage of this capability custom encodings can be defined to map Unicode characters
to 8&nbsp;bit values in strings.</p>
<dl class="dir">
<dt><code><b class="k"><a name="d_enc">.enc</a></b></code> &lt;name&gt;
<dd>Selects text encoding, predefined encodings are <q>none</q> and
<q>screen</q> (screen code), anything else is user defined. All user encodings
start without any character or escape definitions, add some as required.
<pre width=80>
	<b class="k">.enc</b> screen	<i>;screen code mode</i>
        <b class="d">.text</b> <span class="s">"text with screen codes"</span>
        <b>cmp</b> #<span class="s">"u"</span>	<i>;compare screen code</i>
	<b class="k">.enc</b> none	<i>;normal mode again</i>
        <b>cmp</b> #<span class="s">"u"</span>	<i>;compare ASCII</i>
</pre>
<dt><code><b class="k"><a name="d_cdef">.cdef</a></b></code> &lt;start&gt;, &lt;end&gt;, &lt;coded&gt; [, &lt;start&gt;, &lt;end&gt;, &lt;coded&gt;, &hellip;]
<dt><code><b class="k">.cdef</b></code> "&lt;start&gt;&lt;end&gt;", &lt;coded&gt; [, "&lt;start&gt;&lt;end&gt;", &lt;coded&gt;, &hellip;]
<dd>Assigns characters in a range to single bytes.
<p>This is a simple single character to byte translation definition. It is
applied to a range as characters and bytes are usually assigned sequentially.
The start and end positions are Unicode character codes either by numbers or by
typing them. Overlapping ranges are not allowed.</p>
<dt><code><b class="k"><a name="d_edef">.edef</a></b></code> "&lt;escapetext&gt;", &lt;value&gt; [, "&lt;escapetext&gt;", &lt;value&gt;, &hellip;]
<dd>Assigns strings to byte sequences as a translated value.
<p>When these substrings are found in a text they are replaced by bytes defined here.
When strings with common prefixes are used the longest match wins. Useful for defining
non-typeable control code aliases, or as a simple tokenizer.</p>
</dl>
<pre width=80>
        <b class="k">.enc</b> petscii	<i>;define an ascii->petscii encoding</i>
        <b class="k">.cdef</b> <span class="s">" @"</span>, <span>32</span>  <i>;characters</i>
        <b class="k">.cdef</b> <span class="s">"AZ"</span>, <span>$c1</span>
        <b class="k">.cdef</b> <span class="s">"az"</span>, <span>$41</span>
        <b class="k">.cdef</b> <span class="s">"[["</span>, <span>$5b</span>
        <b class="k">.cdef</b> <span class="s">"&pound;&pound;"</span>, <span>$5c</span>
        <b class="k">.cdef</b> <span class="s">"]]"</span>, <span>$5d</span>
        <b class="k">.cdef</b> <span class="s">"&pi;&pi;"</span>, <span>$5e</span>
        <b class="k">.cdef</b> <span>$2190</span>, <span>$2190</span>, <span>$1f</span><i>;left arrow</i>

        <b class="k">.edef</b> <span class="s">"\n"</span>, <span>13</span>  <i>;one byte control codes</i>
        <b class="k">.edef</b> <span class="s">"{clr}"</span>, <span>147</span>
        <b class="k">.edef</b> <span class="s">"{crlf}"</span>, [<span>13</span>, <span>10</span>]<i>;two byte control code</i>
        <b class="k">.edef</b> <span class="s">"&lt;nothing&gt;"</span>, []<i>;replace with no bytes</i>

        <b class="d">.text</b> <span class="s">"<span>{clr}</span>Text in PETSCII<span>\n</span>"</span>
</pre>

<h3>Structured data<a name="structures" href="#structures"></a></h3>

<p>Structures and unions can be defined to create complex data types. The
offset of fields are available by using the definition's name. The fields
themselves by using the instance name.</p>

<p>The initialization method is very similar to macro parameters, the
difference is that unset parameters always return uninitialized data (<q>?</q>)
instead of an error.</p>

<h4>Structure<a name="structure" href="#structure"></a></h4>
<p>Structures are for organizing sequential data, so the length of a structure
is the sum of lengths of all items.</p>

<dl class="dir">
<dt><code><b class="k"><a name="d_struct">.struct</a></b></code> [&lt;name&gt;][=&lt;default&gt;]][, [&lt;name&gt;][=&lt;default&gt;] &hellip;]
<dt><code><b class="k"><a name="d_ends">.ends</a></b></code> [&lt;result&gt;][, &lt;result&gt; &hellip;]
<dd>Structure definition, with named parameters and default values
<dt><code><b class="d"><a name="d_dstruct">.dstruct</a></b></code> &lt;name&gt;[, &lt;initialization values&gt;]
<dt><code><b class="d">.&lt;name&gt;</b></code> [&lt;initialization values&gt;]
<dd>Create instance of structure with initialization values
</dl>

<pre width=80>
        <b class="k">.struct</b>         <i>;anonymous structure</i>
x       <b class="d">.byte</b> <span>0</span>         <i>;labels are visible</i>
y       <b class="d">.byte</b> <span>0</span>         <i>;content compiled here</i>
        <b class="k">.ends</b>           <i>;useful inside unions</i>

nn_s    <b class="k">.struct</b> <u>col</u>, <u>row</u><i>;named structure</i>
x       <b class="d">.byte</b> <span class="k">\col</span>      <i>;labels are not visible</i>
y       <b class="d">.byte</b> <span class="k">\row</span>      <i>;no content is compiled here</i>
        <b class="k">.ends</b>           <i>;it's just a definition</i>

nn      <b class="d">.dstruct</b> <u>nn_s</u>, <span>1</span>, <span>2</span><i>;structure instance, content here</i>

        <b>lda</b> <u>nn</u>.<u>x</u>        <i>;direct field access</i>
        <b>ldy</b> #<u>nn_s</u>.<u>x</u>     <i>;get offset of field</i>
        <b>lda</b> <u>nn</u>,y        <i>;and use it indirectly</i>
</pre>

<h4>Union<a name="union" href="#union"></a></h4>
<p>Unions can be used for overlapping data as the compile offset and program
counter remains the same on each line. Therefore the length of a union is the
length of it's longest item.</p>

<dl class="dir">
<dt><code><b class="k"><a name="d_union">.union</a></b></code> [&lt;name&gt;][=&lt;default&gt;]][, [&lt;name&gt;][=&lt;default&gt;] &hellip;]
<dt><code><b class="k"><a name="d_endu">.endu</a></b></code>
<dd>Union definition, with named parameters and default values
<dt><code><b class="d"><a name="d_dunion">.dunion</a></b></code> &lt;name&gt;[, &lt;initialization values&gt;]
<dt><code><b class="d">.&lt;name&gt;</b></code> [&lt;initialization values&gt;]
<dd>Create instance of union with initialization values
</dl>

<pre width=80>
        <b class="k">.union</b>          <i>;anonymous union</i>
x       <b class="d">.byte</b> <span>0</span>         <i>;labels are visible</i>
y       <b class="d">.word</b> <span>0</span>         <i>;content compiled here</i>
	<b class="k">.endu</b>

nn_u    <b class="k">.union</b>          <i>;named union</i>
x       <b class="d">.byte</b> <span>?</span>         <i>;labels are not visible</i>
y       <b class="d">.word</b> <span class="k">\1</span>        <i>;no content is compiled here</i>
        <b class="k">.endu</b>           <i>;it's just a definition</i>

nn      <b class="d">.dunion</b> <u>nn_u</u>, <span>1</span> <i>;union instance here</i>

        <b>lda</b> <u>nn</u>.<u>x</u>        <i>;direct field access</i>
        <b>ldy</b> #<u>nn_u</u>.<u>x</u>     <i>;get offset of field</i>
        <b>lda</b> <u>nn</u>,y        <i>;and use it indirectly</i>
</pre>

<h4>Combined use of structures and unions<a name="struct-and-union" href="#struct-and-union"></a></h4>
<p>The example below shows how to define structure to a binary include.</p>

<pre width=80>
        <b class="k">.union</b>
        <b class="d">.binary</b> <span class="s">"pic.drp"</span>, <span>2</span>
        <b class="k">.struct</b>
color	<b class="d">.fill</b> <span>1024</span>
screen	<b class="d">.fill</b> <span>1024</span>
bitmap	<b class="d">.fill</b> <span>8000</span>
backg	<b class="d">.byte</b> <span>?</span>
        <b class="k">.ends</b>
	<b class="k">.endu</b>
</pre>

<p>Anonymous structures and unions in combination with sections are useful for
overlapping memory assignment. The example below shares zeropage allocations
for two separate parts of a bigger program. The common subroutine variables
are assigned after in the <q>zp</q> section.</p>

<pre width=80>
        <b>*=</b> <span>$02</span>
        <b class="k">.union</b>          <i>;spare some memory</i>
         <b class="k">.struct</b>
          <b class="d">.dsection</b> <u>zp1</u> <i>;declare zp1 section</i>
         <b class="k">.ends</b>
         <b class="k">.struct</b>
          <b class="d">.dsection</b> <u>zp2</u> <i>;declare zp2 section</i>
         <b class="k">.ends</b>
        <b class="k">.endu</b>
        <b class="d">.dsection</b> <u>zp</u>    <i>;declare zp section</i>
</pre>

<h3>Macros<a name="macros" href="#macros"></a></h3>
<p>Macros can be used to reduce typing of frequently used source lines.
Each invocation is a copy of the macro's content with parameter references
replaced by the parameter texts.</p>

<dl class="dir">
<dt><code><b class="k"><a name="d_segment">.segment</a></b></code> [&lt;name&gt;][=&lt;default&gt;]][, [&lt;name&gt;][=&lt;default&gt;] &hellip;]
<dt><code><b class="k"><a name="d_endm">.endm</a></b></code> [&lt;result&gt;][, &lt;result&gt; &hellip;]
<dd>Copies the code segment as it is, so symbols can be used from
outside, but this also means multiple use will result in double defines
unless anonymous labels are used.
<dt><code><b class="k"><a name="d_macro">.macro</a></b></code> [&lt;name&gt;][=&lt;default&gt;]][, [&lt;name&gt;][=&lt;default&gt;] &hellip;]
<dt><code><b class="k">.endm</b></code> [&lt;result&gt;][, &lt;result&gt; &hellip;]
<dd>The code is enclosed in it's own block so symbols inside are
non-accessible, unless a label is prefixed at the place of use, then local
labels can be accessed through that label.
<dt><code><b class="k">#&lt;name&gt;</b></code> [&lt;param&gt;][[,][&lt;param&gt;] &hellip;]
<dt><code><b class="k">.&lt;name&gt;</b></code> [&lt;param&gt;][[,][&lt;param&gt;] &hellip;]
<dd>Invoke the macro after <q>#</q> or <q>.</q> with the parameters. Normally the name of
the macro is used, but it can be any expression.
</dl>

<pre width=80>
<i>;A simple macro</i>
copy    <b class="k">.macro</b>
        <b>ldx</b> #<span class="k">size</span>(<span class="k">\1</span>)
lp      <b>lda</b> <span class="k">\1</span>,x
        <b>sta</b> <span class="k">\2</span>,x
	<b>dex</b>
        <b>bpl</b> <u>lp</u>
	<b class="k">.endm</b>

        <b class="k">#copy</b> <u>label</u>, <span>$500</span>

<i>;Use macro as an assembler directive</i>
lohi    <b class="k">.macro</b>
lo	<b class="d">.byte</b> &lt;(<span class="k">\@</span>)
hi	<b class="d">.byte</b> &gt;(<span class="k">\@</span>)
        <b class="k">.endm</b>

var     <b class="k">.lohi</b> <span>1234</span>, <span>5678</span>

        <b>lda</b> <u>var</u>.<u>lo</u>,y
        <b>ldx</b> <u>var</u>.<u>hi</u>,y
</pre>

<h4>Parameter references<a name="macro-parameters" href="#macro-parameters"></a></h4>
<p>The first 9 parameters can be referenced by <q><code>\1</code></q>&ndash;<q><code>\9</code></q>.
The entire parameter list including separators is <q><code>\@</code></q>.</p>
<pre width=80>
name	<b class="k">.macro</b>
        <b>lda</b> #<span class="k">\1</span> 	<i>;first parameter 23+1</i>
	<b class="k">.endm</b>

        <b class="k">#name</b> <span>23</span>+<span>1</span>	<i>;call macro</i>
</pre>

<p>Parameters can be named, and it's possible to set a default value after an
equal sign which is used as a replacement when the parameter is missing.</p>

<p>These named parameters can be referenced by <code>\name</code> or
<code>\{name}</code>. Names must match completely, if unsure use the quoted
name reference syntax.</p>
<pre width=80>
name	<b class="k">.macro</b> first, b=<span>2</span>, , last
        <b>lda</b> #<span class="k">\first</span>	<i>;first parameter</i>
        <b>lda</b> #<span class="k">\b</span> 	<i>;second parameter</i>
        <b>lda</b> #<span class="k">\3</span> 	<i>;third parameter</i>
        <b>lda</b> #<span class="k">\last</span> 	<i>;fourth parameter</i>
	<b class="k">.endm</b>

        <b class="k">#name</b> <span>1</span>, , <span>3</span>, <span>4</span>	<i>;call macro</i>
</pre>

<h4>Text references<a name="macro-textreference" href="#macro-textreference"></a></h4>
<p>In the original turbo assembler normal references are passed by value and
can only appear in place of one. Text references on the other hand can appear
everywhere and will work in place of e.g. quoted text or opcodes and labels. The
first 9 parameters can be referenced as text by
<code>@1</code>&ndash;<code>@9</code>.</p>
<pre width=80>
name    <b class="k">.macro</b>
        <b>jsr</b> <u>print</u>
        <b class="d">.null</b> <span class="s">"Hello <span>@1</span>!"</span><i>;first parameter</i>
	<b class="k">.endm</b>

        <b class="k">#name</b> <span class="s">"wth?"</span>	<i>;call macro</i>
</pre>

<h3>Custom functions<a name="user-functions" href="#user-functions"></a></h3>
<p>Beyond the built-in functions mentioned earlier it's possible to define
custom ones for frequently used calculations.</p>

<dl class="dir">
<dt><code><b class="k"><a name="d_function">.function</a></b></code> &lt;name&gt;[=&lt;default&gt;]][, &lt;name&gt;[=&lt;default&gt;] &hellip;][, &lowast;&lt;name&gt;]
<dt><code><b class="k"><a name="d_endf">.endf</a></b></code> [&lt;result&gt;][, &lt;result&gt; &hellip;]
<dd>Defines a user function
<dt><code><b class="k">#&lt;name&gt;</b></code> [&lt;param&gt;][[,][&lt;param&gt;] &hellip;]
<dt><code><b class="k">.&lt;name&gt;</b></code> [&lt;param&gt;][[,][&lt;param&gt;] &hellip;]
<dt><code><b class="k">&lt;name&gt;</b></code> [&lt;param&gt;][[,][&lt;param&gt;] &hellip;]
<dd>Invoke a function like a macro, directive or pseudo instruction.
</dl>

<p>Parameters are assigned to constant symbols in the function scope on
invocation. The default values are calculated at function definition time only,
and these values are used at invocation time when a parameter is missing.</p>
<p>Extra parameters are not accepted, unless the last parameter symbol is
preceded with a star, in this case these parameters are collected into a tuple.
Multiple values are returned are also returned as tuple.</p>
<p>Functions can span multiple lines but unlike macros they can't create new
code. Only those external variables and functions are available which were
accessible at the place of definition, but not those at the place of
invocation.</p>
<pre width=80>
wpack   <b class="k">.function</b> <u>a</u>, <u>b</u>=<span>0</span>
        <b class="k">.endf</b> <u>a</u>+<u>b</u>*<span>256</span>

        <b class="d">.word</b> <span class="k">wpack</span>(<span>1</span>), <span class="k">wpack</span>(<span>2</span>, <span>3</span>)
</pre>

<p>If a function is used as macro, directive or pseudo instruction and there's
a label in front then the returned value is assigned to it. If nothing is
returned then it's used as regular label. Of course when used like this it can
create code and access local variables.</p>

<pre width=80>
mva     <b class="k">.function</b> <u>s</u>, <u>d</u>
        <b>lda</b> <u>s</u>
        <b>sta</b> <u>d</u>
        <b class="k">.endf</b>

        <b class="k">mva</b> #<span>1</span>, <u>label</u>
</pre>

<h3>Conditional assembly<a name="conditional-assembly" href="#conditional-assembly"></a></h3>
<p>To prevent parts of source from compiling conditional constructs can be
used. This is useful when multiple slightly different versions needs to be
compiled from the same source.</p>
<h4>If, else if, else<a name="conditional-if" href="#conditional-if"></a></h4>
<dl class="dir">
<dt><code><b class="k"><a name="d_if">.if</a></b></code> &lt;expression&gt;
<dd>Compile, if result is true (not zero)
<dt><code><b class="k"><a name="d_elsif">.elsif</a></b></code> &lt;expression&gt;
<dd>Compile if the previous conditions were all skipped and the result is true (not zero)
<dt><code><b class="k"><a name="d_else">.else</a></b></code>
<dd>Compile if the previous conditions were all skipped
<dt><code><b class="k"><a name="d_fi">.fi</a></b></code>
<dt><code><b class="k"><a name="d_endif">.endif</a></b></code>
<dd>End of conditional compile
<dt><code><b class="k"><a name="d_ifne">.ifne</a></b></code> &lt;value&gt;
<dd>Compile, if value is not zero (or true)
<dt><code><b class="k"><a name="d_ifeq">.ifeq</a></b></code> &lt;value&gt;
<dd>Compile, if value is zero (or false)
<dt><code><b class="k"><a name="d_ifpl">.ifpl</a></b></code> &lt;value&gt;
<dd>Compile, if value is greater or equal zero
<dt><code><b class="k"><a name="d_ifmi">.ifmi</a></b></code> &lt;value&gt;
<dd>Compile, if value is less than zero
</dl>

<p>The <code>.ifne</code>, <code>.ifeq</code>, <code>.ifpl</code> and
<code>.ifmi</code> directives exists for compatibility only, in practice it's
better to use comparison operators instead.</p>

<pre width=80>
        <b class="k">.if</b> <u>wait</u>==<span>2</span>	<i>;2 cycles</i>
	<b>nop</b>
        <b class="k">.elsif</b> <u>wait</u>==<span>3</span>	<i>;3 cycles</i>
        <b>bit</b> <span>$ea</span>
        <b class="k">.elsif</b> <u>wait</u>==<span>4</span>	<i>;4 cycles</i>
        <b>bit</b> <span>$eaea</span>
        <b class="k">.else</b>		<i>;else 5 cycles</i>
        <b>inc</b> <span>$2</span>
	<b class="k">.fi</b>
</pre>

<h4>Switch, case, default<a name="conditional-switch" href="#conditional-switch"></a></h4>
<p>Similar to the <code>.if</code>/<code>.elsif</code>/<code>.else</code>
construct, but the compared value needs to be written only once in the switch
statement.</p>

<dl class="dir">
<dt><code><b class="k"><a name="d_switch">.switch</a></b></code> &lt;expression&gt;
<dd>Evaluate expression and remember it
<dt><code><b class="k"><a name="d_case">.case</a></b></code> &lt;expression&gt;[, &lt;expression&gt; &hellip;]
<dd>Compile if the previous conditions were all skipped and one of the values equals
<dt><code><b class="k"><a name="d_default">.default</a></b></code>
<dd>Compile if the previous conditions were all skipped
<dt><code><b class="k"><a name="d_endswitch">.endswitch</a></b></code>
<dd>End of conditional compile
</dl>

<pre width=80>
        <b class="k">.switch</b> <u>wait</u>
        <b class="k">.case</b> <span>2</span>	        <i>;2 cycles</i>
	<b>nop</b>
        <b class="k">.case</b> <span>3</span>	        <i>;3 cycles</i>
        <b>bit</b> <span>$ea</span>
        <b class="k">.case</b> <span>4</span>	        <i>;4 cycles</i>
        <b>bit</b> <span>$eaea</span>
        <b class="k">.default</b>	<i>;else 5 cycles</i>
        <b>inc</b> <span>$2</span>
	<b class="k">.endswitch</b>
</pre>

<h3>Repetitions<a name="repetitions" href="#repetitions"></a></h3>
<dl class="dir">
<dt><code><b class="k"><a name="d_for">.for</a></b></code> &lt;variable&gt;=&lt;expression&gt;, &lt;expression&gt;, &lt;variable&gt;=&lt;expression&gt;
<dt><code><b class="k"><a name="d_next">.next</a></b></code>
<dd>Compile loop, only anonymous references are allowed as labels inside
<pre width=80>
        <b>ldx</b> #<span>0</span>
        <b>lda</b> #<span>32</span>
lp      <b class="k">.for</b> <u>ue</u> = <span>0</span>, <u>ue</u> &lt; <span>$400</span>, <u>ue</u> = <u>ue</u> + <span>$100</span>
        <b>sta</b> <u>ue</u>,x
	<b class="k">.next</b>
        <b>dex</b>
        <b>bne</b> <u>lp</u>
</pre>

<dt><code><b class="k"><a name="d_rept">.rept</a></b></code> &lt;expression&gt;
<dt><code><b class="k">.next</b></code>
<dd>Repeated compile, only anonymous references are allowed as labels inside
<pre width=80>
        <b class="k">.rept</b> <span>100</span>
	<b>nop</b>
	<b class="k">.next</b>
</pre>

<dt><code><b class="k"><a name="d_break">.break</a></b></code>
<dd>Exit current loop immediately

<dt><code><b class="k"><a name="d_continue">.continue</a></b></code>
<dd>Continue current loop's next iteration

<dt><code><b class="k"><a name="d_lbl">.lbl</a></b></code>
<dd>Creates a special jump label that can be referenced by <code>.goto</code>
<dt><code><b class="k"><a name="d_goto">.goto</a></b></code> &lt;labelname&gt;
<dd>Causes assembler to continue assembling from the jump label. No
forward references of course, handle with care. Typically used in
classic TASM sources for creating loops.

<pre width=80>
i	<b class="k">.var</b> <span>100</span>
loop	<b class="k">.lbl</b>
        <b>nop</b>
i       <b class="k">.var</b> <u>i</u> - <span>1</span>
        <b class="k">.ifne</b> <u>i</u>
        <b class="k">.goto</b> <u>loop</u>       <i>;generates 100 nops</i>
        <b class="k">.fi</b>
</pre>

</dl>
<h3>Including files<a name="including" href="#including"></a></h3>

<p>Longer sources are usually separated into multiple files for easier
handling. Precomputed binary data can also be included directly without
converting it into source code first.</p>

<p>Search path is relative to the location of current source file. If it's not
found there the include search path is consulted for further possible
locations.</p>

<p>To make your sources portable please always use forward slashes
(<code>/</code>) as a directory separator and use lower/uppercase consistently
in filenames!</p>

<dl class="dir">
<dt><code><b class="k"><a name="d_include">.include</a></b></code> &lt;filename&gt;
<dd>Include source file here.
<dt><code><b class="k"><a name="d_binclude">.binclude</a></b></code> &lt;filename&gt;
<dd>Include source file here in it's local block. If the directive is prefixed
with a label then all labels are local and are accessible through that label
only, otherwise not reachable at all.
<pre width=80>

	<b class="k">.include</b> <span class="s">"macros.asm"</span>       <i>;include macros</i>
menu    <b class="k">.binclude</b> <span class="s">"menu.asm"</span>        <i>;include in a block</i>
	<b>jmp</b> <u>menu</u>.<u>start</u>
</pre>

<dt><code><b class="d"><a name="d_binary">.binary</a></b></code> &lt;filename&gt;[, &lt;offset&gt;[, &lt;length&gt;]]
<dd>Include raw binary data from file. By using offset and length it's possible to break out chunks of data from a
file separately, like bitmap and colors for example.
<pre width=80>
        <b class="d">.binary</b> <span class="s">"stuffz.bin"</span>        <i>;simple include, all bytes</i>
        <b class="d">.binary</b> <span class="s">"stuffz.bin"</span>, <span>2</span>     <i>;skip start address</i>
        <b class="d">.binary</b> <span class="s">"stuffz.bin"</span>, <span>2</span>, <span>1000</span><i>;skip start address, 1000 bytes max</i>

        <b>*=</b> <span>$1000</span>	            <i>;load music to $1000 and</i>
        <b class="d">.binary</b> <span class="s">"music.sid"</span>, <span>$7e</span>    <i>;strip SID header</i>
</pre>

</dl>
<h3>Scopes<a name="scopes" href="#scopes"></a></h3>
<p>Scopes may contain symbols or other scopes nested. They are useful to avoid
symbol clashes as the same symbol name can repeated as long as it's in a
different scope.</p>
<p>In nested scopes the symbol lookup starts from the local scope and goes in
the direction of the global scope. This means that local variables will
<q>shadow</q> global one with the same name.</p>
<dl class="dir">
<dt><code><b class="k"><a name="d_proc">.proc</a></b></code>
<dt><code><b class="k"><a name="d_pend">.pend</a></b></code>
<dd>Procedure start and end of procedure.
<p>If it's label is not used then the code won't be compiled at all. This is
very useful to avoid a lot of <code>.if</code> blocks to exclude unused
sections of code.</p>
<p>All labels inside are local enclosed in a scope and are accessible through
the prefixed label. Useful for building libraries.</p>
<pre width=80>
ize     <b class="k">.proc</b>
	<b>nop</b>
cucc    <b>nop</b>
	<b class="k">.pend</b>

        <b>jsr</b> <u>ize</u>
        <b>jmp</b> <u>ize</u>.<u>cucc</u>
</pre>

<dt><code><b class="k"><a name="d_block">.block</a></b></code>
<dt><code><b class="k"><a name="d_bend">.bend</a></b></code>
<dd>Block start and block end.
<p>All labels inside a block are local enclosed in a scope. If prefixed with a
label local variables are accessible through that label using the dot notation,
otherwise not at all.</p>
<pre width=80>
	<b class="k">.block</b>
        <b>inc</b> <u>count</u> + <span>1</span>
count	<b>ldx</b> #<span>0</span>
	<b class="k">.bend</b>
</pre>

<dt><code><b class="k"><a name="d_weak">.weak</a></b></code>
<dt><code><b class="k"><a name="d_endweak">.endweak</a></b></code>
<dd>Weak symbol area
<p>Any symbols defined inside can be overriden by <q>stronger</q> symbols in
the same scope from outside. Can be nested as necessary.</p>
<p>This gives the possibility of giving default values for symbols which might
not always exist without resorting to <code>.ifdef</code>/<code>.ifndef</code> or
similar directives in other assemblers.</p>
<pre width=80>
symbol	<b>=</b> <span>1</span>            <i>;stronger symbol than the one below</i>
	<b class="k">.weak</b>
symbol	<b>=</b> <span>0</span>            <i>;default value if the one above does not exists</i>
	<b class="k">.endweak</b>
        <b class="k">.if</b> <u>symbol</u>     <i>;almost like an .ifdef ;)</i>
</pre>

<p>Other use of weak symbols might be in included libraries to change default values or
replace stub functions and data structures.</p>

<p>If these stubs are defined using
<code>.proc</code>/<code>.pend</code> then their default implementations will
not even exists in the output at all when a stronger symbol overrides them.</p>

<p>Multiple definition of a symbol with the same <q>strength</q> in the same
scope is of course not allowed and it results in double definition error.</p>

<p>Please note that <code>.ifdef</code>/<code>.ifndef</code> directives are
left out from 64tass for of technical reasons, so don't wait for them to appear
anytime soon.</p>
</dl>

<h3>Sections<a name="sections" href="#sections"></a></h3>

<p>Sections can be used to collect data or code into separate memory areas
without moving source code lines around. This is achieved by having separate
compile offset and program counters for each defined section.</p>

<dl class="dir">
<dt><code><b class="k"><a name="d_section">.section</a></b></code> &lt;name&gt;
<dt><code><b class="k"><a name="d_send">.send</a></b></code> [&lt;name&gt;]
<dd>Defines a section fragment. The name at <code>.send</code> must match but
it's optional.
<dt><code><b class="d"><a name="d_dsection">.dsection</a></b></code> &lt;name&gt;
<dd>Collect the section fragments here.
</dl>

<p>All <code>.section</code> fragments are compiled to the memory area
allocated by the <code>.dsection</code> directive. Compilation happens as the
code appears, this directive only assigns enough space to hold all the content
in the section fragments.</p>

<p>The space used by section fragments is calculated from the difference of
starting compile offset and the maximum compile offset reached. It is possible
to manipulate the compile offset in fragments, but putting code before the
start of <code>.dsection</code> is not allowed.</p>

<pre width=80>
        <b>*=</b> <span>$02</span>
        <b class="d">.dsection</b> <u>zp</u>   <i>;declare zeropage section</i>
        <b class="k">.cerror</b> <u>*</u> &gt; <span>$30</span>, <span class="s">"Too many zeropage variables"</span>

        <b>*=</b> <span>$334</span>
        <b class="d">.dsection</b> <u>bss</u>   <i>;declare uninitialized variable section</i>
        <b class="k">.cerror</b> <u>*</u> &gt; <span>$400</span>, <span class="s">"Too many variables"</span>

        <b>*=</b> <span>$0801</span>
        <b class="d">.dsection</b> <u>code</u>   <i>;declare code section</i>
        <b class="k">.cerror</b> <u>*</u> &gt; <span>$1000</span>, <span class="s">"Program too long!"</span>

        <b>*=</b> <span>$1000</span>
        <b class="d">.dsection</b> <u>data</u>   <i>;declare data section</i>
        <b class="k">.cerror</b> <u>*</u> &gt; <span>$2000</span>, <span class="s">"Data too long!"</span>
<i>;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;</i>
        <b class="k">.section</b> <u>code</u>
        <b class="d">.word</b> <u>ss</u>, <span>2005</span>
        <b class="d">.null</b> <span>$9e</span>, ^<u>start</u>
ss	<b class="d">.word</b> <span>0</span>

start   <b>sei</b>
        <b class="k">.section</b> <u>zp</u>     <i>;declare some new zeropage variables</i>
p2	<b class="d">.word</b> <span>?</span>         <i>;a pointer</i>
        <b class="k">.send</b> <u>zp</u>
        <b class="k">.section</b> <u>bss</u>    <i>;new variables</i>
buffer	<b class="d">.fill</b> <span>10</span>        <i>;temporary area</i>
        <b class="k">.send</b> <u>bss</u>

        <b>lda</b> (<u>p2</u>),y
        <b>lda</b> #&lt;<u>label</u>
        <b>ldy</b> #&gt;<u>label</u>
        <b>jsr</b> <u>print</u>

        <b class="k">.section</b> <u>data</u>   <i>;some data</i>
label   <b class="d">.null</b> <span class="s">"message"</span>
        <b class="k">.send</b> <u>data</u>

        <b>jmp</b> <u>error</u>
        <b class="k">.section</b> <u>zp</u>     <i>;declare some more zeropage variables</i>
p3	<b class="d">.word</b> <span>?</span>         <i>;a pointer</i>
        <b class="k">.send</b> <u>zp</u>
        <b class="k">.send</b> <u>code</u>
</pre>
<p>The compiled code will look like:</p>
<pre width=80>
&gt;0801	 0b 08 d5 07			        .word ss, 2005
&gt;0805	 9e 32 30 36 31 00		        .null $9e, ^start
&gt;080b	 00 00				ss      .word 0

.080d	 78				start   sei

&gt;0002					p2      .word ?         ;a pointer
&gt;0334					buffer  .fill 10        ;temporary area

.080e	 b1 02				        lda (p2),y
.0810	 a9 00				        lda #&lt;label
.0812	 a0 10				        ldy #&gt;label
.0814	 20 1e ab			        jsr print

&gt;1000	 6d 65 73 73 61 67 65 00	label   .null "message"

.0817	 4c e2 fc			        jmp error

&gt;0004					p2      .word ?         ;a pointer
</pre>

<p>Sections can form a hierarchy by nesting a <code>.dsection</code> into
another section. The section names must only be unique within a section but can
be reused otherwise. Parent section names are visible for children, siblings can be
reached through parents.</p>

<p>In the following example the included sources don't have to know which
<q>code</q> and <q>data</q> sections they use, while the <q>bss</q> section is
shared for all banks.</p>

<pre width=80>
<i>;First 8K bank at the beginning, PC at $8000</i>
        <b>*=</b> <span>$0000</span>
        <b class="k">.logical</b> <span>$8000</span>
        <b class="d">.dsection</b> <u>bank1</u>
        <b class="k">.cerror</b> <u>*</u> &gt; <span>$a000</span>, <span class="s">"Bank1 too long"</span>
	<b class="k">.here</b>

bank1	<b class="k">.block</b>          <i>;Make all symbols local</i>
        <b class="k">.section</b> <u>bank1</u>
        <b class="d">.dsection</b> <u>code</u>  <i>;Code and data sections in bank1</i>
        <b class="d">.dsection</b> <u>data</u>
        <b class="k">.section</b> <u>code</u>   <i>;Pre-open code section</i>
	<b class="k">.include</b> <span class="s">"code.asm"</span><i>; see below</i>
	<b class="k">.include</b> <span class="s">"iter.asm"</span>
        <b class="k">.send</b> <u>code</u>
        <b class="k">.send</b> <u>bank1</u>
	<b class="k">.bend</b>

<i>;Second 8K bank at $2000, PC at $8000</i>
        <b>*=</b> <span>$2000</span>
        <b class="k">.logical</b> <span>$8000</span>
        <b class="d">.dsection</b> <u>bank2</u>
        <b class="k">.cerror</b> <u>*</u> &gt; <span>$a000</span>, <span class="s">"Bank2 too long"</span>
	<b class="k">.here</b>

bank2	<b class="k">.block</b>          <i>;Make all symbols local</i>
        <b class="k">.section</b> <u>bank2</u>
        <b class="d">.dsection</b> <u>code</u>  <i>;Code and data sections in bank2</i>
        <b class="d">.dsection</b> <u>data</u>
        <b class="k">.section</b> <u>code</u>   <i>;Pre-open code section</i>
	<b class="k">.include</b> <span class="s">"scr.asm"</span>
        <b class="k">.send</b> <u>code</u>
        <b class="k">.send</b> <u>bank2</u>
	<b class="k">.bend</b>

<i>;Common data, avoid initialized variables here!</i>
        <b>*=</b> <span>$c000</span>
        <b class="d">.dsection</b> <u>bss</u>
        <b class="k">.cerror</b> <u>*</u> &gt; <span>$d000</span>, <span class="s">"Too much common data"</span>
<i>;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus; The following is in "code.asm"</i>
code    <b>sei</b>

        <b class="k">.section</b> <u>bss</u>   <i>;Common data section</i>
buffer	<b class="d">.fill</b> <span>10</span>
        <b class="k">.send</b> <u>bss</u>

        <b class="k">.section</b> <u>data</u>  <i>;Data section (in bank1)</i>
routine <b class="d">.word</b> <u>print</u>
        <b class="k">.send</b> <u>bss</u>
</pre>

<h3>65816 related<a name="w65816" href="#w65816"></a></h3>
<dl class="dir">
<dt><code><b class="k"><a name="d_as">.as</a></b></code>
<dt><code><b class="k"><a name="d_al">.al</a></b></code>
<dd>Select short (8&nbsp;bit) or long (16&nbsp;bit) accumulator immediate constants.

<pre width=80>
	<b class="k">.al</b>
        <b>lda</b> #<span>$4322</span>
</pre>

<dt><code><b class="k"><a name="d_xs">.xs</a></b></code>
<dt><code><b class="k"><a name="d_xl">.xl</a></b></code>
<dd>Select short (8&nbsp;bit) or long (16&nbsp;bit) index register immediate constants.
<pre width=80>
	<b class="k">.xl</b>
        <b>ldx</b> #<span>$1000</span>
</pre>

<dt><code><b class="k"><a name="d_databank">.databank</a></b></code> &lt;expression&gt;
<dd>Set data bank (65816). Absolute addressing is used only for symbols in this
bank, anything else (except direct page) is using long addressing.
<pre width=80>
        <b class="k">.databank</b> <span>$10</span>   <i>;$10xxxx</i>
</pre>

<dt><code><b class="k"><a name="d_dpage">.dpage</a></b></code> &lt;expression&gt;
<dd>Set direct page. Direct or zero page addressing is only used for addresses
in the following 256 byte range, anything else is using absolute or long
addressing.
<pre width=80>
        <b class="k">.dpage</b> <span>$400</span>
</pre>

</dl>
<h3>Controlling errors<a name="compiletime-checks" href="#compiletime-checks"></a></h3>
<dl class="dir">

<dt><code><b class="k"><a name="d_page">.page</a></b></code>
<dt><code><b class="k"><a name="d_endp">.endp</a></b></code>
<dd>Gives an error on page boundary crossing, e.g. for timing sensitive code.

<pre width=80>
	<b class="k">.page</b>
table   <b class="d">.byte</b> <span>0</span>, <span>1</span>, <span>2</span>, <span>3</span>, <span>4</span>, <span>5</span>, <span>6</span>, <span>7</span>
	<b class="k">.endp</b>
</pre>

<dt><code><b class="k"><a name="d_option">.option</a></b></code> allow_branch_across_page
<dd>Switches error generation on page boundary crossing during relative branch.
Such a condition on 6502 adds 1 extra cycle to the execution time, which
can ruin the timing of a carefully cycle counted code.
<pre width=80>
        <b class="k">.option</b> allow_branch_across_page = <span>0</span>
        <b>ldx</b> #<span>3</span>          <i>;now this will execute in</i>
-       <b>dex</b>             <i>;16 cycles for sure</i>
	<b>bne</b> <u>-</u>
        <b class="k">.option</b> allow_branch_across_page = <span>1</span>
</pre>

<dt><code><b class="k"><a name="d_error">.error</a></b></code> &lt;message&gt; [, &lt;message&gt;, &hellip;]
<dt><code><b class="k"><a name="d_cerror">.cerror</a></b></code> &lt;condition&gt;, &lt;message&gt; [, &lt;message&gt;, &hellip;]
<dd>Exit with error or conditionally exit with error
<pre width=80>
        <b class="k">.error</b> <span class="s">"Unfinished here..."</span>
        <b class="k">.cerror</b> <u>*</u> &gt; <span>$1200</span>, <span class="s">"Program too long by "</span>, <u>*</u> - <span>$1200</span>, <span class="s">" bytes"</span>
</pre>

<dt><code><b class="k"><a name="d_warn">.warn</a></b></code> &lt;message&gt; [, &lt;message&gt;, &hellip;]
<dt><code><b class="k"><a name="d_cwarn">.cwarn</a></b></code> &lt;condition&gt;, &lt;message&gt; [, &lt;message&gt;, &hellip;]
<dd>Display a warning message always or depending on a condition
<pre width=80>
        <b class="k">.warn</b> <span class="s">"FIXME: handle negative values too!"</span>
        <b class="k">.cwarn</b> <u>*</u> &gt; <span>$1200</span>, <span class="s">"This may not work!"</span>
</pre>

</dl>
<h3>Target<a name="target-cpu" href="#target-cpu"></a></h3>
<dl class="dir">

<dt><code><b class="k"><a name="d_cpu">.cpu</a></b></code> &lt;expression&gt;
<dd>Selects CPU according to the string argument.
<pre width=80>
	<b class="k">.cpu</b> <span class="s">"6502"</span>	<i>;standard 65xx</i>
	<b class="k">.cpu</b> <span class="s">"65c02"</span>	<i>;CMOS 65C02</i>
	<b class="k">.cpu</b> <span class="s">"65ce02"</span>	<i>;CSG 65CE02</i>
	<b class="k">.cpu</b> <span class="s">"6502i"</span>	<i>;NMOS 65xx</i>
	<b class="k">.cpu</b> <span class="s">"65816"</span>	<i>;W65C816</i>
	<b class="k">.cpu</b> <span class="s">"65dtv02"</span>	<i>;65dtv02</i>
	<b class="k">.cpu</b> <span class="s">"65el02"</span>	<i>;65el02</i>
	<b class="k">.cpu</b> <span class="s">"r65c02"</span>	<i>;R65C02</i>
	<b class="k">.cpu</b> <span class="s">"w65c02"</span>	<i>;W65C02</i>
	<b class="k">.cpu</b> <span class="s">"default"</span>	<i>;cpu set on commandline</i>
</pre>

</dl>
<h3>Misc<a name="misc" href="#misc"></a></h3>
<dl class="dir">

<dt><code><b class="k"><a name="d_end">.end</a></b></code>
<dd>Terminate assembly. Any content after this directive is ignored.

<dt><code><b class="k"><a name="d_eor">.eor</a></b></code> &lt;expression&gt;
<dd>XOR output with a 8&nbsp;bit value. Useful for reverse screen code text for example,
or for silly <q>encryption</q>.

<dt><code><b class="k"><a name="d_var">.var</a></b></code> &lt;expression&gt;
<dd>Defines a variable identified by the label preceding, which
is set to the value of expression or reference of variable.

<dt><code><b class="k"><a name="d_comment">.comment</a></b></code>
<dt><code><b class="k"><a name="d_endc">.endc</a></b></code>
<dd>Comment block start and comment block end.
<pre width=80>
	<b class="k">.comment</b>
<i>        lda #1          ;this won't be compiled</i>
<i>	sta $d020</i>
	<b class="k">.endc</b>
</pre>

<dt><code><b class="k"><a name="d_assert">.assert</a></b></code>
<dt><code><b class="k"><a name="d_check">.check</a></b></code>
<dd>Do not use these, the syntax will change in next version!

</dl>
<h3>Printer control<a name="listing-control" href="#listing-control"></a></h3>
<dl class="dir">

<dt><code><b class="k"><a name="d_pron">.pron</a></b></code>
<dt><code><b class="k"><a name="d_proff">.proff</a></b></code>
<dd>Turn on or off source listing on part of the file.

<pre width=80>
        <b class="k">.proff</b>           <i>;Don't put filler bytes into listing</i>
        <b>*=</b> <span>$8000</span>
        <b class="d">.fill</b> <span>$2000</span>, <span>$ff</span> <i>;Pre-fill ROM area</i>
	<b class="k">.pron</b>
        <b>*=</b> <span>$8000</span>
        <b class="d">.word</b> <u>reset</u>, <u>restore</u>
        <b class="d">.text</b> <span class="s">"CBM80"</span>
reset   <b>cld</b>
</pre>

<dt><code><b class="k"><a name="d_hidemac">.hidemac</a></b></code>
<dt><code><b class="k"><a name="d_showmac">.showmac</a></b></code>
<dd>Ignored for compatibility
</dl>

<hr>
<h2>Pseudo instructions<a name="pseudo-instructions" href="#pseudo-instructions"></a></h2>

<p>For writing short code there are some special pseudo instructions for always
taken branches. These are automatically compiled as relative branches when the
jump distance is short enough and as <code>JMP</code> or <code>BRL</code> when
longer. The names are derived from conditional branches and are:
<code>GEQ</code>, <code>GNE</code>, <code>GCC</code>, <code>GCS</code>,
<code>GPL</code>, <code>GMI</code>, <code>GVC</code>, and <code>GVS</code>.</p>

<p>There's one more called <code>GRA</code> for CPUs supporting
<code>BRA</code>, which is expanded to <code>BRL</code> (if available) or
<code>JMP</code>.</p>

<pre>
.0000    a9 03          lda #$03        in1     <b>lda</b> #<span>3</span>
.0002    d0 02          bne $0006               <b>gne</b> <u>at</u>          <i>;branch always</i>
.0004    a9 02          lda #$02        in2     <b>lda</b> #<span>2</span>
.0006    4c 00 10       jmp $1000       at      <b>gne</b> <span>$1000</span>       <i>;branch further</i>
</pre>

<p>If the branch would skip only one byte then the opposite condition is compiled
and only the first byte is emitted. This is now a never executed jump, and the
relative distance byte after the opcode is the jumped over byte.</p>

<p>If the branch would not skip anything at all then no code is generated.</p>

<pre>
.0009                                           <b>geq</b> <u>in3</u>         <i>;zero length "branch"</i>
.0009    18             clc             in3     <b>clc</b>
.000a    b0             bcs                     <b>gcc</b> <u>at2</u>         <i>;one byte skip, as bcs</i>
.000b    38             sec             in4     <b>sec</b>             <i>;sec is skipped!</i>
.000c    20 0f 00       jsr $000f       at2     <b>jsr</b> <u>func</u>
.000f                                   func
</pre>

<p>Please note that expressions like <code>Gxx &lowast;+2</code> or <code>Gxx
&lowast;+3</code> are not allowed as the compiler can't figure out if it has to create
no code at all, the 1 byte variant or the 2 byte one. Therefore use normal or
anonymous labels defined after the jump instruction when jumping forward!</p>

<p>To avoid branch too long errors the assembler also supports long branches,
it can automatically convert conditional relative branches to it's opposite and
a <code>JMP</code> or <code>BRL</code>. This can be enabled on the command
line using the <q>--long-branch</q> option.</p>

<pre>
.0000    ea             nop                     <b>nop</b>
.0001    b0 03          bcs $0006               <b>bcc</b> <span>$1000</span>      <i>;long branch (6502)</i>
.0003    4c 00 10       jmp $1000
.0006    1f 17 03       bbr 1,$17,$000c         <b>bbs</b> <span>1</span>,<span>23</span>,<span>$1000</span> <i>;long branch (R65C02)</i>
.0009    4c 00 10       jmp $1000
.000c    d0 04          bne $0012               <b>beq</b> <span>$10000</span>     <i>;long branch (65816)</i>
.000e    5c 00 00 01    jmp $010000
.0012    30 03          bmi $0017               <b>bpl</b> <span>$1000</span>      <i>;long branch (65816)</i>
.0014    82 e9 lf       brl $1000
.0017    ea             nop                     <b>nop</b>
</pre>

<p>Please note that forward jump expressions like <code>Bxx &lowast;+130</code>,
<code>Bxx &lowast;+131</code> and <code>Bxx &lowast;+132</code> are not allowed as the
compiler can't decide between a short/long branch. Of course these destinations
can be used, but only with normal or anonymous labels defined after the jump
instruction.</p>

<hr>
<h2>Original turbo assembler compatibility<a name="tasm-compatibility" href="#tasm-compatibility"></a></h2>
<h3>How to convert source code for use with 64tass<a name="tasm-convert" href="#tasm-convert"></a></h3>
<p>Currently there are two options, either use <q>TMPview</q> by Style to convert the
sourcefile directly, or do the following:</p>
<ul>
<li>load turbo assembler, start (by <code>SYS9&lowast;4096</code> or <code>SYS8&lowast;4096</code> depending on version)
<li>&larr; then l to load a source file
<li>&larr; then w to write a source file in PETSCII format
<li>convert the result to ASCII using petcat (from the vice package)
</ul>
<p>The resulting file should then (with the restrictions below) assemble using the
following command line:</p>
<pre width=80>
64tass -C -T -a -W -i source.asm -o outfile.prg
</pre>

<h3>Differences to the original turbo ass macro on the C64<a name="tasm-diff" href="#tasm-diff"></a></h3>
<p>64tass is nearly 100% compatible with the original <q>Turbo Assembler</q>, and supports
most of the features of the original <q>Turbo Assembler Macro</q>.
The remaining notable differences are listed here.</p>
<h3>Labels<a name="tasm-labels" href="#tasm-labels"></a></h3>
<p>The original turbo assembler uses case sensitive labels, use the <tt>-C, --case-sensitive</tt>
option to enable this behaviour.</p>

<h3>Expression evaluation<a name="tasm-expression" href="#tasm-expression"></a></h3>

<p>There are a few differences which can be worked around by the <tt>-T, --tasm-compatible</tt> option.
These are:</p>

<p>The original expression parser has no operator precedence, but 64tass has. That
means that you will have to fix expressions using braces accordingly, for example
<code>1+2&lowast;3</code> becomes <code>(1+2)&lowast;3</code>.</p>

<p>The following operators used by the original Turbo Assembler are different:</p>

<div><table border="0">
<caption>TASM Operator differences</caption>
<tbody>
<tr><td width="80"><code>.</code><td>bitwise or, now <code>|</code>
<tr><td><code>:</code><td>bitwise eor, now <code>^</code>
<tr><td><code>!</code><td>force 16&nbsp;bit address, now <code>@w</code>
</tbody>
</table></div>

<p>The default expression evaluation is not limited to 16&nbsp;bit unsigned numbers anymore.</p>

<h3>Macros<a name="tasm-macros" href="#tasm-macros"></a></h3>
<p>Macro parameters are referenced by <q><code>\1</code></q>&ndash;<q><code>\9</code></q> instead of using the pound sign.</p>
<p>Parameters are always copied as text into the macro and not passed by value as the
original turbo assembler does, which sometimes may lead to unexpected behaviour. You may
need to make use of braces around arguments and/or references to fix this.</p>

<h3>Bugs<a name="tasm-bugs" href="#tasm-bugs"></a></h3>
<p>Some versions of the original turbo assembler had bugs that are not reproduced
by 64tass, you will have to fix the code instead.</p>
<p>In some versions labels used in the first <code>.block</code> are globally available. If
you get a related error move the respective label out of the <code>.block</code></p>

<hr>
<h2>Command line options<a name="commandline-options" href="#commandline-options"></a></h2>

<h3>Output options<a name="commandline-output" href="#commandline-output"></a></h3>

<dl class="dir">
<dt><b>-o</b> &lt;filename&gt;
<dd>Place output into &lt;filename&gt;. The default output filename is <q>a.out</q>. This option changes it.
<pre width=80>
64tass a.asm -o a.prg
</pre>

<dt>no option
<dd>Outputs CBM format binaries
<p>The first 2 bytes are the little endian address of the first valid byte (start
address). Overlapping blocks are flattened and uninitialized memory is filled up with zeros.
Uninitialized memory before the first and after the last valid bytes are not saved.</p>
<p>Used for C64 binaries.</p>

<dt><b>-b</b>, <b>--nostart</b>
<dd>Output data only without start address
<p>Overlapping blocks are flattened and uninitialized memory is filled up with zeros. Uninitialized memory
before the first and after the last valid bytes are not saved.</p>
<p>Useful for small ROM files.</p>

<dt><b>-f</b>, <b>--flat</b>
<dd>Flat address space output mode.
<p>Overlapping blocks are flattened and uninitialized memory is filled up with
zeros. Uninitialized memory after the last valid byte is not saved.</p>
<p>Useful for creating huge multi bank ROM files (over 64K). See sections for an example.</p>

<dt><b>-n</b>, <b>--nonlinear</b>
<dd>Generate nonlinear output file.
<p>Overlapping blocks are flattened. Blocks are saved in sorted order and uninitialized memory is skipped.</p>
<p>Used for linkers.</p>
<pre width=80>
64tass --nonlinear a.asm
        <b>*=</b> <span>$1000</span>
        <b>lda</b> #<span>2</span>
        <b>*=</b> <span>$2000</span>
	<b>nop</b>
</pre>
<div><table border="0">
<caption>Result of compilation</caption>
<tbody>
<tr><td><tt>$02, $00</tt><td>little endian length, 2 bytes
<tr><td><tt>$00, $10</tt><td>little endian start $1000
<tr><td><tt>$a9, $02</tt><td>code
<tr><td><tt>$01, $00</tt><td>little endian length, 1 byte
<tr><td><tt>$00, $20</tt><td>little endian start $2000
<tr><td><tt>$ea</tt><td>code
<tr><td><tt>$00, $00</tt><td>end marker (length=0)
</tbody>
</table></div>

<dt><b>-X</b>, <b>--long-address</b>
<dd>Use 3 byte address/length for CBM and nonlinear output instead of 2 bytes.
<pre width=80>
64tass --long-address --m65816 a.asm
</pre>

<dt><b>--atari-xex</b>
<dd>Generate a Atari XEX output file.
<p>Overlapping blocks are kept, continuing blocks are concatenated. Saving
happens in the definition order without sorting, and uninitialized memory is
skipped in the output.</p>
<pre width=80>
64tass --atari-xex a.asm
        <b>*=</b> <span>$02e0</span>
        <b class="d">.word</b> <u>start</u>      <i>;run address</i>
        <b>*=</b> <span>$2000</span>
start	<b>rts</b>
</pre>
<div><table border="0">
<caption>Result of compilation</caption>
<tbody>
<tr><td><tt>$ff, $ff</tt><td>header, 2 bytes
<tr><td><tt>$e0, $02</tt><td>little endian start $02e0
<tr><td><tt>$e1, $02</tt><td>little endian last byte $02e1
<tr><td><tt>$00, $20</tt><td>start address word
<tr><td><tt>$00, $20</tt><td>little endian start $2000
<tr><td><tt>$00, $20</tt><td>little endian last byte $2000
<tr><td><tt>$60</tt><td>code
</tbody>
</table></div>

<dt><b>--apple2</b>
<dd>Generate a Apple II output file (DOS 3.3).
<p>Overlapping blocks are flattened and uninitialized memory is filled up with zeros. Uninitialized memory
before the first and after the last valid bytes are not saved.</p>
<pre width=80>
64tass --apple-ii a.asm
        <b>*=</b> <span>$0c00</span>
        <b>rts</b>
</pre>
<div><table border="0">
<caption>Result of compilation</caption>
<tbody>
<tr><td><tt>$00, $0c</tt><td>little endian start $0c00
<tr><td><tt>$01, $00</tt><td>little endian length $0001
<tr><td><tt>$60</tt><td>code
</tbody>
</table></div>
</dl>

<h3>Operation options<a name="commandline-operation" href="#commandline-operation"></a></h3>

<dl class="dir">
<dt><b>-a</b>, <b>--ascii</b>
<dd>Use ASCII/Unicode text encoding instead of raw 8-bit
<p>Normally no conversion takes place, this is for backwards compatibility with
a DOS based Turbo Assembler editor, which could create PETSCII files for
6502tass. (including control characters of course)</p>
<p>Using this option will change the default <q>none</q> and <q>screen</q> encodings to
map <code>'a'&ndash;'z'</code> and <code>'A'&ndash;'Z'</code> into the correct PETSCII range of <code>$41&ndash;$5A</code> and <code>$C1&ndash;$DA</code>,
which is more suitable for an ASCII editor. It also adds predefined petcat style
PETSCII literals to the default encodings.</p>

<p><b>For writing sources in UTF-8/UTF-16 encodings this option is required!</b> The
symbol names are still limited to ASCII, but custom string encodings can take
advantage of the full Unicode set.</p>
<pre width=80>
64tass a.asm

.0000    a9 61          lda #$61        <b>lda</b> #<span class="s">"a"</span>

&gt;0002    31 61 41                       <b class="d">.text</b> <span class="s">"1aA"</span>
&gt;0005    7b 63 6c 65 61 72 7d 74        <b class="d">.text</b> <span class="s">"{clear}text{return}more"</span>
&gt;000e    65 78 74 7b 72 65 74 75
&gt;0016    72 6e 7d 6d 6f 72 65

64tass --ascii a.asm

.0000    a9 41          lda #$41        <b>lda</b> #<span class="s">"a"</span>
&gt;0002    31 41 c1                       <b class="d">.text</b> <span class="s">"1aA"</span>
&gt;0005    93 54 45 58 54 0d 4d 4f        <b class="d">.text</b> <span class="s">"<span>{clear}</span>text<span>{return}</span>more"</span>
&gt;000e    52 45
</pre>

<dt><b>-B</b>, <b>--long-branch</b>
<dd>Automatic <code>BXX &lowast;+5 JMP xxx</code>. Branch too long messages can be annoying
sometimes, usually they'll need to be rewritten to <code>BXX &lowast;+5 JMP xxx</code>.
64tass can do this automatically if this option is used. But <code>BRA</code>
is not converted.
<pre width=80>
64tass a.asm
        <b>*=</b> <span>$1000</span>
        <b>bcc</b> <span>$1233</span>	<i>;error...</i>

64tass a.asm
        <b>*=</b> <span>$1000</span>
        <b>bcs</b> *+<span>5</span>		<i>;opposite condition</i>
        <b>jmp</b> <span>$1233</span>	<i>;as simple workaround</i>

64tass --long-branch a.asm
        <b>*=</b> <span>$1000</span>
        <b>bcc</b> <span>$1233</span>	<i>;no error, automatically converted to the above one.</i>
</pre>

<dt><b>-C</b>, <b>--case-sensitive</b>
<dd>Case sensitive labels. Labels are non case sensitive by default, this
option changes that.
<pre>
64tass a.asm
label	<b>nop</b>
Label	<b>nop</b>	<i>;double defined...</i>

64tass --case-sensitive a.asm
label   <b>nop</b>
Label	<b>nop</b>	<i>;Ok, it's a different label...</i>
</pre>

<dt><b>-D</b> &lt;label&gt;=&lt;value&gt;
<dd>Define &lt;label&gt; to &lt;value&gt;. Defines a label to a value. Same
syntax is allowed as in source files. Be careful with string quoting, the shell
might eat some of the characters.
<pre width=80>
64tass -D ii=2 a.asm
        <b>lda</b> #<u>ii</u> <i>;result: $a9, $02</i>
</pre>

<dt><b>-w</b>, <b>--no-warn</b>
<dd>Suppress warnings. Disables warnings during compile.
<pre width=80>
64tass --no-warn a.asm
</pre>

<dt><b>-q</b>, <b>--quiet</b>
<dd>Suppress messages. Disables header and summary messages.
<pre width=80>
64tass --quiet a.asm
</pre>

<dt><b>-T</b>, <b>--tasm-compatible</b>
<dd>Enable TASM compatible operators and precedence
<p>Switches the expression evaluator into compatibility mode. This
enables <q>.</q>, <q>:</q> and <q>!</q> operators and disables 64tass specific extensions, disables precedence handling
and forces 16&nbsp;bit unsigned evaluation (see <q>differences to original Turbo Assembler</q> below)</p>

<dt><b>-I</b> &lt;path&gt;
<dd>Specify include search path
<p>If an included source or binary file can't be found in the directory of the
source file then this path is tried. More than one directories can be specified
by repeating this option. If multiple matches exist the first one is used.</p>
</dl>

<h3>Target selection on command line<a name="commandline-target" href="#commandline-target"></a></h3>
<p>These options will select the default architecture. It can be overridden by
using the <code>.cpu</code> directive in the source.</p>

<dl class="dir">
<dt><b>--m65xx</b>
<dd>Standard 65xx (default). For writing compatible code, no extra codes. This
is the default.
<pre width=80>
64tass --m65xx a.asm
        <b>lda</b> <span>$14</span>		<i>;regular instructions</i>
</pre>

<dt><b>-c</b>, <b>--m65c02</b>
<dd>CMOS 65C02. Enables extra opcodes and addressing modes specific to this
CPU.
<pre width=80>
64tass --m65c02 a.asm
        <b>stz</b> <span>$d020</span>	<i>;65c02 instruction</i>
</pre>

<dt><b>-c</b>, <b>--m65ce02</b>
<dd>CSG 65CE02. Enables extra opcodes and addressing modes specific to this
CPU.
<pre width=80>
64tass --m65ce02 a.asm
        <b>inz</b>
</pre>

<dt><b>-i</b>, <b>--m6502</b>
<dd>NMOS 65xx. Enables extra illegal opcodes. Useful for demo coding for C64,
disk drive code, etc.
<pre width=80>
64tass --m6502 a.asm
        <b>lax</b> <span>$14</span>		<i>;illegal instruction</i>
</pre>

<dt><b>-t</b>, <b>--m65dtv02</b>
<dd>65DTV02. Enables extra opcodes specific to DTV.
<pre width=80>
64tass --m65dtv02 a.asm
        <b>sac</b> #<span>$00</span>
</pre>

<dt><b>-x</b>, <b>--m65816</b>
<dd>W65C816. Enables extra opcodes, and full 16&nbsp;MiB address space. Useful
for SuperCPU projects. Don't forget to use <q>--word-start</q> for small ones
;)
<pre width=80>
64tass --m65816 a.asm
        <b>lda</b> <span>$123456</span>,x
</pre>

<dt><b>-e</b>, <b>--m65el02</b>
<dd>65EL02. Enables extra opcodes, useful <a href="http://www.eloraam.com/nonwp/redcpu.php">RedPower CPU</a> projects. Probably you'll need <q>--nostart</q> as well.
<pre width=80>
64tass --m65el02 a.asm
        <b>lda</b> <span>0</span>,r
</pre>

<dt><b>--mr65c02</b>
<dd>R65C02. Enables extra opcodes and addressing modes specific to this CPU.
<pre width=80>
64tass --mr65c02 a.asm
        <b>rmb</b> <span>7</span>,<span>$20</span>
</pre>

<dt><b>--mw65c02</b>
<dd>W65C02. Enables extra opcodes and addressing modes specific to this CPU.
<pre width=80>
64tass --mw65c02 a.asm
        <b>wai</b>
</pre>
</dl>

<h3>Source listing options<a name="commandline-listing" href="#commandline-listing"></a></h3>

<dl class="dir">
<dt><b>-l</b> &lt;file&gt;, <b>--labels</b>=&lt;file&gt;
<dd>List labels into &lt;file&gt;. List global used labels to a file.
<pre width=80>
64tass -l labels.txt a.asm
        <b>*=</b> <span>$1000</span>
label   <b>jmp</b> <u>label</u>

result (labels.txt):
label           = $1000
</pre>

<dt><b>-L</b> &lt;file&gt;, <b>--list</b>=&lt;file&gt;
<dd>List into &lt;file&gt;. Dumps source code and compiled code into file.
Useful for debugging, it's much easier to identify the code in memory within
the source files.
<pre width=80>
64tass -L list.txt a.asm
        <b>*=</b> <span>$1000</span>
        <b>ldx</b> #<span>0</span>
loop	<b>dex</b>
        <b>bne</b> <u>loop</u>
	<b>rts</b>

result (list.txt):

;64tass Turbo Assembler Macro V1.5x listing file of "a.asm"
;done on Fri Dec  9 19:08:55 2005


.1000	 a2 00		ldx #$00		ldx #0
.1002	 ca		dex		loop	dex
.1003	 d0 fd		bne $1002		bne loop
.1005	 60		rts			rts

;&lowast;&lowast;&lowast;&lowast;&lowast;&lowast;  end of code
</pre>

<dt><b>-m</b>, <b>--no-monitor</b>
<dd>Don't put monitor code into listing. There won't be any monitor listing in the list file.
<pre width=80>
64tass --no-monitor -L list.txt a.asm

result (list.txt):

;64tass Turbo Assembler Macro V1.5x listing file of "a.asm"
;done on Fri Dec  9 19:11:43 2005


.1000	 a2 00					ldx #0
.1002	 ca				loop	dex
.1003	 d0 fd					bne loop
.1005	 60					rts

;&lowast;&lowast;&lowast;&lowast;&lowast;&lowast;  end of code
</pre>

<dt><b>-s</b>, <b>--no-source</b>
<dd>Don't put source code into listing. There won't be any source listing in the list file.
<pre width=80>
64tass --no-source -L list.txt a.asm

result (list.txt):

;64tass Turbo Assembler Macro V1.5x listing file of "a.asm"
;done on Fri Dec  9 19:13:25 2005


.1000	 a2 00		ldx #$00
.1002	 ca		dex
.1003	 d0 fd		bne $1002
.1005	 60		rts

;&lowast;&lowast;&lowast;&lowast;&lowast;&lowast;  end of code
</pre>

<dt><b>--tab-size</b>=&lt;number&gt;

<dd>By default the listing file is using a tab size of 8 to align the
disassembly. This can be changed to other more favorable values like 4.
Only spaces are used if 1 is selected. Please note that this has
no effect on the source code on the right hand side.
</dl>

<h3>Other options<a name="commandline-other" href="#commandline-other"></a></h3>

<dl class="dir">
<dt><b>-?</b>, <b>--help</b>
<dd>Give this help list. Prints help about command line options.

<dt><b>--usage</b>
<dd>Give a short usage message. Prints short help about command line options.

<dt><b>-V</b>, <b>--version</b>
<dd>Print program version
</dl>

<hr>
<h2>Messages<a name="messages" href="#messages"></a></h2>

<p>Faults and warnings encountered are sent to standard error for logging. To
redirect them into a file append <q>2&gt;filename.log</q> after the command. The format of
messages is the following:</p>
<p>&lt;filename&gt;:&lt;line&gt;:&lt;character&gt;: &lt;severity&gt;: &lt;message&gt;</p>
<ul>
<li>filename: The name and path of source file where the error happened.
<li>line: Line number of file, starts from 1.
<li>character: Character in line, starts from 1. Tabs are not expanded.
<li>severity: Note, warning, error or fatal.
<li>message: The fault message itself.
</ul>
<p>The faulty line may be displayed after the message with a caret pointing to the error location.</p>

<pre width=80>a.asm:3:21: error: not defined 'label'
                 lda label
                     ^
a.asm:3:21: note: searched in the global scope</pre>
<p>Lines containing macros are expanded whenever possible, but due to
internal limitations referenced lines in relation to the actual fault
will display without them.</p>
<h3>Warnings<a name="messages-warnings" href="#messages-warnings"></a></h3>
<dl class="errorlist">
<dt>directive ignored<dd>an assembler directive was ignored for compatibility reasons.
<dt>label not on left side<dd>check if an instruction name was not mistyped and if the currect CPU has it, or remove white space before label
<dt>long branch used<dd>branch too long, so long branch was used (bxx &lowast;+5 jmp)
<dt>memory bank exceeded<dd>compile continues in the next 64&nbsp;KiB bank, however execution may not
<dt>possible jmp ($xxff) bug<dd>yet another 65xx feature...
<dt>top of memory exceeded<dd>compile continues at the bottom ($0000)
</dl>

<h3>Errors<a name="messages-errors" href="#messages-errors"></a></h3>
<dl class="errorlist">
<dt>? expected<dd>something is missing
<dt>address not in processor address space<dd>value larger than current CPU address space
<dt>address out of section<dd>moving the address around is fine, but do not place it before the section
<dt>branch crosses page<dd>page crossing detected
<dt>branch too far by ? bytes<dd>can't branch that far
<dt>can't calculate stable value<dd>somehow it's impossible to calculate this expression
<dt>can't calculate this<dd>could not get any value, is this a circular reference?
<dt>can't convert to a ? bit signed/unsigned integer<dd>value out of range
<dt>can't convert to boolean<dd>conversion error
<dt>can't convert to integer<dd>conversion error
<dt>can't encode character $xx<dd>can't translate character, not part of current encoding
<dt>can't get absolute value<dd>value has no absolute value
<dt>can't get length<dd>value has no length
<dt>can't get sign<dd>value does not have a sign
<dt>can't get size<dd>value has no size
<dt>conflict<dd>at least one feature is provided, which shouldn't be there
<dt>constant too large<dd>floating point overflow and other value out of range conditions
<dt>division by zero<dd>can't calculate this
<dt>double defined escape<dd>escape sequence already defined in another .edef
<dt>double defined range<dd>part of a character range was already defined by another .cdef
<dt>duplicate definition<dd>symbol defined more than once
<dt>expected exactly/at least/at most ? arguments, got ?<dd>wrong number of function arguments
<dt>expression syntax<dd>syntax error
<dt>extra characters on line<dd>there's some garbage on the end of line
<dt>floating point overflow<dd>infinity reached during a calculation
<dt>general syntax<dd>can't do anything with this
<dt>index out of range<dd>not enough elements in list
<dt>instruction can't cross banks<dd>this instruction is only limited to the current bank
<dt>invalid operands to ? '?' and '?'<dd>can't do this calculation with these values
<dt>key error<dd>not in dictionary
<dt>label required<dd>a label is mandatory for this directive
<dt>logarithm of non-positive number<dd>Only positive numbers have a logarithm
<dt>missing argument<dd>not enough arguments supplied to function
<dt>most significiant bit must be clear in byte<dd>.shift and .shiftl only valid with 7 bit strings
<dt>negative number raised on fractional power<dd>can't calculate this
<dt>no ? addressing mode for opcode<dd>this addressing mode is not valid for this opcode
<dt>not a bank 0 address<dd>value must be a bank zero address
<dt>not a data bank address<dd>value must be a data bank address
<dt>not a direct page address<dd>value must be a direct page address
<dt>not a key and value pair<dd>dictionaries are built from key and value pairs separated by a colon
<dt>not a one character string<dd>only a single character string is allowed
<dt>not allowed here: ?<dd>do not use this directive here
<dt>not defined '?'<dd>can't find this label
<dt>not hashable<dd>can't be used as a key in a dictionary
<dt>not in range -1.0 to 1.0<dd>the function is only valid in the -1.0 to 1.0 range
<dt>not iterable<dd>value is not a list or other iterable object
<dt>operands could not be broadcast together with shapes ? and ?<dd>list length must match or must have a single element only
<dt>page error at $xxxx<dd>page crossing detected
<dt>ptext too long by ? bytes<dd>.ptext is limited to 255 bytes maximum
<dt>requirements not met<dd>Not all features are provided, at least one is missing
<dt>reserved symbol name '?'<dd>do not use this symbol name
<dt>square root of negative number<dd>can't calculate the square root of a negative number
<dt>too early to reference<dd>processing still ongoing, can't access this yet
<dt>unknown processor '?'<dd>unknown cpu name
<dt>wrong type &lt;?&gt;<dd>wrong object type used
<dt>zero value not allowed<dd>do not use zero, also not with .null
</dl>

<h3>Fatal errors<a name="messages-fatal" href="#messages-fatal"></a></h3>
<dl class="errorlist">
<dt>can't open file<dd>cannot open file
<dt>can't write label file<dd>cannot write the label file
<dt>can't write listing file<dd>cannot write the list file
<dt>can't write object file<dd>cannot write the result
<dt>error reading file<dd>error while reading
<dt>file recursion<dd>wrong use of .include
<dt>macro recursion too deep<dd>wrong use of nested macros
<dt>unknown option '?'<dd>option not known
<dt>out of memory<dd>won't happen ;)
<dt>too many passes<dd>with a carefully crafted source file it's possible to create unresolvable situations. Fix your code.
</dl>

<hr>
<h2>Credits<a name="credits" href="#credits"></a></h2>

<p>Original written for DOS by Marek Matula of Taboo, then ported to ANSI C by
BigFoot/Breeze, and finally added 65816 support, DTV, illegal opcodes,
optimizations, multi pass compile and a lot of features by Soci/Singular.
Improved TASS compatibility, PETSCII codes by Groepaz.</p>

<p>Additional code: my_getopt command-line argument parser by Benjamin
Sittler, avl tree code by Franck Bui-Huu, ternary tree code by Daniel
Berlin, snprintf Alain Magloire, Amiga OS4 support files by Janne Per&auml;aho.</p>

<p>Main developer and maintainer: soci at c64.rulez.org</p>
<hr>
<h2>Default translation and escape sequences<a name="builtin-translations-escapes" href="#builtin-translations-escapes"></a></h2>
<h3>Raw 8-bit source<a name="translate-raw8" href="#translate-raw8"></a></h3>
<p>By default raw 8-bit encoding is used and nothing is translated or escaped.
This mode is for compiling sources which are already PETSCII.</p>
<h4>The <q>none</q> encoding for raw 8-bit<a name="translate-raw8-none" href="#translate-raw8-none"></a></h4>
<p>Does no translation at all, no translation table, no escape sequences.</p>
<h4>The <q>screen</q> encoding for raw 8-bit<a name="translate-raw8-screen" href="#translate-raw8-screen"></a></h4>
<p>The following translation table applies, no escape sequences.</p>
<div><table width="100%">
<caption>Built-in PETSCII to PETSCII screen code translation table</caption>
<thead>
<tr><th>Input<th>Byte
<th>Input<th>Byte
</thead><tbody>
<tr><td>00&ndash;1F<td>80&ndash;9F
<td>20&ndash;3F<td>20&ndash;3F
<tr><td>40&ndash;5F<td>00&ndash;1F
<td>60&ndash;7F<td>40&ndash;5F
<tr><td>80&ndash;9F<td>80&ndash;9F
<td>A0&ndash;BF<td>60&ndash;7F
<tr><td>C0&ndash;FE<td>40&ndash;7E
<td>FF<td>5E
</tbody>
</table></div>

<h3>Unicode and ASCII source<a name="translate-unicode" href="#translate-unicode"></a></h3>
<p>Unicode encoding is used when the <q><tt>-a</tt></q> option is given on the command line.</p>
<h4>The <q>none</q> encoding for Unicode<a name="translate-unicode-none" href="#translate-unicode-none"></a></h4>
This is a Unicode to PETSCII mapping, including escape sequences for control codes.
<div><table width="100%" class="trans">
<caption>Built-in Unicode to PETSCII translation table</caption>
<thead>
<tr><th>Glyph<th>Unicode<th>Byte
<th>Glyph<th>Unicode<th>Byte
</thead><tbody>
<tr><td>&nbsp;&ndash;&#x40;<td>U+0020&ndash;U+0040<td>20&ndash;40
<td>&#x41;&ndash;&#x5a;<td>U+0041&ndash;U+005A<td>C1&ndash;DA
<tr><td>&#x5b;<td>U+005B<td>5B
<td>&#x5d;<td>U+005D<td>5D
<tr><td>&#x61;&ndash;&#x7a;<td>U+0061&ndash;U+007A<td>41&ndash;5A
<td>&#xa3;<td>U+00A3<td>5C
<tr><td>&#x03c0;<td>U+03C0<td>FF
<td>&#x2190;<td>U+2190<td>5F
<tr><td>&#x2191;<td>U+2191<td>5E
<td>&#x2500;<td>U+2500<td>C0
<tr><td>&#x2502;<td>U+2502<td>DD
<td>&#x250c;<td>U+250C<td>B0
<tr><td>&#x2510;<td>U+2510<td>AE
<td>&#x2514;<td>U+2514<td>AD
<tr><td>&#x2518;<td>U+2518<td>BD
<td>&#x251c;<td>U+251C<td>AB
<tr><td>&#x2524;<td>U+2524<td>B3
<td>&#x252c;<td>U+252C<td>B2
<tr><td>&#x2534;<td>U+2534<td>B1
<td>&#x253c;<td>U+253C<td>DB
<tr><td>&#x256d;<td>U+256D<td>D5
<td>&#x256e;<td>U+256E<td>C9
<tr><td>&#x256f;<td>U+256F<td>CB
<td>&#x2570;<td>U+2570<td>CA
<tr><td>&#x2571;<td>U+2571<td>CE
<td>&#x2572;<td>U+2572<td>CD
<tr><td>&#x2573;<td>U+2573<td>D6
<td>&#x2581;<td>U+2581<td>A4
<tr><td>&#x2582;<td>U+2582<td>AF
<td>&#x2583;<td>U+2583<td>B9
<tr><td>&#x2584;<td>U+2584<td>A2
<td>&#x258c;<td>U+258C<td>A1
<tr><td>&#x258d;<td>U+258D<td>B5
<td>&#x258e;<td>U+258E<td>B4
<tr><td>&#x258f;<td>U+258F<td>A5
<td>&#x2592;<td>U+2592<td>A6
<tr><td>&#x2594;<td>U+2594<td>A3
<td>&#x2595;<td>U+2595<td>A7
<tr><td>&#x2596;<td>U+2596<td>BB
<td>&#x2597;<td>U+2597<td>AC
<tr><td>&#x2598;<td>U+2598<td>BE
<td>&#x259a;<td>U+259A<td>BF
<tr><td>&#x259d;<td>U+259D<td>BC
<td>&#x25cb;<td>U+25CB<td>D7
<tr><td>&#x25cf;<td>U+25CF<td>D1
<td>&#x25e4;<td>U+25E4<td>A9
<tr><td>&#x25e5;<td>U+25E5<td>DF
<td>&#x2660;<td>U+2660<td>C1
<tr><td>&#x2663;<td>U+2663<td>D8
<td>&#x2665;<td>U+2665<td>D3
<tr><td>&#x2666;<td>U+2666<td>DA
<td>&#x2713;<td>U+2713<td>BA
</tbody>
</table></div>

<div><table width="100%" class="esc">
<caption>Built-in PETSCII escape sequences</caption>
<thead>
<tr><th>Escape<th>Byte
<th>Escape<th>Byte
<th>Escape<th>Byte
</thead><tbody>
<tr><td>{bell}<td>07
<td>{black}<td>90
<td>{blk}<td>90
<tr><td>{blue}<td>1F
<td>{blu}<td>1F
<td>{brn}<td>95
<tr><td>{brown}<td>95
<td>{cbm-*}<td>DF
<td>{cbm-+}<td>A6
<tr><td>{cbm--}<td>DC
<td>{cbm-0}<td>30
<td>{cbm-1}<td>81
<tr><td>{cbm-2}<td>95
<td>{cbm-3}<td>96
<td>{cbm-4}<td>97
<tr><td>{cbm-5}<td>98
<td>{cbm-6}<td>99
<td>{cbm-7}<td>9A
<tr><td>{cbm-8}<td>9B
<td>{cbm-9}<td>29
<td>{cbm-@}<td>A4
<tr><td>{cbm-^}<td>DE
<td>{cbm-a}<td>B0
<td>{cbm-b}<td>BF
<tr><td>{cbm-c}<td>BC
<td>{cbm-d}<td>AC
<td>{cbm-e}<td>B1
<tr><td>{cbm-f}<td>BB
<td>{cbm-g}<td>A5
<td>{cbm-h}<td>B4
<tr><td>{cbm-i}<td>A2
<td>{cbm-j}<td>B5
<td>{cbm-k}<td>A1
<tr><td>{cbm-l}<td>B6
<td>{cbm-m}<td>A7
<td>{cbm-n}<td>AA
<tr><td>{cbm-o}<td>B9
<td>{cbm-pound}<td>A8
<td>{cbm-p}<td>AF
<tr><td>{cbm-q}<td>AB
<td>{cbm-r}<td>B2
<td>{cbm-s}<td>AE
<tr><td>{cbm-t}<td>A3
<td>{cbm-up&nbsp;arrow}<td>DE
<td>{cbm-u}<td>B8
<tr><td>{cbm-v}<td>BE
<td>{cbm-w}<td>B3
<td>{cbm-x}<td>BD
<tr><td>{cbm-y}<td>B7
<td>{cbm-z}<td>AD
<td>{clear}<td>93
<tr><td>{clr}<td>93
<td>{control-0}<td>92
<td>{control-1}<td>90
<tr><td>{control-2}<td>05
<td>{control-3}<td>1C
<td>{control-4}<td>9F
<tr><td>{control-5}<td>9C
<td>{control-6}<td>1E
<td>{control-7}<td>1F
<tr><td>{control-8}<td>9E
<td>{control-9}<td>12
<td>{control-:}<td>1B
<tr><td>{control-;}<td>1D
<td>{control-=}<td>1F
<td>{control-@}<td>00
<tr><td>{control-a}<td>01
<td>{control-b}<td>02
<td>{control-c}<td>03
<tr><td>{control-d}<td>04
<td>{control-e}<td>05
<td>{control-f}<td>06
<tr><td>{control-g}<td>07
<td>{control-h}<td>08
<td>{control-i}<td>09
<tr><td>{control-j}<td>0A
<td>{control-k}<td>0B
<td>{control-left&nbsp;arrow}<td>06
<tr><td>{control-l}<td>0C
<td>{control-m}<td>0D
<td>{control-n}<td>0E
<tr><td>{control-o}<td>0F
<td>{control-pound}<td>1C
<td>{control-p}<td>10
<tr><td>{control-q}<td>11
<td>{control-r}<td>12
<td>{control-s}<td>13
<tr><td>{control-t}<td>14
<td>{control-up&nbsp;arrow}<td>1E
<td>{control-u}<td>15
<tr><td>{control-v}<td>16
<td>{control-w}<td>17
<td>{control-x}<td>18
<tr><td>{control-y}<td>19
<td>{control-z}<td>1A
<td>{cr}<td>0D
<tr><td>{cyan}<td>9F
<td>{cyn}<td>9F
<td>{delete}<td>14
<tr><td>{del}<td>14
<td>{dish}<td>08
<td>{down}<td>11
<tr><td>{ensh}<td>09
<td>{esc}<td>1B
<td>{f10}<td>82
<tr><td>{f11}<td>84
<td>{f12}<td>8F
<td>{f1}<td>85
<tr><td>{f2}<td>89
<td>{f3}<td>86
<td>{f4}<td>8A
<tr><td>{f5}<td>87
<td>{f6}<td>8B
<td>{f7}<td>88
<tr><td>{f8}<td>8C
<td>{f9}<td>80
<td>{gray1}<td>97
<tr><td>{gray2}<td>98
<td>{gray3}<td>9B
<td>{green}<td>1E
<tr><td>{grey1}<td>97
<td>{grey2}<td>98
<td>{grey3}<td>9B
<tr><td>{grn}<td>1E
<td>{gry1}<td>97
<td>{gry2}<td>98
<tr><td>{gry3}<td>9B
<td>{help}<td>84
<td>{home}<td>13
<tr><td>{insert}<td>94
<td>{inst}<td>94
<td>{lblu}<td>9A
<tr><td>{left&nbsp;arrow}<td>5F
<td>{left}<td>9D
<td>{lf}<td>0A
<tr><td>{lgrn}<td>99
<td>{lower&nbsp;case}<td>0E
<td>{lred}<td>96
<tr><td>{lt&nbsp;blue}<td>9A
<td>{lt&nbsp;green}<td>99
<td>{lt&nbsp;red}<td>96
<tr><td>{orange}<td>81
<td>{orng}<td>81
<td>{pi}<td>FF
<tr><td>{pound}<td>5C
<td>{purple}<td>9C
<td>{pur}<td>9C
<tr><td>{red}<td>1C
<td>{return}<td>0D
<td>{reverse&nbsp;off}<td>92
<tr><td>{reverse&nbsp;on}<td>12
<td>{rght}<td>1D
<td>{right}<td>1D
<tr><td>{run}<td>83
<td>{rvof}<td>92
<td>{rvon}<td>12
<tr><td>{rvs&nbsp;off}<td>92
<td>{rvs&nbsp;on}<td>12
<td>{shift&nbsp;return}<td>8D
<tr><td>{shift-*}<td>C0
<td>{shift-+}<td>DB
<td>{shift-,}<td>3C
<tr><td>{shift--}<td>DD
<td>{shift-.}<td>3E
<td>{shift-/}<td>3F
<tr><td>{shift-0}<td>30
<td>{shift-1}<td>21
<td>{shift-2}<td>22
<tr><td>{shift-3}<td>23
<td>{shift-4}<td>24
<td>{shift-5}<td>25
<tr><td>{shift-6}<td>26
<td>{shift-7}<td>27
<td>{shift-8}<td>28
<tr><td>{shift-9}<td>29
<td>{shift-:}<td>5B
<td>{shift-;}<td>5D
<tr><td>{shift-@}<td>BA
<td>{shift-^}<td>DE
<td>{shift-a}<td>C1
<tr><td>{shift-b}<td>C2
<td>{shift-c}<td>C3
<td>{shift-d}<td>C4
<tr><td>{shift-e}<td>C5
<td>{shift-f}<td>C6
<td>{shift-g}<td>C7
<tr><td>{shift-h}<td>C8
<td>{shift-i}<td>C9
<td>{shift-j}<td>CA
<tr><td>{shift-k}<td>CB
<td>{shift-l}<td>CC
<td>{shift-m}<td>CD
<tr><td>{shift-n}<td>CE
<td>{shift-o}<td>CF
<td>{shift-pound}<td>A9
<tr><td>{shift-p}<td>D0
<td>{shift-q}<td>D1
<td>{shift-r}<td>D2
<tr><td>{shift-space}<td>A0
<td>{shift-s}<td>D3
<td>{shift-t}<td>D4
<tr><td>{shift-up&nbsp;arrow}<td>DE
<td>{shift-u}<td>D5
<td>{shift-v}<td>D6
<tr><td>{shift-w}<td>D7
<td>{shift-x}<td>D8
<td>{shift-y}<td>D9
<tr><td>{shift-z}<td>DA
<td>{space}<td>20
<td>{sret}<td>8D
<tr><td>{stop}<td>03
<td>{swlc}<td>0E
<td>{swuc}<td>8E
<tr><td>{tab}<td>09
<td>{up&nbsp;arrow}<td>5E
<td>{up/lo&nbsp;lock off}<td>09
<tr><td>{up/lo&nbsp;lock on}<td>08
<td>{upper&nbsp;case}<td>8E
<td>{up}<td>91
<tr><td>{white}<td>05
<td>{wht}<td>05
<td>{yellow}<td>9E
<tr><td>{yel}<td>9E
<td><td>
<td><td>
</tbody>
</table></div>

<h4>The <q>screen</q> encoding for Unicode<a name="translate-unicode-screen" href="#translate-unicode-screen"></a></h4>
This is a Unicode to PETSCII screen code mapping, including escape sequences for control code screen codes.
<div><table width="100%" class="trans">
<caption>Built-in Unicode to PETSCII screen code translation table</caption>
<thead>
<tr><th>Glyph<th>Unicode<th>Translated
<th>Glyph<th>Unicode<th>Translated
</thead><tbody>
<tr><td>&nbsp;&ndash;&#x3f;<td>U+0020&ndash;U+003F<td>20&ndash;3F
<td>&#x40;<td>U+0040<td>00
<tr><td>&#x41;&ndash;&#x5a;<td>U+0041&ndash;U+005A<td>41&ndash;5A
<td>&#x5b;<td>U+005B<td>1B
<tr><td>&#x5d;<td>U+005D<td>1D
<td>&#x61;&ndash;&#x7a;<td>U+0061&ndash;U+007A<td>01&ndash;1A
<tr><td>&#xa3;<td>U+00A3<td>1C
<td>&#x03c0;<td>U+03C0<td>5E
<tr><td>&#x2190;<td>U+2190<td>1F
<td>&#x2191;<td>U+2191<td>1E
<tr><td>&#x2500;<td>U+2500<td>40
<td>&#x2502;<td>U+2502<td>5D
<tr><td>&#x250c;<td>U+250C<td>70
<td>&#x2510;<td>U+2510<td>6E
<tr><td>&#x2514;<td>U+2514<td>6D
<td>&#x2518;<td>U+2518<td>7D
<tr><td>&#x251c;<td>U+251C<td>6B
<td>&#x2524;<td>U+2524<td>73
<tr><td>&#x252c;<td>U+252C<td>72
<td>&#x2534;<td>U+2534<td>71
<tr><td>&#x253c;<td>U+253C<td>5B
<td>&#x256d;<td>U+256D<td>55
<tr><td>&#x256e;<td>U+256E<td>49
<td>&#x256f;<td>U+256F<td>4B
<tr><td>&#x2570;<td>U+2570<td>4A
<td>&#x2571;<td>U+2571<td>4E
<tr><td>&#x2572;<td>U+2572<td>4D
<td>&#x2573;<td>U+2573<td>56
<tr><td>&#x2581;<td>U+2581<td>64
<td>&#x2582;<td>U+2582<td>6F
<tr><td>&#x2583;<td>U+2583<td>79
<td>&#x2584;<td>U+2584<td>62
<tr><td>&#x258c;<td>U+258C<td>61
<td>&#x258d;<td>U+258D<td>75
<tr><td>&#x258e;<td>U+258E<td>74
<td>&#x258f;<td>U+258F<td>65
<tr><td>&#x2592;<td>U+2592<td>66
<td>&#x2594;<td>U+2594<td>63
<tr><td>&#x2595;<td>U+2595<td>67
<td>&#x2596;<td>U+2596<td>7B
<tr><td>&#x2597;<td>U+2597<td>6C
<td>&#x2598;<td>U+2598<td>7E
<tr><td>&#x259a;<td>U+259A<td>7F
<td>&#x259d;<td>U+259D<td>7C
<tr><td>&#x25cb;<td>U+25CB<td>57
<td>&#x25cf;<td>U+25CF<td>51
<tr><td>&#x25e4;<td>U+25E4<td>69
<td>&#x25e5;<td>U+25E5<td>5F
<tr><td>&#x2660;<td>U+2660<td>41
<td>&#x2663;<td>U+2663<td>58
<tr><td>&#x2665;<td>U+2665<td>53
<td>&#x2666;<td>U+2666<td>5A
<tr><td>&#x2713;<td>U+2713<td>7A
<td><td><td>
</tbody>
</table></div>

<div><table width="100%" class="esc">
<caption>Built-in PETSCII screen code escape sequences</caption>
<thead>
<tr><th>Escape<th>Byte
<th>Escape<th>Byte
<th>Escape<th>Byte
</thead><tbody>
<tr><td>{cbm-*}<td>5F
<td>{cbm-+}<td>66
<td>{cbm--}<td>5C
<tr><td>{cbm-0}<td>30
<td>{cbm-9}<td>29
<td>{cbm-@}<td>64
<tr><td>{cbm-^}<td>5E
<td>{cbm-a}<td>70
<td>{cbm-b}<td>7F
<tr><td>{cbm-c}<td>7C
<td>{cbm-d}<td>6C
<td>{cbm-e}<td>71
<tr><td>{cbm-f}<td>7B
<td>{cbm-g}<td>65
<td>{cbm-h}<td>74
<tr><td>{cbm-i}<td>62
<td>{cbm-j}<td>75
<td>{cbm-k}<td>61
<tr><td>{cbm-l}<td>76
<td>{cbm-m}<td>67
<td>{cbm-n}<td>6A
<tr><td>{cbm-o}<td>79
<td>{cbm-pound}<td>68
<td>{cbm-p}<td>6F
<tr><td>{cbm-q}<td>6B
<td>{cbm-r}<td>72
<td>{cbm-s}<td>6E
<tr><td>{cbm-t}<td>63
<td>{cbm-up&nbsp;arrow}<td>5E
<td>{cbm-u}<td>78
<tr><td>{cbm-v}<td>7E
<td>{cbm-w}<td>73
<td>{cbm-x}<td>7D
<tr><td>{cbm-y}<td>77
<td>{cbm-z}<td>6D
<td>{left&nbsp;arrow}<td>1F
<tr><td>{pi}<td>5E
<td>{pound}<td>1C
<td>{shift-*}<td>40
<tr><td>{shift-+}<td>5B
<td>{shift-,}<td>3C
<td>{shift--}<td>5D
<tr><td>{shift-.}<td>3E
<td>{shift-/}<td>3F
<td>{shift-0}<td>30
<tr><td>{shift-1}<td>21
<td>{shift-2}<td>22
<td>{shift-3}<td>23
<tr><td>{shift-4}<td>24
<td>{shift-5}<td>25
<td>{shift-6}<td>26
<tr><td>{shift-7}<td>27
<td>{shift-8}<td>28
<td>{shift-9}<td>29
<tr><td>{shift-:}<td>1B
<td>{shift-;}<td>1D
<td>{shift-@}<td>7A
<tr><td>{shift-^}<td>5E
<td>{shift-a}<td>41
<td>{shift-b}<td>42
<tr><td>{shift-c}<td>43
<td>{shift-d}<td>44
<td>{shift-e}<td>45
<tr><td>{shift-f}<td>46
<td>{shift-g}<td>47
<td>{shift-h}<td>48
<tr><td>{shift-i}<td>49
<td>{shift-j}<td>4A
<td>{shift-k}<td>4B
<tr><td>{shift-l}<td>4C
<td>{shift-m}<td>4D
<td>{shift-n}<td>4E
<tr><td>{shift-o}<td>4F
<td>{shift-pound}<td>69
<td>{shift-p}<td>50
<tr><td>{shift-q}<td>51
<td>{shift-r}<td>52
<td>{shift-space}<td>60
<tr><td>{shift-s}<td>53
<td>{shift-t}<td>54
<td>{shift-up&nbsp;arrow}<td>5E
<tr><td>{shift-u}<td>55
<td>{shift-v}<td>56
<td>{shift-w}<td>57
<tr><td>{shift-x}<td>58
<td>{shift-y}<td>59
<td>{shift-z}<td>5A
<tr><td>{space}<td>20
<td>{up&nbsp;arrow}<td>1E
<td><td>
</tbody>
</table></div>

<hr>
<h2>Opcodes<a name="opcodes" href="#opcodes"></a></h2>
<h3>Standard 6502 opcodes<a name="opcodes-6502" href="#opcodes-6502"></a></h3>
<div><table width="100%" class="opcodes">
<caption>The standard 6502 opcodes</caption>
<tbody>
<tr><th width="4%">ADC<td width="46%">61 65 69 6D 71 75 79 7D
<th width="4%">AND<td width="46%">21 25 29 2D 31 35 39 3D
<tr><th>ASL<td>06 0A 0E 16 1E
<th>BCC<td>90
<tr><th>BCS<td>B0
<th>BEQ<td>F0
<tr><th>BIT<td>24 2C
<th>BMI<td>30
<tr><th>BNE<td>D0
<th>BPL<td>10
<tr><th>BRK<td>00
<th>BVC<td>50
<tr><th>BVS<td>70
<th>CLC<td>18
<tr><th>CLD<td>D8
<th>CLI<td>58
<tr><th>CLV<td>B8
<th>CMP<td>C1 C5 C9 CD D1 D5 D9 DD
<tr><th>CPX<td>E0 E4 EC
<th>CPY<td>C0 C4 CC
<tr><th>DEC<td>C6 CE D6 DE
<th>DEX<td>CA
<tr><th>DEY<td>88
<th>EOR<td>41 45 49 4D 51 55 59 5D
<tr><th>INC<td>E6 EE F6 FE
<th>INX<td>E8
<tr><th>INY<td>C8
<th>JMP<td>4C 6C
<tr><th>JSR<td>20
<th>LDA<td>A1 A5 A9 AD B1 B5 B9 BD
<tr><th>LDX<td>A2 A6 AE B6 BE
<th>LDY<td>A0 A4 AC B4 BC
<tr><th>LSR<td>46 4A 4E 56 5E
<th>NOP<td>EA
<tr><th>ORA<td>01 05 09 0D 11 15 19 1D
<th>PHA<td>48
<tr><th>PHP<td>08
<th>PLA<td>68
<tr><th>PLP<td>28
<th>ROL<td>26 2A 2E 36 3E
<tr><th>ROR<td>66 6A 6E 76 7E
<th>RTI<td>40
<tr><th>RTS<td>60
<th>SBC<td>E1 E5 E9 ED F1 F5 F9 FD
<tr><th>SEC<td>38
<th>SED<td>F8
<tr><th>SEI<td>78
<th>STA<td>81 85 8D 91 95 99 9D
<tr><th>STX<td>86 8E 96
<th>STY<td>84 8C 94
<tr><th>TAX<td>AA
<th>TAY<td>A8
<tr><th>TSX<td>BA
<th>TXA<td>8A
<tr><th>TXS<td>9A
<th>TYA<td>98
</tbody>
</table></div>

<div><table width="100%" class="opcodes">
<caption>Aliases, pseudo instructions</caption>
<tbody>
<tr><th width="4%">ASL<td width="46%">0A
<th width="4%">BGE<td width="46%">B0
<tr><th>BLT<td>90
<th>GCC<td>4C 90
<tr><th>GCS<td>4C B0
<th>GEQ<td>4C F0
<tr><th>GGE<td>4C B0
<th>GLT<td>4C 90
<tr><th>GMI<td>30 4C
<th>GNE<td>4C D0
<tr><th>GPL<td>10 4C
<th>GVC<td>4C 50
<tr><th>GVS<td>4C 70
<th>LSR<td>4A
<tr><th>ROL<td>2A
<th>ROR<td>6A
<tr><th>SHL<td>06 0A 0E 16 1E
<th>SHR<td>46 4A 4E 56 5E
</tbody>
</table></div>

<hr>
<h3>6502 illegal opcodes<a name="opcodes-6502i" href="#opcodes-6502i"></a></h3>
<p>This processor is a standard 6502 with the NMOS illegal opcodes.</p>
<div><table width="100%" class="opcodes">
<caption>Additional opcodes</caption>
<tbody>
<tr><th width="4%">ANC<td width="46%">0B
<th width="4%">ANE<td width="46%">8B
<tr><th>ARR<td>6B
<th>ASR<td>4B
<tr><th>DCP<td>C3 C7 CF D3 D7 DB DF
<th>ISB<td>E3 E7 EF F3 F7 FB FF
<tr><th>JAM<td>02
<th>LAX<td>A3 A7 AB AF B3 B7 BF
<tr><th>LDS<td>BB
<th>NOP<td>04 0C 14 1C 80
<tr><th>RLA<td>23 27 2F 33 37 3B 3F
<th>RRA<td>63 67 6F 73 77 7B 7F
<tr><th>SAX<td>83 87 8F 97
<th>SBX<td>CB
<tr><th>SHA<td>93 9F
<th>SHS<td>9B
<tr><th>SHX<td>9E
<th>SHY<td>9C
<tr><th>SLO<td>03 07 0F 13 17 1B 1F
<th>SRE<td>43 47 4F 53 57 5B 5F
</tbody>
</table></div>

<div><table width="100%" class="opcodes">
<caption>Additional aliases</caption>
<tbody>
<tr><th width="4%">AHX<td width="46%">93 9F
<th width="4%">ALR<td width="46%">4B
<tr><th>AXS<td>CB
<th>DCM<td>C3 C7 CF D3 D7 DB DF
<tr><th>INS<td>E3 E7 EF F3 F7 FB FF
<th>ISC<td>E3 E7 EF F3 F7 FB FF
<tr><th>LAE<td>BB
<th>LAS<td>BB
<tr><th>LXA<td>AB
<th>TAS<td>9B
<tr><th>XAA<td>8B
<th><td>
</tbody>
</table></div>

<hr>
<h3>65DTV02 opcodes<a name="opcodes-65dtv02" href="#opcodes-65dtv02"></a></h3>
<p>This processor is an enhanced version of standard 6502 with some illegal opcodes.</p>
<div><table width="100%" class="opcodes">
<caption>Additionally to 6502 illegal opcodes</caption>
<tbody>
<tr><th width="4%">BRA<td width="46%">12
<th width="4%">SAC<td width="46%">32
<tr><th>SIR<td>42
<th><td>
</tbody>
</table></div>

<div><table width="100%" class="opcodes">
<caption>Additional pseudo instruction</caption>
<tbody>
<tr><th width="4%">GRA<td width="46%">12 4C
<th width="4%">&nbsp;&nbsp;&nbsp;<td width="46%">
</tbody>
</table></div>

<div><table width="100%" class="opcodes">
<caption>These illegal opcodes are not valid</caption>
<tbody>
<tr><th width="4%">ANC<td width="46%">0B
<th width="4%">JAM<td width="46%">02
<tr><th>LDS<td>BB
<th>NOP<td>04 0C 14 1C 80
<tr><th>SBX<td>CB
<th>SHA<td>93 9F
<tr><th>SHS<td>9B
<th>SHX<td>9E
<tr><th>SHY<td>9C
<th><td>
</tbody>
</table></div>

<div><table width="100%" class="opcodes">
<caption>These aliases are not valid</caption>
<tbody>
<tr><th width="4%">AHX<td width="46%">93 9F
<th width="4%">AXS<td width="46%">CB
<tr><th>LAE<td>BB
<th>LAS<td>BB
<tr><th>TAS<td>9B
<th><td>
</tbody>
</table></div>

<hr>
<h3>Standard 65C02 opcodes<a name="opcodes-65c02" href="#opcodes-65c02"></a></h3>
<p>This processor is an enhanced version of standard 6502.</p>
<div><table width="100%" class="opcodes">
<caption>Additional opcodes</caption>
<tbody>
<tr><th width="4%">ADC<td width="46%">72
<th width="4%">AND<td width="46%">32
<tr><th>BIT<td>34 3C 89
<th>BRA<td>80
<tr><th>CMP<td>D2
<th>DEC<td>3A
<tr><th>EOR<td>52
<th>INC<td>1A
<tr><th>JMP<td>7C
<th>LDA<td>B2
<tr><th>ORA<td>12
<th>PHX<td>DA
<tr><th>PHY<td>5A
<th>PLX<td>FA
<tr><th>PLY<td>7A
<th>SBC<td>F2
<tr><th>STA<td>92
<th>STZ<td>64 74 9C 9E
<tr><th>TRB<td>14 1C
<th>TSB<td>04 0C
</tbody>
</table></div>

<div><table width="100%" class="opcodes">
<caption>Additional aliases and pseudo instructions</caption>
<tbody>
<tr><th width="4%">CLR<td width="46%">64 74 9C 9E
<th width="4%">DEA<td width="46%">3A
<tr><th>GRA<td>4C 80
<th>INA<td>1A
</tbody>
</table></div>

<hr>
<h3>R65C02 opcodes<a name="opcodes-r65c02" href="#opcodes-r65c02"></a></h3>
<p>This processor is an enhanced version of standard 65C02.</p>
<div><table width="100%" class="opcodes">
<caption>Additional opcodes</caption>
<tbody>
<tr><th width="4%">BBR<td width="46%">0F 1F 2F 3F 4F 5F 6F 7F
<th width="4%">BBS<td width="46%">8F 9F AF BF CF DF EF FF
<tr><th>RMB<td>07 17 27 37 47 57 67 77
<th>SMB<td>87 97 A7 B7 C7 D7 E7 F7
</tbody>
</table></div>

<hr>
<h3>W65C02 opcodes<a name="opcodes-w65c02" href="#opcodes-w65c02"></a></h3>
<p>This processor is an enhanced version of R65C02.</p>
<div><table width="100%" class="opcodes">
<caption>Additional opcodes</caption>
<tbody>
<tr><th width="4%">STP<td width="46%">DB
<th width="4%">WAI<td width="46%">CB
</tbody>
</table></div>

<div><table width="100%" class="opcodes">
<caption>Additional aliases</caption>
<tbody>
<tr><th width="4%">HLT<td width="46%">DB
<th width="4%">&nbsp;&nbsp;&nbsp;<td width="46%">&nbsp;&nbsp;
</tbody>
</table></div>

<hr>
<h3>W65816 opcodes<a name="opcodes-w65816" href="#opcodes-w65816"></a></h3>
<p>This processor is an enhanced version of W65C02.</p>
<div><table width="100%" class="opcodes">
<caption>Additional opcodes</caption>
<tbody>
<tr><th width="4%">ADC<td width="46%">63 67 6F 73 77 7F
<th width="4%">AND<td width="46%">23 27 2F 33 37 3F
<tr><th>BRL<td>82
<th>CMP<td>C3 C7 CF D3 D7 DF
<tr><th>COP<td>02
<th>EOR<td>43 47 4F 53 57 5F
<tr><th>JMP<td>5C DC
<th>JSL<td>22
<tr><th>JSR<td>FC
<th>LDA<td>A3 A7 AF B3 B7 BF
<tr><th>MVN<td>54
<th>MVP<td>44
<tr><th>ORA<td>03 07 0F 13 17 1F
<th>PEA<td>F4
<tr><th>PEI<td>D4
<th>PER<td>62
<tr><th>PHB<td>8B
<th>PHD<td>0B
<tr><th>PHK<td>4B
<th>PLB<td>AB
<tr><th>PLD<td>2B
<th>REP<td>C2
<tr><th>RTL<td>6B
<th>SBC<td>E3 E7 EF F3 F7 FF
<tr><th>SEP<td>E2
<th>STA<td>83 87 8F 93 97 9F
<tr><th>TCD<td>5B
<th>TCS<td>1B
<tr><th>TDC<td>7B
<th>TSC<td>3B
<tr><th>TXY<td>9B
<th>TYX<td>BB
<tr><th>XBA<td>EB
<th>XCE<td>FB
</tbody>
</table></div>

<div><table width="100%" class="opcodes">
<caption>Additional aliases</caption>
<tbody>
<tr><th width="4%">CSP<td width="46%">02
<th width="4%">CLP<td width="46%">C2
<tr><th>JML<td>5C DC
<th>SWA<td>EB
<tr><th>TAD<td>5B
<th>TAS<td>1B
<tr><th>TDA<td>7B
<th>TSA<td>3B
<tr><th><td>
</tbody>
</table></div>

<hr>
<h3>65EL02 opcodes<a name="opcodes-65el02" href="#opcodes-65el02"></a></h3>
<p>This processor is an enhanced version of standard 65C02.</p>
<div><table width="100%" class="opcodes">
<caption>Additional opcodes</caption>
<tbody>
<tr><th width="4%">ADC<td width="46%">63 67 73 77
<th width="4%">AND<td width="46%">23 27 33 37
<tr><th>CMP<td>C3 C7 D3 D7
<th>DIV<td>4F 5F 6F 7F
<tr><th>ENT<td>22
<th>EOR<td>43 47 53 57
<tr><th>JSR<td>FC
<th>LDA<td>A3 A7 B3 B7
<tr><th>MMU<td>EF
<th>MUL<td>0F 1F 2F 3F
<tr><th>NXA<td>42
<th>NXT<td>02
<tr><th>ORA<td>03 07 13 17
<th>PEA<td>F4
<tr><th>PEI<td>D4
<th>PER<td>62
<tr><th>PHD<td>DF
<th>PLD<td>CF
<tr><th>REA<td>44
<th>REI<td>54
<tr><th>REP<td>C2
<th>RER<td>82
<tr><th>RHA<td>4B
<th>RHI<td>0B
<tr><th>RHX<td>1B
<th>RHY<td>5B
<tr><th>RLA<td>6B
<th>RLI<td>2B
<tr><th>RLX<td>3B
<th>RLY<td>7B
<tr><th>SBC<td>E3 E7 F3 F7
<th>SEA<td>9F
<tr><th>SEP<td>E2
<th>STA<td>83 87 93 97
<tr><th>STP<td>DB
<th>SWA<td>EB
<tr><th>TAD<td>BF
<th>TDA<td>AF
<tr><th>TIX<td>DC
<th>TRX<td>AB
<tr><th>TXI<td>5C
<th>TXR<td>8B
<tr><th>TXY<td>9B
<th>TYX<td>BB
<tr><th>WAI<td>CB
<th>XBA<td>EB
<tr><th>XCE<td>FB
<th>ZEA<td>8F
</tbody>
</table></div>

<div><table width="100%" class="opcodes">
<caption>Additional aliases</caption>
<tbody>
<tr><th width="4%">CLP<td width="46%">C2
<th width="4%">HLT<td width="46%">DB
</tbody>
</table></div>

<hr>
<h3>65CE02 opcodes<a name="opcodes-65ce02" href="#opcodes-65ce02"></a></h3>
<p>This processor is an enhanced version of R65C02.</p>
<div><table width="100%" class="opcodes">
<caption>Additional opcodes</caption>
<tbody>
<tr><th width="4%">ASR<td width="46%">43 44 54
<th width="4%">ASW<td width="46%">CB
<tr><th>BCC<td>93
<th>BCS<td>B3
<tr><th>BEQ<td>F3
<th>BMI<td>33
<tr><th>BNE<td>D3
<th>BPL<td>13
<tr><th>BRA<td>83
<th>BSR<td>63
<tr><th>BVC<td>53
<th>BVS<td>73
<tr><th>CLE<td>02
<th>CPZ<td>C2 D4 DC
<tr><th>DEW<td>C3
<th>DEZ<td>3B
<tr><th>INW<td>E3
<th>INZ<td>1B
<tr><th>JSR<td>22 23
<th>LDA<td>E2
<tr><th>LDZ<td>A3 AB BB
<th>NEG<td>42
<tr><th>PHW<td>F4 FC
<th>PHZ<td>DB
<tr><th>PLZ<td>FB
<th>ROW<td>EB
<tr><th>RTS<td>62
<th>SEE<td>03
<tr><th>STA<td>82
<th>STX<td>9B
<tr><th>STY<td>8B
<th>TAB<td>5B
<tr><th>TAZ<td>4B
<th>TBA<td>7B
<tr><th>TSY<td>0B
<th>TYS<td>2B
<tr><th>TZA<td>6B
<th><td>
</tbody>
</table></div>

<div><table width="100%" class="opcodes">
<caption>Additional aliases</caption>
<tbody>
<tr><th width="4%">ASR<td width="46%">43
<th width="4%">BGE<td width="46%">B3
<tr><th>BLT<td>93
<th>NEG<td>42
<tr><th>RTN<td>62
<th><td>
</tbody>
</table></div>

<div><table width="100%" class="opcodes">
<caption>This alias is not valid</caption>
<tbody>
<tr><th width="4%">CLR<td width="46%">64 74 9C 9E
<th width="4%">&nbsp;&nbsp;&nbsp;<td width="46%">&nbsp;&nbsp;
</tbody>
</table></div>

<hr>
<h2>Appendix<a name="appendix" href="#appendix"></a></h2>

<h3>Assembler directives<a name="directives" href="#directives"></a></h3>
<p class="links">
<a href="#d_addr">.addr</a>
<a href="#d_al">.al</a>
<a href="#d_align">.align</a>
<a href="#d_as">.as</a>
<a href="#d_assert">.assert</a>
<a href="#d_bend">.bend</a>
<a href="#d_binary">.binary</a>
<a href="#d_binclude">.binclude</a>
<a href="#d_block">.block</a>
<a href="#d_break">.break</a>
<a href="#d_byte">.byte</a>
<a href="#d_case">.case</a>
<a href="#d_cdef">.cdef</a>
<a href="#d_cerror">.cerror</a>
<a href="#d_char">.char</a>
<a href="#d_check">.check</a>
<a href="#d_comment">.comment</a>
<a href="#d_continue">.continue</a>
<a href="#d_cpu">.cpu</a>
<a href="#d_cwarn">.cwarn</a>
<a href="#d_databank">.databank</a>
<a href="#d_default">.default</a>
<a href="#d_dint">.dint</a>
<a href="#d_dpage">.dpage</a>
<a href="#d_dsection">.dsection</a>
<a href="#d_dstruct">.dstruct</a>
<a href="#d_dunion">.dunion</a>
<a href="#d_dword">.dword</a>
<a href="#d_edef">.edef</a>
<a href="#d_else">.else</a>
<a href="#d_elsif">.elsif</a>
<a href="#d_enc">.enc</a>
<a href="#d_end">.end</a>
<a href="#d_endc">.endc</a>
<a href="#d_endf">.endf</a>
<a href="#d_endif">.endif</a>
<a href="#d_endm">.endm</a>
<a href="#d_endp">.endp</a>
<a href="#d_ends">.ends</a>
<a href="#d_endswitch">.endswitch</a>
<a href="#d_endu">.endu</a>
<a href="#d_endweak">.endweak</a>
<a href="#d_eor">.eor</a>
<a href="#d_error">.error</a>
<a href="#d_fi">.fi</a>
<a href="#d_fill">.fill</a>
<a href="#d_for">.for</a>
<a href="#d_function">.function</a>
<a href="#d_goto">.goto</a>
<a href="#d_here">.here</a>
<a href="#d_hidemac">.hidemac</a>
<a href="#d_if">.if</a>
<a href="#d_ifeq">.ifeq</a>
<a href="#d_ifmi">.ifmi</a>
<a href="#d_ifne">.ifne</a>
<a href="#d_ifpl">.ifpl</a>
<a href="#d_include">.include</a>
<a href="#d_int">.int</a>
<a href="#d_lbl">.lbl</a>
<a href="#d_lint">.lint</a>
<a href="#d_logical">.logical</a>
<a href="#d_long">.long</a>
<a href="#d_macro">.macro</a>
<a href="#d_next">.next</a>
<a href="#d_null">.null</a>
<a href="#d_offs">.offs</a>
<a href="#d_option">.option</a>
<a href="#d_page">.page</a>
<a href="#d_pend">.pend</a>
<a href="#d_proc">.proc</a>
<a href="#d_proff">.proff</a>
<a href="#d_pron">.pron</a>
<a href="#d_ptext">.ptext</a>
<a href="#d_rept">.rept</a>
<a href="#d_rta">.rta</a>
<a href="#d_section">.section</a>
<a href="#d_segment">.segment</a>
<a href="#d_send">.send</a>
<a href="#d_shift">.shift</a>
<a href="#d_shiftl">.shiftl</a>
<a href="#d_showmac">.showmac</a>
<a href="#d_struct">.struct</a>
<a href="#d_switch">.switch</a>
<a href="#d_text">.text</a>
<a href="#d_union">.union</a>
<a href="#d_var">.var</a>
<a href="#d_warn">.warn</a>
<a href="#d_weak">.weak</a>
<a href="#d_word">.word</a>
<a href="#d_xl">.xl</a>
<a href="#d_xs">.xs</a>
</p>

<hr>
<h3>Built-in functions<a name="functions" href="#functions"></a></h3>
<p class="links">
<a href="#f_abs">abs</a>
<a href="#f_acos">acos</a>
<a href="#f_all">all</a>
<a href="#f_any">any</a>
<a href="#f_asin">asin</a>
<a href="#f_atan">atan</a>
<a href="#f_atan2">atan2</a>
<a href="#f_cbrt">cbrt</a>
<a href="#f_ceil">ceil</a>
<a href="#f_cos">cos</a>
<a href="#f_cosh">cosh</a>
<a href="#f_deg">deg</a>
<a href="#f_exp">exp</a>
<a href="#f_floor">floor</a>
<a href="#f_format">format</a>
<a href="#f_frac">frac</a>
<a href="#f_hypot">hypot</a>
<a href="#f_len">len</a>
<a href="#f_log">log</a>
<a href="#f_log10">log10</a>
<a href="#f_pow">pow</a>
<a href="#f_rad">rad</a>
<a href="#f_range">range</a>
<a href="#f_repr">repr</a>
<a href="#f_round">round</a>
<a href="#f_sign">sign</a>
<a href="#f_sin">sin</a>
<a href="#f_sinh">sinh</a>
<a href="#f_size">size</a>
<a href="#f_sqrt">sqrt</a>
<a href="#f_tan">tan</a>
<a href="#f_tanh">tanh</a>
<a href="#f_trunc">trunc</a>
</p>
<h3>Built-in types<a name="types" href="#types"></a></h3>
<p class="links">
<a href="#t_address">address</a>
<a href="#t_bits">bits</a>
<a href="#t_bool">bool</a>
<a href="#t_bytes">bytes</a>
<a href="#t_code">code</a>
<a href="#t_dict">dict</a>
<a href="#t_float">float</a>
<a href="#t_gap">gap</a>
<a href="#t_int">int</a>
<a href="#t_list">list</a>
<a href="#t_str">str</a>
<a href="#t_tuple">tuple</a>
<a href="#t_type">type</a>
</p>
</div>
</body></html>
